<?php

 class OtEvMdl extends Model {

        var $ot_assess_id;
        var $visit_log_id;
        var $primary_diag;
      	var $secondary_diag;
        var $primary_diag_date;
      	var $secondary_diag_date;  
        var $tab_92_assess_type;
        var $tab_43_rehab_poten;
        var $mental_alert;
        var $mental_oriented;
        var $mental_disoriented;
        var $mental_forgetful;
        var $mental_agitated;
        var $mental_depressed;
        var $tab_75_pain_assessment;
        var $pain_location;
        var $pain_control;
        var $p1_sa_bp;        
        var $tab_062_right_left;
        var $p1_sa_sitt_lyi_stand;
        var $p1_sa_hr;
        var $p1_sa_o2_sat;
        var $p1_sa_skin;
        var $funct_dyspnea;
        var $funct_diff_walking;
        var $funct_diff_transfer;
        var $funct_diff_dressing;
        var $funct_other;
        var $funct_other_desc;
        var $tab_020_sho_abd_stre_left;
        var $tab_020_sho_abd_stre_right;
        var $sho_abd_stre_degre;
        var $tab_020_sho_abd_rom_left;
        var $tab_020_sho_abd_rom_right;
        var $sho_abd_rom_degre;
        var $tab_020_sho_int_stre_left;
        var $tab_020_sho_int_stre_right;
        var $sho_int_stre_degre;
        var $tab_020_sho_int_rom_left;
        var $tab_020_sho_int_rom_right;
        var $sho_int_rom_degre;
        var $tab_020_sho_flex_stre_left;
        var $tab_020_sho_flex_stre_right;
        var $sho_flex_stre_degre;
        var $tab_020_sho_flex_rom_left;
        var $tab_020_sho_flex_rom_right;
        var $sho_flex_rom_degre;
        var $tab_020_elb_flex_stre_left;
        var $tab_020_elb_flex_stre_right;
        var $sho_elb_flex_stre_degre;
        var $tab_020_elb_flex_rom_left;
        var $tab_020_elb_flex_rom_right;
        var $sho_elb_flex_rom_degre;
        var $tab_020_elb_sup_stre_left;
        var $tab_020_elb_sup_stre_right;
        var $sho_elb_sup_stre_degre;
        var $tab_020_elb_sup_rom_left;
        var $tab_020_elb_sup_rom_right;
        var $sho_elb_sup_rom_degre;
        var $tab_020_wri_flex_stre_left;
        var $tab_020_wri_flex_stre_right;
        var $sho_wri_flex_stre_degre;
        var $tab_020_wri_flex_rom_left;
        var $tab_020_wri_flex_rom_right;
        var $sho_wri_flex_rom_degre;
        var $tab_020_wri_abd_stre_left;
        var $tab_020_wri_abd_stre_right;
        var $sho_wri_abd_stre_degre;
        var $tab_020_wri_abd_rom_left;
        var $tab_020_wri_abd_rom_right;
        var $sho_wri_abd_rom_degre;
        var $tab_020_fin_flex_stre_left;
        var $tab_020_fin_flex_stre_right;
        var $sho_fin_flex_stre_degre;
        var $tab_020_fin_flex_rom_left;
        var $tab_020_fin_flex_rom_right;
        var $sho_fin_flex_rom_degre;
        var $tab_020_fin_abd_stre_left;
        var $tab_020_fin_abd_stre_right;
        var $sho_fin_abd_stre_degre;
        var $tab_020_fin_abd_rom_left;
        var $tab_020_fin_abd_rom_right;
        var $sho_fin_abd_rom_degre;
        var $tab_020_thu_flex_stre_left;
        var $tab_020_thu_flex_stre_right;
        var $sho_thu_flex_stre_degre;
        var $tab_020_thu_flex_rom_left;
        var $tab_020_thu_flex_rom_right;
        var $sho_thu_flex_rom_degre;
        var $tab_020_thu_abd_stre_left;
        var $tab_020_thu_abd_stre_right;
        var $sho_thu_abd_stre_degre;
        var $tab_020_thu_abd_rom_left;
        var $tab_020_thu_abd_rom_right;
        var $sho_thu_abd_rom_degre;
        var $p1_adit_adl_func_sens_propio;
        var $p1_adit_adl_func_sens_light;
        var $p1_adit_adl_func_sens_deep;
        var $p1_adit_adl_func_sharp;
        var $p1_adit_adl_func_sens_hot;
        var $p1_adit_adl_func_percep_vision;
        var $p1_adit_adl_func_percep_position;
        var $p1_adit_adl_func_percep_discrimin;
        var $p1_adit_adl_func_percep_depth;
        var $p1_adit_adl_func_percep_aware;
        var $p1_adit_adl_func_cogni_orienta;
        var $p1_adit_adl_func_cogni_safe_judg;
        var $p1_adit_adl_func_cogni_atten_span;
        var $p1_adit_adl_func_cogni_mem_reten;
        var $p1_adit_adl_func_cordina_gross_motor;
        var $p1_adit_adl_func_cordina_fine_motor;
        var $p1_adit_adl_func_balan_static;
        var $p1_adit_adl_func_balan_dynamic;
        var $p1_fun_sts_tab047_dres_upp_ext;
        var $p1_fun_sts_tab047_dres_low_ext;
        var $p1_fun_sts_tab047_feed;
        var $p1_fun_sts_tab047_adap_dev_uten;
        var $p1_fun_sts_tab047_groo_hair;
        var $p1_fun_sts_tab047_groo_nail;
        var $p1_fun_sts_tab047_groo_Shav;
        var $p1_fun_sts_tab047_urin_toil;
        var $p1_fun_sts_tab047_bath_bed;
        var $p1_fun_sts_tab047_hom_mak_kit_laud;
        var $p1_fun_sts_tab047_hom_mak_meal_prep;
        var $p1_fun_sts_Other_desc;
        var $p1_he_alone;
        var $p1_he_wit_spouse;
        var $p1_he_other_desc;
        var $p1_he_home;
        var $p1_he_apt;
        var $p1_he_mobile;
        var $p1_he_stairs;
        var $p1_he_senior;
        var $p1_he_spacious;
        var $p1_he_clean;
        var $p1_he_crowded;
        var $p1_he_clutter;
        var $p1_he_elevator;
        var $p1_he_dirty;
        var $p1_he_sin_level;
        var $p1_he_mult_level;
        var $p1_saf_clear_path;
        var $p1_saf_adeq_lighting;
        var $p1_saf_siderails;
        var $p1_saf_emerg_manag;
        var $p1_saf_isola_precau;
        var $p1_saf_ortho_prec_restri_archi;
        var $p1_saf_steps;
        var $p1_saf_doorways;
        var $p1_saf_24_hour_sup;
        var $p1_saf_other;
        var $p1_saf_other_desc;
        var $p2_treat_evaluation;
        var $p2_treat_adl_train;
        var $p2_treat_esta_hep;
        var $p2_treat_upgrade_hep;
        var $p2_treat_percep_mot_trai;
        var $p2_treat_fine_mot_trai;
        var $p2_treat_neu_devel_treat;
        var $p2_treat_sens_treat;
        var $p2_treat_muscle_reeduc;
        var $p2_treat_orth_splin;
        var $p2_treat_hom_prog_adap_equi;
        var $p2_treat_trans_trai;
        var $p2_treat_other;
        var $p2_treat_other_desc;
        var $p2_h_s;
        var $p2_update;
        var $p2_discharge_summary;
        var $p2_h_s_udt_dc_summ_desc;
        var $p2_treat_plan;
        var $p2_plan_of_care;
        var $p2_trat_plan_plan_of_care_desc;
        var $p2_goal;
        var $p2_goals_desc;
        var $p2_home_consider;
        var $p2_home_req_assis;
        var $p2_home_resid;
        var $p2_home_depen;
        var $p2_home_confu;
        var $p2_home_other;
        var $p2_home_other_desc;
        var $freq_duration;
        var $ther_na;
      	var $ther_name;
        var $ther_implem_plan;
        var $ther_follow_plan;
        var $ther_raport_pat_fam; 
        var $ther_eval_plan;
        var $ther_notes;
        var $addendum;
        var $verbal_doctor_order;
        var $verbal_doctor_order_comments;
        var $verbal_doctor_order_date;
        var $p2_discha;
        var $p2_tab_064_discha_reason;
        var $p2_discha_other;
        var $p2_dis_instructions;
        var $upload_document_name;
        var $upload_document_name2;

	function OtEvMdl () {

		parent::Model();
		
	}

    function getEmpty()
    {
        return $this;
    }
    

	function get ( $visit_log_id ) {
	
		$this->db->where('visit_log_id', $visit_log_id);
	
		$query = $this->db->get('vt_ot_evaluation');
		return $query->row();
	
	}

	function insert () {
	
		$this->db->insert('vt_ot_evaluation', $this);
	
	}
	
	function update ( $visit_log_id ) {
	
		unset($this->ot_assess_id);
	
		$this->db->where('visit_log_id', $visit_log_id);
	
		$this->db->update('vt_ot_evaluation', $this);
	
	}

    function updateFlex($visit_log_id, $attribute, $value, $where = 'visit_log_id')
    {

        $this->db->where($where, $visit_log_id);
        $this->db->set($attribute, $value);

        $this->db->update('vt_ot_evaluation');

    }
	
	function getPrevious ( $user_id=null, $previous_date, $episode_id, $allepisodes=false ) {
		
        $soc_id = null;
        if($allepisodes AND $episode_id){      
          $this->db->select('soc_id');
          $this->db->where('cms485_id', $episode_id);
          $query = $this->db->get('cms_485');    
          $row = $query->row_array();
          $soc_id = $row['soc_id'];
      }
      
      $this->db->join('vis_visit_log',   'vis_visit_log.visit_log_id = vt_ot_evaluation.visit_log_id');
      
      if (!is_null($user_id))
          $this->db->where('visit_user_id', $user_id);
      $this->db->where('visit_date_time <', $previous_date);
      
      $this->db->where('visit_status_id != 1');
      $this->db->where('visit_type_id != 320');
      
      if(!is_null($soc_id)){
          $this->db->join('cms_485',   'cms_485.soc_id = '.$soc_id);
          $this->db->where('vis_visit_log.cms485_id=cms_485.cms485_id');
          $this->db->group_by('vis_visit_log.visit_log_id');
      }else{
          $this->db->where('cms485_id', $episode_id);
      }
      
      $this->db->order_by('visit_date_time');
      
      $query = $this->db->get('vt_ot_evaluation');
      return $query->result();
      
  }
	
	function getNext ( $user_id=null, $previous_date, $episode_id ) {
		
		$this->db->join('vis_visit_log',   'vis_visit_log.visit_log_id = vt_ot_evaluation.visit_log_id');
		
    if (!is_null($user_id))
		$this->db->where('visit_user_id', $user_id);
    
		$this->db->where('visit_date_time >', $previous_date);
		$this->db->where('cms485_id', $episode_id);
		
		$this->db->order_by('visit_date_time');
		
		$query = $this->db->get('vt_ot_evaluation');
		return $query->result();
		
	}
	

	function copy ( $destination_visit_log_id, $source_visit_log_id ) {

		$object = new OtEvMdl();
		$object1 = $this->get($destination_visit_log_id);
		$object = $this->get($source_visit_log_id);
		
		$object->ot_assess_id = $object1->ot_assess_id;
		$object->visit_log_id = $destination_visit_log_id;
	
		$this->db->where('visit_log_id', $destination_visit_log_id);
		$this->db->update('vt_ot_evaluation', $object);
		
	}
	
 }
