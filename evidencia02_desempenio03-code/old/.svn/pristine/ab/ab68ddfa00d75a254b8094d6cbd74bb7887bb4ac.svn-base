<?php  if (!defined('BASEPATH')) exit('No direct script access allowed');

function msvt_pdf ( $visit_log_id, $output='F' ) {
    $CI =& get_instance();
    
    // saving before printing pdf
    $visit_log = $CI->visitlogmdl->getById($visit_log_id);
    if (is_null($visit_log->visited_date)) {
      $visit_log->visited_date = $visit_log->visit_date_time;
    }
    

    if (!$CI->request->is_get() && ($visit_log->visit_status_id == 1 || $visit_log->visit_status_id == 2 || $visit_log->visit_status_id == 6)) {

     $CI->visitlogmdl->updateStatus($visit_log_id, 6);
      /*$CI->assignPostData($CI->msvtmdl);

      if (count($CI->msvtmdl->get($visit_log_id))) {
        $CI->msvtmdl->update($visit_log_id);
      } else {
        $CI->msvtmdl->provider_sign_date = standard_date(now(), 'MYSQL');
        $CI->msvtmdl->insert($visit_log_id);
      }*/

    }

    // printing pdf
    $msvt         = $CI->msvtmdl->get($visit_log_id);
    if (empty($msvt)) {
        $msvt = $CI->msvtmdl->getEmpty();
    }

    $agency       = $CI->agencymdl->getByAgencyId($CI->getAgencyId());
    $patient      = $CI->patientmdl->getById($visit_log->patient_id);
    $insurance      = $CI->patientinsurancemdl->getPrimaryInsurance($visit_log->patient_id);

    $agency       = $CI->agencymdl->getByAgencyId($patient->agency_id);
    $episde_icd   = $CI->episodeicdmdl->get($visit_log->cms485_id);
    // $phys_user_id   = $CI->usagymdl->getByUsAgyId($visit_log->phys_user_id);
    $physician    = $CI->agencymdl->getByAgencyId($visit_log->doctor_office_id);

    $visit_discipline = "";
    if ($visit_log->visit_discipline_id) {
        $discipline     = $CI->disciplinemdl->getById($visit_log->visit_discipline_id);
        $visit_discipline = $discipline->mayor_discipline . " - ";
    }

    $path_ticket = realpath("style/images/icon_enable_negro.gif");

    $__FONT['PDF']['SIZE'] = 11;
    $__FONT['PDF']['FORM_MEDIUM'] = 10;
    $__FONT['PDF']['FORM_SMALL'] = 9;
    $__FONT['PDF']['FORM_SMALL2'] = 9;
    $__FONT['PDF']['FORM_SMALL3'] = 6.5;
    $__FONT['PDF']['FORM_SMALL4'] = 9.5;
    $__FONT['PDF']['FORM_arial8'] = 9.5;


    $CI->load->library('fpdf');
    if(!defined('FPDF_FONTPATH'))
      define('FPDF_FONTPATH',$CI->config->item('fonts_path'));

      $CI->fpdf = new fpdf;
      $cero_x = 11;
      $cero_y = 2;
      $CI->fpdf->Open();
      $CI->fpdf->AddPage();

      $CI->fpdf->SetDrawColor(130,100);
      $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_MEDIUM']);
        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 12 ), $agency->agency_name); // agency name

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL3']);
        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 22 ),"Licensed and Certified Home Health Agency");

        $CI->fpdf->Rect(8,28, 577, 780);

        $CI->fpdf->SetFont('Arial', 'B', $__FONT['PDF']['FORM_SMALL']);

        if ($visit_discipline) {
            $CI->fpdf->Text(( $cero_x + 210),( $cero_y + 36 ), $visit_discipline."MISSED VISIT REPORT                MISSED VISIT DATE: " . standard_date(mysql_to_unix($visit_log->visited_date))); // visit date
        } else {
            $CI->fpdf->Text(( $cero_x + 210),( $cero_y + 36 ), "MISSED VISIT REPORT                                             " .
                                      "MISSED VISIT DATE: " . standard_date(mysql_to_unix($visit_log->visited_date))); // visit date
        }

        $CI->fpdf->Line(( $cero_x - 3 ) , ($cero_y + 40.5 ), ( $cero_x + 574 ), ($cero_y + 40.5 ));

        $cero_y = 20;
        $CI->fpdf->SetTextColor(0,0,0);
        $CI->fpdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 32 ),"Patient Name: ");

        $CI->fpdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 60),( $cero_y + 32 ), $patient->first_name . " " . $patient->last_name); // pacient name

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->SetTextColor(0,0,0);

        $CI->fpdf->SetDrawColor(130,100);

        if (!empty($insurance)) {
            $CI->fpdf->Text(( $cero_x + 240),( $cero_y + 32 ), substr($insurance->tab_description, 0, 10)."#: ");

            $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
            $CI->fpdf->Text(( $cero_x + 298),( $cero_y + 32 ), $insurance->ins_id);
        }else {
            $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
            $CI->fpdf->Text(( $cero_x + 388),( $cero_y + 32 ), "  NA ");
            $CI->fpdf->Rect(( $cero_x + 378),($cero_y + 23.5), 8.4, 8.4);
            $CI->fpdf->Image( $path_ticket, ( $cero_x + 379 ),($cero_y + 24.5),6);
        }

        /*$CI->fpdf->Text(( $cero_x + 240),( $cero_y + 32 ),"Medicare #: ");

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 290),( $cero_y + 32 ), $patient->medicare_id); // medicare id


        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 388),( $cero_y + 32 ), "  NA ");
        $CI->fpdf->Rect(( $cero_x + 378),($cero_y + 23.5), 8.4, 8.4);



        if (is_null($patient->medicare_id)){
          $CI->fpdf->Image( $path_ticket, ( $cero_x + 379 ),($cero_y + 24.5),6);
        }
        */
        $CI->fpdf->Text(( $cero_x + 395 +20),( $cero_y + 32 ),"Medical Rec#: ");

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 455 +20),( $cero_y + 32 ), $patient->medical_rec_nbr); // medicare id

        $CI->fpdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 372),( $cero_y + 42 ),"  SOC: ");
        $CI->fpdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 415),( $cero_y + 42 ), standard_date(mysql_to_unix($visit_log->estimated_soc_date))); // soc date

        // primary and second icd
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 42 ),"Primary Dx: ");

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 60),( $cero_y + 42 ), substr(@$msvt->primary_diag, 0, 30));

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 240),( $cero_y + 42 ),"Date: ");

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 288),( $cero_y + 42 ), (!is_null(@$msvt->primary_diag_date) ? standard_date(mysql_to_unix(@$msvt->primary_diag_date)) : ""));

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 52 ),"Therapy Dx: ");

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 60),( $cero_y + 52 ), substr(@$msvt->secondary_diag, 0, 30));

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 240),( $cero_y + 52 ),"Date: ");

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 288),( $cero_y + 52 ), (!is_null(@$msvt->secondary_diag_date) ? standard_date(mysql_to_unix(@$msvt->secondary_diag_date)) : ""));


        // start and end soc date
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 377),( $cero_y + 52 ),"From: ");

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 415),( $cero_y + 52 ), standard_date(mysql_to_unix($visit_log->episode_start_date)));


        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 490),( $cero_y + 52 ),"To: ");

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 505),( $cero_y + 52 ), standard_date(mysql_to_unix($visit_log->episode_end_date)));


        if ($visit_log->episode_start_date == $visit_log->estimated_soc_date)     {
            $CI->fpdf->Text(( $cero_x + 495),( $cero_y + 42 ),"   Certification");
        } else {
            $CI->fpdf->Text(( $cero_x + 495),( $cero_y + 42 ),"   Recertif.");
        }

        $CI->fpdf->Rect(( $cero_x + 490),($cero_y + 33.5), 8.4, 8.4);
        $CI->fpdf->Image( $path_ticket,( $cero_x + 491 ),($cero_y + 34.5),6);


        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 62 ),"Physician: ");

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_arial8']);
        // $CI->fpdf->Text(( $cero_x + 60),($cero_y + 62 ), @$phys_user_id->complete_name);
        $CI->fpdf->Text(( $cero_x + 60),($cero_y + 62 ), @$physician->agency_name);

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 240),( $cero_y + 62 ), "Clinician:");

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_arial8']);
        $CI->fpdf->Text(( $cero_x + 288),(  $cero_y + 62 ), $visit_log->first_name . " " .  $visit_log->last_name);

       /* $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 377),( $cero_y + 62 ), "Time In: ");
    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(( $cero_x + 416),( $cero_y + 62 ), standard_date(mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_in), 'USA_TIME_C'));

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 490),( $cero_y + 62 ), "Time Out: ");
    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(( $cero_x + 531),( $cero_y + 62 ), standard_date(mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_out), 'USA_TIME_C'));*/


        $cero_y =$cero_y+15;
        $CI->fpdf->SetLineWidth( 0.9 );
        $CI->fpdf->Line(( $cero_x-3 ) , ($cero_y + 50.5), ( $cero_x + 573 ), ($cero_y + 50.5));


        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 20),( $cero_y + 72 ), "PATIENT DID NOT RECEIVE TREATMENT TODAY FOR THE FOLLOWING REASON(S):");

        $CI->fpdf->Rect(( $cero_x + 20 ),( $cero_y + 90 ), 8, 8);
        if (@$msvt->alter_caregiver == 1) {
            $CI->fpdf->Image( $path_ticket, ($cero_x + 21),( $cero_y + 91), 6);
        }
        $CI->fpdf->Text(( $cero_x + 40),( $cero_y + 97 ), "Alternate Caregiver available to provide care");


        $CI->fpdf->Rect(( $cero_x + 20 ),( $cero_y + 100 ), 8, 8);
        if (@$msvt->patient_refused == 1) {
            $CI->fpdf->Image( $path_ticket, ($cero_x + 21),( $cero_y + 101), 6);
        }
        $CI->fpdf->Text(( $cero_x + 40),( $cero_y + 107 ), "Patient refused services");


        $CI->fpdf->Rect(( $cero_x + 20 ),( $cero_y + 110 ), 8, 8);
        if (@$msvt->family_refused == 1) {
            $CI->fpdf->Image( $path_ticket, ($cero_x + 21),( $cero_y + 111), 6);
        }
        $CI->fpdf->Text(( $cero_x + 40),( $cero_y + 117 ), "Family refused services");


        $CI->fpdf->Rect(( $cero_x + 20 ),( $cero_y + 120 ), 8, 8);
        if (@$msvt->patient_requested == 1) {
            $CI->fpdf->Image( $path_ticket, ($cero_x + 21),( $cero_y + 121), 6);
        }
        $CI->fpdf->Text(( $cero_x + 40),( $cero_y + 127 ), "Patient requested no visit today");


        $CI->fpdf->Rect(( $cero_x + 20 ),( $cero_y + 130 ), 8, 8);
        if (@$msvt->no_answer == 1) {
            $CI->fpdf->Image( $path_ticket, ($cero_x + 21),( $cero_y + 131), 6);
        }
        $CI->fpdf->Text(( $cero_x + 40),( $cero_y + 137 ), "No answer to door (provide follow-up plans)");


        $CI->fpdf->Rect(( $cero_x + 20 ),( $cero_y + 140 ), 8, 8);
        if (@$msvt->other == 1) {
            $CI->fpdf->Image( $path_ticket, ($cero_x + 21),( $cero_y + 141), 6);
        }
        $CI->fpdf->Text(( $cero_x + 40),( $cero_y + 148 ), "Other:");


        $eje_y = 200;
        $CI->fpdf->SetFont('Courier', '', $__FONT['PDF']['FORM_SMALL'] );
        $c=0;
        foreach (str_split($msvt->other_description, 95) as $substring) {

         $CI->fpdf->Text(50, $eje_y, $substring);
         $eje_y += 10;

         $c++;

         if ($c == 4) break;

     }


     $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
     $CI->fpdf->Text(51, 250, "Plan:");

     $eje_y = 268;
     $CI->fpdf->SetFont('Courier', '', $__FONT['PDF']['FORM_SMALL'] );
     $c=0;
     foreach (str_split($msvt->plan, 95) as $substring) {

         $CI->fpdf->Text(50, $eje_y, $substring);
         $eje_y += 10;

         $c++;

         if ($c == 4) break;

     }


     $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

     $CI->fpdf->Rect(90, 320, 8, 8);
     if (@$msvt->superv_notified == 1) {
        $CI->fpdf->Image( $path_ticket, 91, 321, 6);
    }
    $CI->fpdf->Text(105, 327, "Supervisor Notified");


    $CI->fpdf->Rect(300, 320, 8, 8);
    if (@$msvt->md_notified == 1) {
        $CI->fpdf->Image( $path_ticket, 301, 321, 6);
    }
    $CI->fpdf->Text(315, 327, "MD Notified");


    $CI->fpdf->Text(13,626 , "Electronically signed by:__________________________________________________ Date_____________________________");
    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
    if ($visit_log->sent_to_approve_date) {
     $CI->fpdf->Text(113,625, $visit_log -> first_name." ".$visit_log -> last_name);
     $CI->fpdf->Text(386, 625, standard_date(mysql_to_unix($visit_log->visit_date_time)));
 }


 $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
 $CI->fpdf->Text(11, 820, $agency->address.', '.$agency->city.', '.$CI->statemdl->getNameShort($agency->state_id).' '.$agency->zip);
 $CI->fpdf->Text(350, 820, "Phone: " . $agency->phone_primary);
 $CI->fpdf->Text(470, 820, "Fax: " . $agency->fax);

    $title_text = "MSVT Visit Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
        case 'I':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;

        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;
}

  function snpn_pdf ( $visit_log_id, $output='F' ) {
    $CI =& get_instance();

    $CI->load->model('snpnmdl');

        // saving before printing pdf
    $visit_log = $CI->visitlogmdl->getById($visit_log_id);
    if (!$CI->request->is_get() && ($visit_log->visit_status_id == 1 || $visit_log->visit_status_id == 2)) {

     $CI->visitlogmdl->updateStatus($visit_log_id, 2);
            /*$CI->assignPostData($CI->snpnmdl);
            $CI->snpnmdl->GastroLastBM = standard_date(human_to_unix($CI->snpnmdl->GastroLastBM), 'MYSQL');
      $CI->assignPostData($CI->snwamdl);


            if ($visit_log->visit_status_id == 2) {

                $snpn = $CI->snpnmdl->get($visit_log_id); // snpn record

                $CI->snpnmdl->update($visit_log_id);
                $CI->snwamdl->update($snpn->v11_nurse_visit_id);

            } else {

                $CI->snpnmdl->insert($visit_log_id);
                $CI->snwamdl->insert($CI->snpnmdl->v11_nurse_visit_id);

            }
            */
        }

        // printing pdf
        $snpn           = $CI->snpnmdl->get($visit_log_id);
        $CI->load->model('snwamdl');
        $snwa           = $CI->snwamdl->get($snpn->v11_nurse_visit_id);
        $patient        = $CI->patientmdl->getById($visit_log->patient_id);
        $insurance      = $CI->patientinsurancemdl->getPrimaryInsurance($visit_log->patient_id);
        $agency         = $CI->agencymdl->getByAgencyId($patient->agency_id);
        $episde_icd     = $CI->episodeicdmdl->get($visit_log->cms485_id);
        $emp_name       = $CI->usagymdl->getByUsAgyId(@$snpn->sup_empl_name_user_id);
        $phys_user_id   = $CI->usagymdl->getByUsAgyId($visit_log->phys_user_id);


        $tab_25         = $CI->parametermdl->getByType(25);
        $tab_25[NULL]   = NULL;
        $tab_30         = $CI->parametermdl->getByType(30);



        $path_ticket = realpath("style/images/icon_enable.gif");
        $path_img1   = realpath("style/images/task/snpn1.gif");



        $__FONT['PDF']['SIZE'] = 9;

        $__FONT['PDF']['FORM_MEDIUM'] = 10;

        $__FONT['PDF']['FORM_SMALL'] = 9;

        $__FONT['PDF']['FORM_SMALL2'] = 9;

        $__FONT['PDF']['FORM_SMALL3'] = 6.5;

        $__FONT['PDF']['FORM_SMALL4'] = 9.5;

        $__FONT['PDF']['FORM_arial8'] = 9.5;





        $CI->load->library('fpdf');

        if(!defined('FPDF_FONTPATH'))
          define('FPDF_FONTPATH',$CI->config->item('fonts_path'));

      $CI->fpdf = new fpdf;





      $cero_x = 11;

      $cero_y = 2;

      $CI->fpdf->Open();



      $pdf = $CI->fpdf;





      $CI->fpdf->AddPage();



      $CI->fpdf->SetDrawColor(130,100);

      $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_MEDIUM']);

        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 12 ), $agency->agency_name); // agency name



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL3']);

        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 22 ),"Licensed and Certified Home Health Agency");



        $CI->fpdf->Rect(8,28, 577, 780);



        $CI->fpdf->SetFont('Arial', 'B', $__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 190),( $cero_y + 36 ),"SKILLED NURSE - PROGRESS NOTE                            " .

                                                            "VISIT DATE: " . standard_date(mysql_to_unix($visit_log->visited_date))); // visit date

        $CI->fpdf->Line(( $cero_x - 3 ) , ($cero_y + 40.5 ), ( $cero_x + 574 ), ($cero_y + 40.5 ));



        $cero_y = 20;

        $CI->fpdf->SetTextColor(0,0,0);

        $CI->fpdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 32 ),"Patient Name: ");



        $CI->fpdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 60),( $cero_y + 32 ), $patient->first_name . " " . $patient->last_name); // pacient name



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->SetTextColor(0,0,0);



        $CI->fpdf->SetDrawColor(130,100);
        if (!empty($insurance)) {
            $CI->fpdf->Text(( $cero_x + 240),( $cero_y + 32 ), substr($insurance->tab_description, 0, 10)." #: ");
            $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
            $CI->fpdf->Text(( $cero_x + 290),( $cero_y + 32 ), $insurance->ins_id); // medicare id
        }else {
            $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
            $CI->fpdf->Text(( $cero_x + 390),( $cero_y + 32 ), "  NA ");
            $CI->fpdf->Rect(( $cero_x + 380),($cero_y + 23.5), 8.4, 8.4);
            $CI->fpdf->Image( $path_ticket, ( $cero_x + 381 ),($cero_y + 24.5),6);
        }

        /*$CI->fpdf->Text(( $cero_x + 240),( $cero_y + 32 ),"Medicare #: ");
        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 290),( $cero_y + 32 ), $patient->medicare_id); // medicare id*/


        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 395 +20),( $cero_y + 32 ),"Medical Rec#: ");
        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 455 +20),( $cero_y + 32 ), $patient->medical_rec_nbr); // medicare id


        /*$CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 390),( $cero_y + 32 ), "  NA ");
        $CI->fpdf->Rect(( $cero_x + 380),($cero_y + 23.5), 8.4, 8.4);
        if (is_null($patient->medicare_id)){
            $CI->fpdf->Image( $path_ticket, ( $cero_x + 381 ),($cero_y + 24.5),6);
        }*/

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 375),( $cero_y + 42 ),"  SOC: ");

        $CI->fpdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 415),( $cero_y + 42 ), standard_date(mysql_to_unix($visit_log->estimated_soc_date))); // soc date



        // primary and second icd

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 42 ),"Primary Dx: ");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 60),( $cero_y + 42 ), @$episde_icd[0]->icd9_name);



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 240),( $cero_y + 42 ),"Date: ");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 288),( $cero_y + 42 ), (!is_null(@$episde_icd[0]->icd_date) ? standard_date(mysql_to_unix(@$episde_icd[0]->icd_date)) : ""));



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 52 ),"Second Dx: ");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 60),( $cero_y + 52 ), @$episde_icd[1]->icd9_name);



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 240),( $cero_y + 52 ),"Date: ");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 288),( $cero_y + 52 ), (!is_null(@$episde_icd[1]->icd_date) ? standard_date(mysql_to_unix(@$episde_icd[1]->icd_date)) : ""));





        // start and end soc date

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 380),( $cero_y + 52 ),"From: ");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 415),( $cero_y + 52 ), standard_date(mysql_to_unix($visit_log->episode_start_date)));





        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 473),( $cero_y + 52 ),"To: ");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 518),( $cero_y + 52 ), standard_date(mysql_to_unix($visit_log->episode_end_date)));





        if ($visit_log->episode_start_date == $visit_log->estimated_soc_date)     {

            $CI->fpdf->Text(( $cero_x + 480),( $cero_y + 42 ),"   Certification");

        } else {

            $CI->fpdf->Text(( $cero_x + 495),( $cero_y + 42 ),"   Recertif.");

        }



        $CI->fpdf->Rect(( $cero_x + 473),($cero_y + 33.5), 8.4, 8.4);

        $CI->fpdf->Image( $path_ticket,( $cero_x + 474 ),($cero_y + 34.5),6);





        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 62 ),"Physician: ");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_arial8']);

        $CI->fpdf->Text(( $cero_x + 60),($cero_y + 62 ), @$phys_user_id->complete_name);



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 240),( $cero_y + 62 ), "Clinician:");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_arial8']);

        $CI->fpdf->Text(( $cero_x + 288),(  $cero_y + 62 ), $visit_log->first_name . " " .  $visit_log->last_name);



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 380),( $cero_y + 62 ), "Time In: ");

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 416),( $cero_y + 62 ), standard_date(mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_in), 'USA_TIME_C'));



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 473),( $cero_y + 62 ), "Time Out: ");

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 518),( $cero_y + 62 ), standard_date(mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_out), 'USA_TIME_C'));

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);





        $cero_y =$cero_y+5;

        $CI->fpdf->SetLineWidth( 0.5 );

        $CI->fpdf->Line(8, 85, 584, 85);



        $CI->fpdf->Rect(11, 87, 8.4, 8.4);

        $CI->fpdf->Text(23, 95,"Visit");

        if (@$snpn->visit_YN ==1) {

            $CI->fpdf->Image( $path_ticket, 12, 88,6);

        }





        $item=100;

        foreach ($CI->parametermdl->getByType(25) as $b_not_b_id => $b_not_b) {



           $CI->fpdf->Text($item, 95, $b_not_b);

           $pdf->Rect(($item - 11), 87, 8.4, 8.4);



           if ($b_not_b_id == @@$snpn->tab_25_Bill_Nonbill) {

               $pdf->Image($path_ticket, ($item - 10), 88, 6);

           }



           $item=$item+60;



       }





       $item=290;

       foreach ($CI->parametermdl->getByType(26) as $sn_id => $sn) {



           $CI->fpdf->Text($item, 95, $sn);

           $pdf->Rect(($item - 11), 87, 8.4, 8.4);



           if ($sn_id == @@$snpn->tab_26_SN) {

               $pdf->Image($path_ticket, ($item - 10), 88, 6);

           }



           $item=$item+55;



       }



       $CI->fpdf->Text(510, 95, "Mileage: " );

       $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);

       $CI->fpdf->Text(550, 95, $visit_log->mileage);

       $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);



       $CI->fpdf->Line(8, 98, 584, 98);





       $CI->fpdf->Text(20, 108, "Vital");

       $CI->fpdf->Text(20, 118, "Sign");



       $CI->fpdf->Line(45, 98, 45, 121);



       $CI->fpdf->Text(59, 113, "B/P");



       $CI->fpdf->Line(90, 98, 90, 121);

       $CI->fpdf->Text(97, 108, "Lying");



       $CI->fpdf->Line(130, 98, 130, 121);

       $CI->fpdf->Text(140, 108, "Sitting");



       $CI->fpdf->Line(170, 98, 170, 121);

       $CI->fpdf->Text(183, 108, "Standing");



       $CI->fpdf->Line(230, 98, 230, 121);

       $CI->fpdf->Text(244, 108, "Temp");



       $CI->fpdf->Line(280, 98, 280, 121);

       $CI->fpdf->Text(301, 108, "Resp");



       $CI->fpdf->Line(345, 98, 345, 121);

       $CI->fpdf->Text(361, 108, "Apical Pulse");



       $CI->fpdf->Line(430, 98, 430, 121);

       $CI->fpdf->Text(456, 108, "Radical Pulse");



       $CI->fpdf->Line(520, 98, 520, 121);

       $CI->fpdf->Text(531, 108, "Weight Labs");



       $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);

       $CI->fpdf->Text(97, 118,  @$snpn->BpLying);

       $CI->fpdf->Text(140, 118, @$snpn->BpSitting);

       $CI->fpdf->Text(193, 118, @$snpn->BpStanding);

       $CI->fpdf->Text(246, 118, @$snpn->Temperature);

       $CI->fpdf->Text(305, 118, @$snpn->Respiration);

       $CI->fpdf->Text(381, 118, @$snpn->PulseApical);

       $CI->fpdf->Text(476, 118, @$snpn->PulseRadial);

       $CI->fpdf->Text(548, 118, @$snpn->Weight);





       $CI->fpdf->Line(8, 121, 584, 121);





       $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

       $CI->fpdf->Text(11, 131, "PHYSICAL ASSESSMENT");





       $CI->fpdf->Line(8, 134, 584, 134);





       $CI->fpdf->Text(11, 144, "RESPIRATORY");



       $CI->fpdf->Rect(11, 146, 8.4, 8.4);

       $CI->fpdf->Text(23, 154, "No Problem");

       if (@$snpn->RespNoProblem ==1) {

        $CI->fpdf->Image( $path_ticket, 12, 147,6);

    }



    $CI->fpdf->Rect(91, 146, 8.4, 8.4);

    $CI->fpdf->Text(103, 154, "Apnea");

    if (@$snpn->RespApnea == 1) {

        $CI->fpdf->Image( $path_ticket, 92, 147,6);

    }



    $CI->fpdf->Rect(146, 146, 8.4, 8.4);

    $CI->fpdf->Text(158, 154, "Dyspnea with moderate exertion");

    if (@$snpn->RespDyspnea == 1) {

        $CI->fpdf->Image( $path_ticket, 147, 147,6);

    }





    $CI->fpdf->Rect(11, 156, 8.4, 8.4);

    $CI->fpdf->Text(23, 164, "Resp Uneven");

    if (@$snpn->RespUneven ==1) {

        $CI->fpdf->Image( $path_ticket, 12, 157,6);

    }



    $CI->fpdf->Rect(91, 156, 8.4, 8.4);

    $CI->fpdf->Text(103, 164, "Cough");

    if (@$snpn->RespCough == 1) {

        $CI->fpdf->Image( $path_ticket, 92, 157,6);

    }



    $CI->fpdf->Rect(146, 156, 8.4, 8.4);

    $CI->fpdf->Text(158, 164, "Sputum");

    if (@$snpn->RespSputum == 1) {

        $CI->fpdf->Image( $path_ticket, 147, 157,6);

    }



    $CI->fpdf->Rect(209, 156, 8.4, 8.4);

    $CI->fpdf->Text(221, 164, "Rales");

    if (@$snpn->RespRales == 1) {

        $CI->fpdf->Image( $path_ticket, 210, 157,6);

    }





    $CI->fpdf->Text(11, 174, "Breath Sounds:");



    $CI->fpdf->Rect(91, 166, 8.4, 8.4);

    $CI->fpdf->Text(103, 174, "Clear");

    if (@$snpn->RespClear == 1) {

        $CI->fpdf->Image( $path_ticket, 92, 167,6);

    }



    $CI->fpdf->Rect(146, 166, 8.4, 8.4);

    $CI->fpdf->Text(158, 174, "Rhonchi");

    if (@$snpn->RespRhonchi == 1) {

        $CI->fpdf->Image( $path_ticket, 147, 167,6);

    }



    $CI->fpdf->Rect(209, 166, 8.4, 8.4);

    $CI->fpdf->Text(221, 174, "Wheezing");

    if (@$snpn->RespWheezing == 1) {

        $CI->fpdf->Image( $path_ticket, 210, 167,6);

    }





    $CI->fpdf->Rect(11, 176, 8.4, 8.4);

    $CI->fpdf->Text(23, 184, "0");



    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE'] - 3);

    $CI->fpdf->Text(28, 182, "2");



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(40, 184, @$snpn->RespOxigAmt);

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

    $CI->fpdf->Text(31, 184, "_____ Lts");



    if (@$snpn->RespO2 ==1) {

        $CI->fpdf->Image( $path_ticket, 12, 177, 6);

    }





    $CI->fpdf->Text(11, 194, "Other:");

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(38, 194, @$snpn->RespComments);





    $CI->fpdf->Line(304, 134, 304, 376);





    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Text(309, 144, "GASTRO INTESTINAL");



    $CI->fpdf->Rect(309, 146, 8.4, 8.4);

    $CI->fpdf->Text(321, 154, "No Problem");

    if (@$snpn->GastroNoprob ==1) {

        $CI->fpdf->Image( $path_ticket, 310, 147,6);

    }



    $CI->fpdf->Rect(380, 146, 8.4, 8.4);

    $CI->fpdf->Text(392, 154, "Appetite Decreased");

    if (@$snpn->GastroAppetDecr == 1) {

        $CI->fpdf->Image( $path_ticket, 381, 147,6);

    }



    $CI->fpdf->Text(480, 154, "Weight:");



    $CI->fpdf->Rect(515, 146, 8.4, 8.4);

    $CI->fpdf->Text(527, 154, "Loss");

    if (@$snpn->tab_29_loss_gain == 1) {

        $CI->fpdf->Image( $path_ticket, 516, 147,6);

    }



    $CI->fpdf->Rect(550, 146, 8.4, 8.4);

    $CI->fpdf->Text(562, 154, "Gain");

    if (@$snpn->tab_29_loss_gain == 2) {

        $CI->fpdf->Image( $path_ticket, 551, 147,6);

    }



    $CI->fpdf->Text(545, 164, "Amt  ___");

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(568, 164, @$snpn->GastroLossGainAmt);

    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(309, 156, 8.4, 8.4);

    $CI->fpdf->Text(321, 164, "Constipation");

    if (@$snpn->GastroConstipation ==1) {

        $CI->fpdf->Image( $path_ticket, 310, 157,6);

    }



    $CI->fpdf->Rect(380, 156, 8.4, 8.4);

    $CI->fpdf->Text(392, 164, "Incontinent");

    if (@$snpn->GastroIcontinent == 1) {

        $CI->fpdf->Image( $path_ticket, 381, 157,6);

    }



    $CI->fpdf->Rect(457, 156, 8.4, 8.4);

    $CI->fpdf->Text(469, 164, "Last BM");

    if (@$snpn->GastroLastBM != '') {

        $CI->fpdf->Image( $path_ticket, 458, 157,6);

    }

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(505, 164, standard_date(mysql_to_unix(@$snpn->GastroLastBM), '%M/%d'));

    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(309, 166, 8.4, 8.4);

    $CI->fpdf->Text(321, 174, "Nausea");

    if (@$snpn->GastroNausea ==1) {

        $CI->fpdf->Image( $path_ticket, 310, 167,6);

    }



    $CI->fpdf->Rect(380, 166, 8.4, 8.4);

    $CI->fpdf->Text(392, 174, "Vomiting");

    if (@$snpn->GastroVomiting == 1) {

        $CI->fpdf->Image( $path_ticket, 381, 167,6);

    }



    $CI->fpdf->Rect(457, 166, 8.4, 8.4);

    $CI->fpdf->Text(469, 174, "Diarrhea");

    if (@$snpn->GastroDiarrhea == 1) {

        $CI->fpdf->Image( $path_ticket, 458, 167,6);

    }



    $CI->fpdf->Rect(521, 166, 8.4, 8.4);

    $CI->fpdf->Text(533, 174, "Dysphagia");

    if (@$snpn->GastroDysphagia == 1) {

        $CI->fpdf->Image( $path_ticket, 522, 167,6);

    }





    $CI->fpdf->Rect(309, 176, 8.4, 8.4);

    $CI->fpdf->Text(321, 184, "Abdomen");

    if (@$snpn->tab_28_GastroAbdomen > 0) {

        $CI->fpdf->Image( $path_ticket, 310, 177,6);

    }



    $CI->fpdf->Rect(380, 176, 8.4, 8.4);

    $CI->fpdf->Text(392, 184, "Soft");

    if (@$snpn->tab_28_GastroAbdomen == 1) {

        $CI->fpdf->Image( $path_ticket, 381, 177,6);

    }



    $CI->fpdf->Rect(457, 176, 8.4, 8.4);

    $CI->fpdf->Text(469, 184, "Firm");

    if (@$snpn->tab_28_GastroAbdomen == 2) {

        $CI->fpdf->Image( $path_ticket, 458, 177,6);

    }



    $CI->fpdf->Rect(521, 176, 8.4, 8.4);

    $CI->fpdf->Text(533, 184, "Distended");

    if (@$snpn->tab_28_GastroAbdomen == 3) {

        $CI->fpdf->Image( $path_ticket, 522, 177,6);

    }





    $CI->fpdf->Text(309, 194, "Diet Compliance:");



    $CI->fpdf->Rect(380, 186, 8.4, 8.4);

    $CI->fpdf->Text(392, 194, "Yes");

    if (@$snpn->GastroDietCompliance_YN == 1) {

        $CI->fpdf->Image( $path_ticket, 381, 187,6);

    }



    $CI->fpdf->Rect(415, 186, 8.4, 8.4);

    $CI->fpdf->Text(427, 194, "No");

    if (@$snpn->GastroDietCompliance_YN == '0') {

        $CI->fpdf->Image( $path_ticket, 416, 187,6);

    }



    $CI->fpdf->Rect(457, 186, 8.4, 8.4);

    $CI->fpdf->Text(469, 194, "Ostomy Care Taught");

    if (@$snpn->GastroOstoTaught == 1) {

        $CI->fpdf->Image( $path_ticket, 458, 187,6);

    }



    $CI->fpdf->Rect(457, 196, 8.4, 8.4);

    $CI->fpdf->Text(469, 204, "Ostomy Care Performed");

    if (@$snpn->GastroOstoPerformed == 1) {

        $CI->fpdf->Image( $path_ticket, 458, 197,6);

    }





    $CI->fpdf->Line(8, 207, 584, 207);





    $CI->fpdf->Text(11, 217, "NEURO");



    $CI->fpdf->Rect(11, 219, 8.4, 8.4);

    $CI->fpdf->Text(23, 227, "No Problem");

    if (@$snpn->NeuroNoProb ==1) {

        $CI->fpdf->Image( $path_ticket, 12, 220,6);

    }



    $CI->fpdf->Rect(91, 219, 8.4, 8.4);

    $CI->fpdf->Text(103, 227, "Alert");

    if (@$snpn->NeuroAlert == 1) {

        $CI->fpdf->Image( $path_ticket, 92, 220,6);

    }



    $CI->fpdf->Rect(146, 219, 8.4, 8.4);

    $CI->fpdf->Text(158, 227, "Lethargic");

    if (@$snpn->NeuroLethargic == 1) {

        $CI->fpdf->Image( $path_ticket, 147, 220,6);

    }



    $CI->fpdf->Rect(209, 219, 8.4, 8.4);

    $CI->fpdf->Text(221, 227, "Forgetful");

    if (@$snpn->NeuroForget == 1) {

        $CI->fpdf->Image( $path_ticket, 210, 220,6);

    }





    $CI->fpdf->Rect(11, 229, 8.4, 8.4);

    $CI->fpdf->Text(23, 237, "Disoriented");

    if (@$snpn->NeuroDisor ==1) {

        $CI->fpdf->Image( $path_ticket, 12, 230,6);

    }



    $CI->fpdf->Rect(91, 229, 8.4, 8.4);

    $CI->fpdf->Text(103, 237, "Dizziness");

    if (@$snpn->NeuroDizz == 1) {

        $CI->fpdf->Image( $path_ticket, 92, 230,6);

    }



    $CI->fpdf->Rect(146, 229, 8.4, 8.4);

    $CI->fpdf->Text(158, 237, "Tremors");

    if (@$snpn->NeuroTremors == 1) {

        $CI->fpdf->Image( $path_ticket, 147, 230,6);

    }



    $CI->fpdf->Rect(209, 229, 8.4, 8.4);

    $CI->fpdf->Text(221, 237, "Agitated");

    if (@$snpn->NeuroAgitaded == 1) {

        $CI->fpdf->Image( $path_ticket, 210, 230,6);

    }





    $CI->fpdf->Text(11, 247, "Grasps:");



    $CI->fpdf->Rect(70, 239, 8.4, 8.4);

    $CI->fpdf->Text(82, 247, "R");

    if (@$snpn->NeuroGraspR == 1) {

        $CI->fpdf->Image( $path_ticket, 71, 240,6);

    }



    $CI->fpdf->Rect(91, 239, 8.4, 8.4);

    $CI->fpdf->Text(103, 247, "L");

    if (@$snpn->NeuroGraspL == 1) {

        $CI->fpdf->Image( $path_ticket, 92, 240,6);

    }



    $CI->fpdf->Rect(131, 239, 8.4, 8.4);

    $CI->fpdf->Text(143, 247, "Pupils not equal and not reactive to light");

    if (@$snpn->NeuroPupils == 1) {

        $CI->fpdf->Image( $path_ticket, 132, 240,6);

    }





    $CI->fpdf->Text(11, 257, "Oriented to:");



    $CI->fpdf->Rect(91, 249, 8.4, 8.4);

    $CI->fpdf->Text(103, 257, "Time");

    if (@$snpn->NeuroOrienTime == 1) {

        $CI->fpdf->Image( $path_ticket, 92, 250,6);

    }



    $CI->fpdf->Rect(146, 249, 8.4, 8.4);

    $CI->fpdf->Text(158, 257, "Place");

    if (@$snpn->NeuroOrienPlace == 1) {

        $CI->fpdf->Image( $path_ticket, 147, 250,6);

    }



    $CI->fpdf->Rect(209, 249, 8.4, 8.4);

    $CI->fpdf->Text(221, 257, "Person");

    if (@$snpn->NeuroOrienPerson == 1) {

        $CI->fpdf->Image( $path_ticket, 210, 250,6);

    }



    $CI->fpdf->Text(11, 267, "Other:");

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(37, 267, @$snpn->NeuroOrienOther);

    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);





    $CI->fpdf->Text(309, 217, "EARS/EYES/NOSE/THROAT");





    $CI->fpdf->Rect(309, 219, 8.4, 8.4);

    $CI->fpdf->Text(321, 227, "No Problem");

    if (@$snpn->EENTnoProb ==1) {

        $CI->fpdf->Image( $path_ticket, 310, 220,6);

    }



    $CI->fpdf->Rect(395, 219, 8.4, 8.4);

    $CI->fpdf->Text(407, 227, "Impaired Vision");

    if (@$snpn->EENTImparedVision == 1) {

        $CI->fpdf->Image( $path_ticket, 396, 220,6);

    }



    $CI->fpdf->Rect(494, 219, 8.4, 8.4);

    $CI->fpdf->Text(506, 227, "Cataract/Glaucoma");

    if (@$snpn->EENTCataract == 1) {

        $CI->fpdf->Image( $path_ticket, 495, 220,6);

    }





    $CI->fpdf->Rect(309, 229, 8.4, 8.4);

    $CI->fpdf->Text(321, 237, "Deaf");

    if (@$snpn->EENTDeaf ==1) {

        $CI->fpdf->Image( $path_ticket, 310, 230,6);

    }



    $CI->fpdf->Rect(395, 229, 8.4, 8.4);

    $CI->fpdf->Text(407, 237, "Impaired Speech");

    if (@$snpn->EENTImparedSpeech == 1) {

        $CI->fpdf->Image( $path_ticket, 396, 230,6);

    }



    $CI->fpdf->Rect(494, 229, 8.4, 8.4);

    $CI->fpdf->Text(506, 237, "Blind");

    if (@$snpn->EENTBlind == 1) {

        $CI->fpdf->Image( $path_ticket, 495, 230,6);

    }





    $CI->fpdf->Rect(309, 239, 8.4, 8.4);

    $CI->fpdf->Text(321, 247, "Tinnitus");

    if (@$snpn->EENTTinnitus ==1) {

        $CI->fpdf->Image( $path_ticket, 310, 240,6);

    }



    $CI->fpdf->Rect(395, 239, 8.4, 8.4);

    $CI->fpdf->Text(407, 247, "Epistaxis");

    if (@$snpn->EENTEpistaxis == 1) {

        $CI->fpdf->Image( $path_ticket, 396, 240,6);

    }



    $CI->fpdf->Rect(494, 239, 8.4, 8.4);

    $CI->fpdf->Text(506, 247, "Congestion");

    if (@$snpn->EENTCongestion == 1) {

        $CI->fpdf->Image( $path_ticket, 495, 240,6);

    }





    $CI->fpdf->Rect(309, 249, 8.4, 8.4);

    $CI->fpdf->Text(321, 257, "Impaired Hearing");

    if (@$snpn->EENTImpairedHearing ==1) {

        $CI->fpdf->Image( $path_ticket, 310, 250,6);

    }





    $CI->fpdf->Line(8, 270, 584, 270);





    $CI->fpdf->Text(11, 280, "MUSCULOSKELETAL");





    $CI->fpdf->Rect(11, 282, 8.4, 8.4);

    $CI->fpdf->Text(23, 290, "No Problem");

    if (@$snpn->MuscuNoprob ==1) {

        $CI->fpdf->Image( $path_ticket, 12, 283,6);

    }



    $CI->fpdf->Rect(79, 282, 8.4, 8.4);

    $CI->fpdf->Text(91, 290, "Bedbound");

    if (@$snpn->MuscuBedBound ==1) {

        $CI->fpdf->Image( $path_ticket, 80, 283,6);

    }



    $CI->fpdf->Rect(139, 282, 8.4, 8.4);

    $CI->fpdf->Text(151, 290, "Chairbound");

    if (@$snpn->MuscuChairBound ==1) {

        $CI->fpdf->Image( $path_ticket, 140, 283,6);

    }



    $CI->fpdf->Rect(212, 282, 8.4, 8.4);

    $CI->fpdf->Text(224, 290, "Ambulatory Aid");

    if (@$snpn->MuscuAmbAid ==1) {

        $CI->fpdf->Image( $path_ticket, 213, 283,6);

    }





    $CI->fpdf->Rect(11, 292, 8.4, 8.4);

    $CI->fpdf->Text(23, 300, "Unsteady Balance/Gait");

    if (@$snpn->MuscuUnsteadBalanceGait ==1) {

        $CI->fpdf->Image( $path_ticket, 12, 293,6);

    }



    $CI->fpdf->Rect(139, 292, 8.4, 8.4);

    $CI->fpdf->Text(151, 300, "Amputations");

    if (@$snpn->MuscuAmput ==1) {

        $CI->fpdf->Image( $path_ticket, 140, 293,6);

    }



    $CI->fpdf->Rect(212, 292, 8.4, 8.4);

    $CI->fpdf->Text(224, 300, "Joint Pain/Stiffness");

    if (@$snpn->MuscuJoitPainStiffness ==1) {

        $CI->fpdf->Image( $path_ticket, 213, 293,6);

    }





    $CI->fpdf->Rect(11, 302, 8.4, 8.4);

    $CI->fpdf->Text(23, 310, "Contracture");

    if (@$snpn->MuscuContracture ==1) {

        $CI->fpdf->Image( $path_ticket, 12, 303,6);

    }



    $CI->fpdf->Rect(79, 302, 8.4, 8.4);

    $CI->fpdf->Text(91, 310, "Paralysis");

    if (@$snpn->MuscuParalysis ==1) {

        $CI->fpdf->Image( $path_ticket, 80, 303,6);

    }



    $CI->fpdf->Rect(139, 302, 8.4, 8.4);

    $CI->fpdf->Text(151, 310, "Arthritis");

    if (@$snpn->MuscuArthritis ==1) {

        $CI->fpdf->Image( $path_ticket, 140, 303,6);

    }



    $CI->fpdf->Rect(212, 302, 8.4, 8.4);

    $CI->fpdf->Text(224, 310, "Falls");

    if (@$snpn->MuscuFalls ==1) {

        $CI->fpdf->Image( $path_ticket, 213, 303,6);

    }





    $CI->fpdf->Text(309, 280, "CIRCULATORY");



    $CI->fpdf->Rect(309, 282, 8.4, 8.4);

    $CI->fpdf->Text(321, 290, "No Problem");

    if (@$snpn->CircNoprob ==1) {

        $CI->fpdf->Image( $path_ticket, 310, 283,6);

    }



    $CI->fpdf->Rect(380, 282, 8.4, 8.4);

    $CI->fpdf->Text(392, 290, "Heart Irregular");

    if (@$snpn->CircNoprob ==1) {

        $CI->fpdf->Image( $path_ticket, 381, 283,6);

    }



    $CI->fpdf->Text(460, 290, "Edema:");



//        $CI->fpdf->Rect(492, 282, 8.4, 8.4);

//        if (@$snpn->CircEdemaRLE > 0) {

//            $CI->fpdf->Image( $path_ticket, 493, 283,6);

//        }

    $CI->fpdf->Text(504, 290, "RLE ___");

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(524, 290, @$snpn->CircEdemaRLE);

    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



//        $CI->fpdf->Rect(540, 282, 8.4, 8.4);

//        if (@$snpn->CircEdemaLLE > 0) {

//            $CI->fpdf->Image( $path_ticket, 541, 283,6);

//        }

    $CI->fpdf->Text(548, 290, "LLE ___");

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(570, 290, @$snpn->CircEdemaLLE);

    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(309, 292, 8.4, 8.4);

    $CI->fpdf->Text(321, 300, "Gallop");

    if (@$snpn->CircGallop ==1) {

        $CI->fpdf->Image( $path_ticket, 310, 293,6);

    }



    $CI->fpdf->Rect(380, 292, 8.4, 8.4);

    $CI->fpdf->Text(392, 300, "Murmur");

    if (@$snpn->CircMurmur ==1) {

        $CI->fpdf->Image( $path_ticket, 381, 293,6);

    }



//        $CI->fpdf->Rect(492, 292, 8.4, 8.4);

//        if (@$snpn->CircEdemaRVE > 0) {

//            $CI->fpdf->Image( $path_ticket, 493, 293,6);

//        }

    $CI->fpdf->Text(504, 300, "RUE ___");

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(524, 300, @$snpn->CircEdemaRVE);

    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



//        $CI->fpdf->Rect(540, 292, 8.4, 8.4);

//        if (@$snpn->CircEdemaLVE > 0) {

//            $CI->fpdf->Image( $path_ticket, 541, 293,6);

//        }

    $CI->fpdf->Text(548, 300, "LUE ___");

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(570, 300, @$snpn->CircEdemaLVE);

    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);





    $CI->fpdf->Text(309, 310, "Peripheral Pulses:");

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(383, 310, @$snpn->CircPeripheralPulses);

    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Line(8, 313, 584, 313);





    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 323, "SKIN CONDITION");



    $CI->fpdf->Rect(11, 325, 8.4, 8.4);

    $CI->fpdf->Text(23, 333, "No Problem");

    if (@$snpn->SkinNoProb ==1) {

        $CI->fpdf->Image( $path_ticket, 12, 326,6);

    }



    $CI->fpdf->Rect(87, 325, 8.4, 8.4);

    $CI->fpdf->Text(99, 333, "Warm");

    if (@$snpn->SkinWarm ==1) {

        $CI->fpdf->Image( $path_ticket, 88, 326,6);

    }



    $CI->fpdf->Rect(153, 325, 8.4, 8.4);

    $CI->fpdf->Text(165, 333, "Cool");

    if (@$snpn->SkinCool ==1) {

        $CI->fpdf->Image( $path_ticket, 154, 326,6);

    }



    $CI->fpdf->Rect(217, 325, 8.4, 8.4);

    $CI->fpdf->Text(229, 333, "Cold");

    if (@$snpn->SkinCold ==1) {

        $CI->fpdf->Image( $path_ticket, 218, 326,6);

    }





    $CI->fpdf->Rect(11, 335, 8.4, 8.4);

    $CI->fpdf->Text(23, 343, "Clammy");

    if (@$snpn->SkinClammy ==1) {

        $CI->fpdf->Image( $path_ticket, 12, 336,6);

    }



    $CI->fpdf->Rect(87, 335, 8.4, 8.4);

    $CI->fpdf->Text(99, 343, "Turgor fair");

    if (@$snpn->SkinTurgor ==1) {

        $CI->fpdf->Image( $path_ticket, 88, 336,6);

    }



    $CI->fpdf->Rect(153, 335, 8.4, 8.4);

    $CI->fpdf->Text(165, 343, "Diaphoretic");

    if (@$snpn->SkinDiaphorectic ==1) {


        $CI->fpdf->Image( $path_ticket, 154, 336,6);

    }



    $CI->fpdf->Rect(217, 335, 8.4, 8.4);

    $CI->fpdf->Text(229, 343, "Skin Broken");

    if (@$snpn->SkinBroken ==1) {

        $CI->fpdf->Image( $path_ticket, 218, 336,6);

    }





    $CI->fpdf->Rect(11, 345, 8.4, 8.4);

    $CI->fpdf->Text(23, 353, "Pale");

    if (@$snpn->SkinPale ==1) {

        $CI->fpdf->Image( $path_ticket, 12, 346,6);

    }



    $CI->fpdf->Rect(87, 345, 8.4, 8.4);

    $CI->fpdf->Text(99, 353, "Jaundice");

    if (@$snpn->SkinJaundice ==1) {

        $CI->fpdf->Image( $path_ticket, 88, 346,6);

    }



    $CI->fpdf->Rect(153, 345, 8.4, 8.4);

    $CI->fpdf->Text(165, 353, "Cyanotic");

    if (@$snpn->SkinCyanotic ==1) {

        $CI->fpdf->Image( $path_ticket, 154, 346,6);

    }



    $CI->fpdf->Rect(217, 345, 8.4, 8.4);

    $CI->fpdf->Text(229, 353, "Dry");

    if (@$snpn->SkinDry ==1) {

        $CI->fpdf->Image( $path_ticket, 218, 346,6);

    }



    $CI->fpdf->Text(11, 363, "Other:");

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(38, 363, @$snpn->SkinComment);

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);



    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(309, 323, "GU STATUS");



    $CI->fpdf->Rect(307, 325, 8.4, 8.4);

    $CI->fpdf->Text(319, 333, "No Problem");

    if (@$snpn->GUStatNoPfrob ==1) {

        $CI->fpdf->Image( $path_ticket, 308, 326,6);

    }



    $CI->fpdf->Rect(370, 325, 8.4, 8.4);

    $CI->fpdf->Text(382, 333, "Incontinent");

    if (@$snpn->GUStatIncontinent ==1) {

        $CI->fpdf->Image( $path_ticket, 371, 326,6);

    }



    $CI->fpdf->Rect(433, 325, 8.4, 8.4);

    $CI->fpdf->Text(445, 333, "Retention");

    if (@$snpn->GUStatRetention ==1) {

        $CI->fpdf->Image( $path_ticket, 434, 326,6);

    }



    $CI->fpdf->Rect(489, 325, 8.4, 8.4);

    $CI->fpdf->Text(501, 333, "Dysuria-Freq _____");

    if (@$snpn->GUStatDisuriaFreq ==1) {

        $CI->fpdf->Image( $path_ticket, 490, 326,6);

    }

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(554, 333, @$snpn->GUStatDisuriaFreqValue);

    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(307, 335, 8.4, 8.4);

    $CI->fpdf->Text(319, 343, "Catheter");

    if (@$snpn->GUStatCatherer ==1) {

        $CI->fpdf->Image( $path_ticket, 308, 336,6);

    }



    $CI->fpdf->Rect(370, 335, 8.4, 8.4);

    $CI->fpdf->Text(382, 343, "Hematuria");

    if (@$snpn->GUStatHematuria ==1) {

        $CI->fpdf->Image( $path_ticket, 371, 336,6);

    }



    $CI->fpdf->Rect(433, 335, 8.4, 8.4);

    $CI->fpdf->Text(445, 343, "Bladder Program");

    if (@$snpn->GUStatBladderProgram ==1) {

        $CI->fpdf->Image( $path_ticket, 434, 336,6);

    }





    $CI->fpdf->Rect(307, 345, 8.4, 8.4);

    $CI->fpdf->Text(319, 353, "Foley Insertion");

    if (@$snpn->GUStatFoleyInsert ==1) {

        $CI->fpdf->Image( $path_ticket, 308, 346,6);

    }



    $CI->fpdf->Rect(387, 345, 8.4, 8.4);

    $CI->fpdf->Text(399, 353, "Teaching Catheter Care");

    if (@$snpn->GUStatTeach ==1) {

        $CI->fpdf->Image( $path_ticket, 388, 346,6);

    }



    $CI->fpdf->Rect(503, 345, 8.4, 8.4);

    $CI->fpdf->Text(515, 353, "Output _____ Lts");

    if (@$snpn->GUStatTeachValue > 0) {

        $CI->fpdf->Image( $path_ticket, 504, 346,6);

    }

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(539, 353, @$snpn->GUStatTeachValue);

    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Text(307, 363, "Urine:");



    $CI->fpdf->Rect(333, 355, 8.4, 8.4);

    $CI->fpdf->Text(345, 363, "Clear");

    if (@$snpn->GUStatUrineClear ==1) {

        $CI->fpdf->Image( $path_ticket, 334, 356,6);

    }



    $CI->fpdf->Rect(370, 355, 8.4, 8.4);

    $CI->fpdf->Text(382, 363, "Cloudy");

    if (@$snpn->GUStatUrineCloudy ==1) {

        $CI->fpdf->Image( $path_ticket, 371, 356,6);

    }



    $CI->fpdf->Rect(414, 355, 8.4, 8.4);

    $CI->fpdf->Text(426, 363, "Odor");

    if (@$snpn->GUStatUrineOdor ==1) {

        $CI->fpdf->Image( $path_ticket, 415, 356,6);

    }



    $CI->fpdf->Rect(454, 355, 8.4, 8.4);

    $CI->fpdf->Text(466, 363, "Sediment");

    if (@$snpn->GUStatUrineSediment ==1) {

        $CI->fpdf->Image( $path_ticket, 455, 356,6);

    }



    $CI->fpdf->Rect(333, 365, 8.4, 8.4);

    $CI->fpdf->Text(345, 373, "Other:");

    if (@$snpn->GUStatUrineOther != '') {

        $CI->fpdf->Image( $path_ticket, 334, 366,6);

    }

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(370, 373, @$snpn->GUStatUrineOther);

    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Line(8, 376, 584, 376);



    $pdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 386, "Glucometer:");



    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Rect(81, 378, 8.4, 8.4);

    $CI->fpdf->Text(93, 386, "N/A");

    if (@$snpn->ClucoNotAplic != '') {

        $CI->fpdf->Image( $path_ticket, 82, 379,6);

    }



    $CI->fpdf->Rect(120, 378, 8.4, 8.4);

    $CI->fpdf->Text(132, 386, "Control");

    if (@$snpn->ClucoControl != '') {

        $CI->fpdf->Image( $path_ticket, 121, 379,6);

    }



    $CI->fpdf->Text(187, 386, "Results:");

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(221, 386, @$snpn->ClucoResults);





    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 396, "FSBS obtained from                          finger");



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(95, 396, @$snpn->ClucoFSBSObtainFrom);



    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(187, 396, "Results:");

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(221, 396, @$snpn->ClucoFSBSResults);



    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(518, 388, 8.4, 8.4);

    $CI->fpdf->Text(530, 396, "FBS");

    if (@$snpn->ClucoFBS ==1) {

        $CI->fpdf->Image( $path_ticket, 519, 389, 6);

    }



    $CI->fpdf->Rect(553, 388, 8.4, 8.4);

    $CI->fpdf->Text(565, 396, "RBS");

    if (@$snpn->ClucoRBS ==1) {

        $CI->fpdf->Image( $path_ticket, 554, 389, 6);

    }





    $CI->fpdf->Line(8, 400, 584, 400);



    $pdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 410, "Injection of Medications:");



    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Rect(119, 402, 8.4, 8.4);

    $CI->fpdf->Text(131, 410, "N/A");

    if (@$snpn->InjecMedicNotAplic == 1) {

        $CI->fpdf->Image( $path_ticket, 120, 403,6);

    }



    $CI->fpdf->Text(192, 410, "Site:");

    $CI->fpdf->Text(372, 410, "Route:");



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(214, 410, @$snpn->InjecMedicSite);

    $CI->fpdf->Text(401, 410, @$snpn->InjecMedicRoute);





    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Text(11, 420, "Medication:");

    $CI->fpdf->Text(192, 420, "Patient Response:");



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(60, 420, @$snpn->InjecMedicMedication);

    $CI->fpdf->Text(268, 420, @$snpn->InjecMedicPatientResp);





    $CI->fpdf->Line(8, 423, 584, 423);





    $pdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 433, "Documentation of patient inability to perform insulin injections or other IM or SQ injections:");

    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(11, 435, 8.4, 8.4);

    $CI->fpdf->Text(23, 443, "The patient has impaired mental cognition.");

    if (@$snpn->PatInhabImpairedMental == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 436,6);

    }





    $CI->fpdf->Rect(11, 445, 8.4, 8.4);

    $CI->fpdf->Text(23, 453, "The patient has impaired functional ability due to:");

    if (@$snpn->PatInhabPoorHandDex == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 446,6);

    }



    $CI->fpdf->Rect(225, 445, 8.4, 8.4);

    $CI->fpdf->Text(237, 453, "Poor hand dexterity");

    if (@$snpn->PatInhabPoorHandDex == 1) {

        $CI->fpdf->Image( $path_ticket, 226, 446,6);

    }



    $CI->fpdf->Rect(320, 445, 8.4, 8.4);

    $CI->fpdf->Text(332, 453, "Poor vision");

    if (@$snpn->PatInhabPoorVision == 1) {

        $CI->fpdf->Image( $path_ticket, 321, 446,6);

    }



    $CI->fpdf->Rect(384, 445, 8.4, 8.4);

    $CI->fpdf->Text(396, 453, "Arthritic hands");

    if (@$snpn->PatInhabArthriticHands == 1) {

        $CI->fpdf->Image( $path_ticket, 385, 446,6);

    }



    $CI->fpdf->Rect(461, 445, 8.4, 8.4);

    $CI->fpdf->Text(473, 453, "Poor hand/eye coordination");

    if (@$snpn->PatInhabPoorHECoord == 1) {

        $CI->fpdf->Image( $path_ticket, 462, 446,6);

    }





    $CI->fpdf->Rect(11, 456, 8.4, 8.4);

    $CI->fpdf->Text(23, 464, "Paralisys:");

    if (@$snpn->ParaRight == 1 || @$snpn->ParaLeft == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 457,6);

    }



    $CI->fpdf->Rect(69, 456, 8.4, 8.4);

    $CI->fpdf->Text(81, 464, "Right side");

    if (@$snpn->ParaRight == 1) {

        $CI->fpdf->Image( $path_ticket, 70, 457,6);

    }



    $CI->fpdf->Rect(128, 456, 8.4, 8.4);

    $CI->fpdf->Text(140, 464, "Left side");

    if (@$snpn->ParaLeft == 1) {

        $CI->fpdf->Image( $path_ticket, 129, 457,6);

    }



    $CI->fpdf->Rect(184, 456, 8.4, 8.4);

    $CI->fpdf->Text(196, 464, "Other:");

    if (@$snpn->PatInhabOther == 1) {

        $CI->fpdf->Image( $path_ticket, 185, 457,6);

    }



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(223, 464, @$snpn->PatInhabOtherText);





    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(11, 466, 8.4, 8.4);

    $CI->fpdf->Text(23, 474, "There is no able and willing caregiver to perform insulin injections or other IM or SQ injections.");

    if (@$snpn->PatInhabNoWillingCaregiver == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 467,6);

    }



    $CI->fpdf->Rect(461, 466, 8.4, 8.4);

    $CI->fpdf->Text(473, 474, "N/A");

    if (@$snpn->PatInhabNoWillingCaregiverNA == 1) {

        $CI->fpdf->Image( $path_ticket, 462, 467,6);

    }





    $CI->fpdf->Line(8, 478, 584, 478);





    $pdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 488, "Additional clinical findings:");



    $CI->fpdf->SetXY(8, 493);

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->MultiCell(576, 10, substr(@$snpn->AddClinicalFindings, 0, 284));

    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Line(8, 528, 584, 528);





    $pdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 538, "Skilled Nursing Care Performed:");



    $CI->fpdf->SetXY(8, 541);

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->MultiCell(576, 10, substr(@$snpn->SkilledNursedCarePerformed, 0, 1206));

    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Line(8, 675, 584, 675);





    $pdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 685, "Patient/Caregiver Response:");



    $pdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Rect(11, 688, 8.4, 8.4);

    $CI->fpdf->Text(23, 695, "Verbalize understanding");

    if (@$snpn->PatCaregRespVerbal == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 689,6);

    }



    $CI->fpdf->Rect(135, 688, 8.4, 8.4);

    $CI->fpdf->Text(148, 695, "Need more teaching");

    if (@$snpn->PatCaregRespNeedTeaching == 1) {

        $CI->fpdf->Image( $path_ticket, 136, 689,6);

    }



    $CI->fpdf->Rect(245, 688, 8.4, 8.4);

    $CI->fpdf->Text(258, 695, "Need more following");

    if (@$snpn->PatCaregRespNeedMoreFollow == 1) {

        $CI->fpdf->Image( $path_ticket, 246, 689,6);

    }







    $CI->fpdf->Text(23, 706, "Other:");





    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(50, 706, @$snpn->PatCaregRespNeedMoreOther);





    $CI->fpdf->Line(8, 710, 584, 710);





    $pdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 719, "Progress Toward Goals on POC:");



    $CI->fpdf->SetXY(8, 722);

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->MultiCell(578, 10, substr(@$snpn->ProgTowaGoal, 0, 284));





    $CI->fpdf->Line(8, 753, 584, 753);





    $pdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 763, "New Identified Problems/Goals:");



    $CI->fpdf->SetXY(8, 764);

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->MultiCell(578, 10, substr(@$snpn->NewIdentProbGoal, 0, 190));







        ######PAGE 2 #######

    $cero_x = 11;

    $cero_y = 2;



    $CI->fpdf->AddPage();



    $CI->fpdf->SetDrawColor(130,100);
    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_MEDIUM']);
        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 12 ), $agency->agency_name); // agency name

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL3']);
        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 22 ),"Licensed and Certified Home Health Agency");


        $CI->fpdf->Rect(8,28, 577, 802);



        $CI->fpdf->SetFont('Arial', 'B', $__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 190),( $cero_y + 36 ),"SKILLED NURSE - PROGRESS NOTE                            " .

                                                            "VISIT DATE: " . standard_date(mysql_to_unix($visit_log->visit_date_time))); // visit date

        $CI->fpdf->Line(( $cero_x - 3 ) , ($cero_y + 40.5 ), ( $cero_x + 574 ), ($cero_y + 40.5 ));



        $cero_y = 20;

        $CI->fpdf->SetTextColor(0,0,0);
        $CI->fpdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 32 ),"Patient Name: ");



        $CI->fpdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 60),( $cero_y + 32 ), $patient->first_name . " " . $patient->last_name); // pacient name



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->SetTextColor(0,0,0);



        $CI->fpdf->SetDrawColor(130,100);
        if (!empty($insurance)) {
            $CI->fpdf->Text(( $cero_x + 240),( $cero_y + 32 ), substr($insurance->tab_description, 0, 10)." #: ");
            $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
            $CI->fpdf->Text(( $cero_x + 290),( $cero_y + 32 ), $insurance->ins_id); // medicare id
        }else {
            $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
            $CI->fpdf->Text(( $cero_x + 390),( $cero_y + 32 ), "  NA ");
            $CI->fpdf->Rect(( $cero_x + 380),($cero_y + 23.5), 8.4, 8.4);
            $CI->fpdf->Image( $path_ticket, ( $cero_x + 381 ),($cero_y + 24.5),6);
        }

        /*$CI->fpdf->Text(( $cero_x + 240),( $cero_y + 32 ),"Medicare #: ");
        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 290),( $cero_y + 32 ), $patient->medicare_id); // medicare id*/

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 395 +20),( $cero_y + 32 ),"Medical Rec#: ");

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 455 +20),( $cero_y + 32 ), $patient->medical_rec_nbr); // medicare id


        /*$CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 390),( $cero_y + 32 ), "  NA ");
        $CI->fpdf->Rect(( $cero_x + 380),($cero_y + 23.5), 8.4, 8.4);
        if (is_null($patient->medicare_id)){
            $CI->fpdf->Image( $path_ticket, ( $cero_x + 381 ),($cero_y + 24.5),6);
        }*/

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 375),( $cero_y + 42 ),"  SOC: ");
        $CI->fpdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 415),( $cero_y + 42 ), standard_date(mysql_to_unix($visit_log->estimated_soc_date))); // soc date



        // primary and second icd
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 42 ),"Primary Dx: ");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 60),( $cero_y + 42 ), @$episde_icd[0]->icd9_name);



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 240),( $cero_y + 42 ),"Date: ");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 288),( $cero_y + 42 ), (!is_null(@$episde_icd[0]->icd_date) ? standard_date(mysql_to_unix(@$episde_icd[0]->icd_date)) : ""));



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 52 ),"Second Dx: ");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 60),( $cero_y + 52 ), @$episde_icd[1]->icd9_name);



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 240),( $cero_y + 52 ),"Date: ");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 288),( $cero_y + 52 ), (!is_null(@$episde_icd[1]->icd_date) ? standard_date(mysql_to_unix(@$episde_icd[1]->icd_date)) : ""));





        // start and end soc date

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 380),( $cero_y + 52 ),"From: ");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 415),( $cero_y + 52 ), standard_date(mysql_to_unix($visit_log->episode_start_date)));





        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 473),( $cero_y + 52 ),"To: ");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);
        $CI->fpdf->Text(( $cero_x + 518),( $cero_y + 52 ), standard_date(mysql_to_unix($visit_log->episode_end_date)));





        if ($visit_log->episode_start_date == $visit_log->estimated_soc_date)     {

            $CI->fpdf->Text(( $cero_x + 480),( $cero_y + 42 ),"   Certification");

        } else {

            $CI->fpdf->Text(( $cero_x + 495),( $cero_y + 42 ),"   Recertif.");

        }



        $CI->fpdf->Rect(( $cero_x + 473),($cero_y + 33.5), 8.4, 8.4);

        $CI->fpdf->Image( $path_ticket,( $cero_x + 474 ),($cero_y + 34.5),6);





        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 62 ),"Physician: ");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_arial8']);

        $CI->fpdf->Text(( $cero_x + 60),($cero_y + 62 ), @$phys_user_id->complete_name);



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 240),( $cero_y + 62 ), "Clinician:");



        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_arial8']);

        $CI->fpdf->Text(( $cero_x + 288),(  $cero_y + 62 ), $visit_log->first_name . " " .  $visit_log->last_name);



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 380),( $cero_y + 62 ), "Time In: ");

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 416),( $cero_y + 62 ), standard_date(mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_in), 'USA_TIME_C'));



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 473),( $cero_y + 62 ), "Time Out: ");

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);

        $CI->fpdf->Text(( $cero_x + 518),( $cero_y + 62 ), standard_date(mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_out), 'USA_TIME_C'));

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);





        $cero_y =$cero_y+5;

        $CI->fpdf->SetLineWidth( 0.5 );

        $CI->fpdf->Line(8, 85, 584, 85);





        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Text(11, 95, "Pain Assessment");



        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



        $CI->fpdf->Rect(128, 87, 8.4, 8.4);

        $CI->fpdf->Text(140, 95, "No pain");

        if (@$snpn->PaNPain == 1) {

            $CI->fpdf->Image( $path_ticket, 129, 88,6);

        }



        $CI->fpdf->Text(225, 95, "Intensity:");



        $item=280;

        foreach ($tab_30 as $pain_id => $pain) {



           $CI->fpdf->Text($item, 95, $pain);

           $pdf->Rect(($item - 11), 87, 8.4, 8.4);



           if ($pain_id == @@$snpn->tab_30_intensity) {

               $pdf->Image($path_ticket, ($item - 10), 88, 6);

           }



           $item=$item+25;



       }



       $CI->fpdf->Text(11, 105, "Location:");



       $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

       $CI->fpdf->Text(50, 105, @$snpn->PaLocation);





       $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

       $CI->fpdf->Text(11, 115, "Duration:");



       $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

       $CI->fpdf->Text(50, 115, @$snpn->PaDuration);



       $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

       $CI->fpdf->Text(11, 125, "Current pain medication:");



       $CI->fpdf->SetXY(8, 129);

       $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

       $CI->fpdf->MultiCell(578, 10, substr(@$snpn->PaMedication, 0, 190));







       $CI->fpdf->Line(8, 155, 584, 155);



       $CI->fpdf->Line(395, 155, 395, 247);



       $CI->fpdf->Image( $path_img1, 420, 158, 150);



       $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



       $CI->fpdf->Text(11, 165, "Stage I: Non-blanchable erythema if intact skin; healing of skin ulceration");



       $CI->fpdf->Line(8, 168, 395, 168);



       $CI->fpdf->Text(11, 178, "Stage II: Partial thickness skin loss involving epidermis and/or dermis. The ulcer is superficial");

       $CI->fpdf->Text(11, 188, "and presents as an abrasion, blister or shallow crater.");





       $CI->fpdf->Line(8, 191, 395, 191);



       $CI->fpdf->Text(11, 201, "Stage III: Full-thickness skin loss involving damage or necrosis of subcutaneous tissue,");

       $CI->fpdf->Text(11, 211, "which may extend down to, but not through, underlying fascia. The ulcer presents as");

       $CI->fpdf->Text(11, 221, "a deep crater w/ or w/o undermining adjacent tissue.");





       $CI->fpdf->Line(8, 224, 395, 224);



       $CI->fpdf->Text(11, 234, "Stage IV: Full-thickness skin loss with extensive destruction, tissue necrosis, or damage to");

       $CI->fpdf->Text(11, 244, "muscle, bone or supporting structures (e.g., tendon, joint capsule, etc)");





       $CI->fpdf->Line(8, 247, 584, 247);





       $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

       $CI->fpdf->Text(11, 257, "WOUND SITE 1: ");



       $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

       $CI->fpdf->Text(85, 257, @$snpn->WS1Site1);



       $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

       $CI->fpdf->Text(11, 267, "Length:");

       $CI->fpdf->Text(210, 267, "Width:");



       $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

       $CI->fpdf->Text(70, 267, @$snpn->WS1Length);

       $CI->fpdf->Text(240, 267, @$snpn->WS1Width);



       $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

       $CI->fpdf->Text(11, 277, "Undermining:");

       $CI->fpdf->Text(210, 277, "Depth:");

       $CI->fpdf->Text(400, 277, "Tunneling:");



       $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

       $CI->fpdf->Text(70, 277, @$snpn->WS1Under);

       $CI->fpdf->Text(240, 277, @$snpn->WS1Depth);

       $CI->fpdf->Text(445, 277, @$snpn->WS1Tunnel);





       $CI->fpdf->Line(8, 280, 584, 280);



       $CI->fpdf->Line(304, 280, 304, 349);





       $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

       $CI->fpdf->Text(11, 289, "Drainage");

       $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



       $CI->fpdf->Rect(11, 292, 8.4, 8.4);

       $CI->fpdf->Text(23, 300, "Serous");

       if (@$snpn->WS1DrainSerous == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 293,6);

    }



    $CI->fpdf->Rect(85, 292, 8.4, 8.4);

    $CI->fpdf->Text(97, 300, "Serosang");

    if (@$snpn->WS1DrainSerosang == 1) {

        $CI->fpdf->Image( $path_ticket, 86, 293,6);

    }



    $CI->fpdf->Rect(160, 292, 8.4, 8.4);

    $CI->fpdf->Text(172, 300, "Purulent");

    if (@$snpn->WS1DrainPurulent == 1) {

        $CI->fpdf->Image( $path_ticket, 161, 293,6);

    }





    $CI->fpdf->Line(8, 303, 584, 303);



    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 312, "Wound Bed Appearance");

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(11, 315, 8.4, 8.4);

    $CI->fpdf->Text(23, 323, "Granulation");

    if (@$snpn->WS1WoBeApGranul == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 316,6);

    }



    $CI->fpdf->Rect(85, 315, 8.4, 8.4);

    $CI->fpdf->Text(97, 323, "Slough");

    if (@$snpn->WS1WoBeApSlough == 1) {

        $CI->fpdf->Image( $path_ticket, 86, 316, 6);

    }



    $CI->fpdf->Rect(160, 315, 8.4, 8.4);

    $CI->fpdf->Text(172, 323, "Eschar");

    if (@$snpn->WS1WoBeApEschar == 1) {

        $CI->fpdf->Image( $path_ticket, 161, 316,6);

    }



    $CI->fpdf->Rect(230, 315, 8.4, 8.4);

    $CI->fpdf->Text(242, 323, "Fibrotic");

    if (@$snpn->WS1WoBeApFibrotic == 1) {

        $CI->fpdf->Image( $path_ticket, 231, 316,6);

    }





    $CI->fpdf->Line(8, 326, 584, 326);



    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 335, "Surrounding Tissue");

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(11, 338, 8.4, 8.4);

    $CI->fpdf->Text(23, 346, "Erythema");

    if (@$snpn->WS1SuTiErythema == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 339,6);

    }



    $CI->fpdf->Rect(85, 338, 8.4, 8.4);

    $CI->fpdf->Text(97, 346, "Maceration");

    if (@$snpn->WS1SuTiMaceration == 1) {

        $CI->fpdf->Image( $path_ticket, 86, 339, 6);

    }



    $CI->fpdf->Line(8, 349, 584, 349);



    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 358, "Signs/Symptoms of Infection");

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(11, 361, 8.4, 8.4);

    $CI->fpdf->Text(23, 369, "Fever");

    if (@$snpn->WS1SignInfectFever == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 362,6);

    }



    $CI->fpdf->Rect(85, 361, 8.4, 8.4);

    $CI->fpdf->Text(97, 369, "Redness");

    if (@$snpn->WS1SignInfectRedness == 1) {

        $CI->fpdf->Image( $path_ticket, 86, 362, 6);

    }



    $CI->fpdf->Rect(160, 361, 8.4, 8.4);

    $CI->fpdf->Text(172, 369, "Swelling");

    if (@$snpn->WS1SignInfectSwelling == 1) {

        $CI->fpdf->Image( $path_ticket, 161, 362,6);

    }



    $CI->fpdf->Rect(230, 361, 8.4, 8.4);

    $CI->fpdf->Text(242, 369, "Warmth");

    if (@$snpn->WS1SignInfectWarmth == 1) {

        $CI->fpdf->Image( $path_ticket, 231, 362,6);

    }



    $CI->fpdf->Rect(300, 361, 8.4, 8.4);

    $CI->fpdf->Text(312, 369, "Other");

    if (@$snpn->WS1SignInfectOther == 1) {

        $CI->fpdf->Image( $path_ticket, 301, 362,6);

    }



    $CI->fpdf->Rect(370, 361, 8.4, 8.4);

    $CI->fpdf->Text(382, 369, "N/A");

    if (@$snpn->WS1SignInfectNA == 1) {

        $CI->fpdf->Image( $path_ticket, 371, 362,6);

    }





    $CI->fpdf->Line(8, 372, 584, 372);



    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(312, 289, "Amount");

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(312, 292, 8.4, 8.4);

    $CI->fpdf->Text(324, 300, "Small");

    if (@$snpn->WS1AmtSmall == 1) {

        $CI->fpdf->Image( $path_ticket, 313, 293,6);

    }



    $CI->fpdf->Rect(385, 292, 8.4, 8.4);

    $CI->fpdf->Text(397, 300, "Moderate");

    if (@$snpn->WS1AmtMod == 1) {

        $CI->fpdf->Image( $path_ticket, 386, 293,6);

    }



    $CI->fpdf->Rect(460, 292, 8.4, 8.4);

    $CI->fpdf->Text(472, 300, "Large");

    if (@$snpn->WS1AmtLarge == 1) {

        $CI->fpdf->Image( $path_ticket, 461, 293,6);

    }



    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(312, 312, "Odor");

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(312, 315, 8.4, 8.4);

    $CI->fpdf->Text(324, 323, "None");

    if (@$snpn->WS1OdorNone == 1) {

        $CI->fpdf->Image( $path_ticket, 313, 316,6);

    }



    $CI->fpdf->Rect(385, 315, 8.4, 8.4);

    $CI->fpdf->Text(397, 323, "Mild");

    if (@$snpn->WS1OdorMild == 1) {

        $CI->fpdf->Image( $path_ticket, 386, 316,6);

    }



    $CI->fpdf->Rect(460, 315, 8.4, 8.4);

    $CI->fpdf->Text(472, 323, "Foul");

    if (@$snpn->WS1OdorFoul == 1) {

        $CI->fpdf->Image( $path_ticket, 461, 316,6);

    }



    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 381, "Treatment");

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Text(11, 391, "1) Cleanse with");

    $CI->fpdf->Text(11, 401, "2) Pat Dry with");

    $CI->fpdf->Text(11, 411, "3) Apply");

    $CI->fpdf->Text(11, 421, "4) Cover with");

    $CI->fpdf->Text(11, 431, "5) Secure with");

    $CI->fpdf->Text(11, 441, "Comments");



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(80, 391, @$snpn->WS1TreatCleanse);

    $CI->fpdf->Text(80, 401, @$snpn->WS1TreatPatDry);

    $CI->fpdf->Text(80, 411, @$snpn->WS1TreatApply);

    $CI->fpdf->Text(80, 421, @$snpn->WS1TreatCover);

    $CI->fpdf->Text(80, 431, @$snpn->WS1TreatSecure);



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);



    $CI->fpdf->Line(8, 392, 584, 392);

    $CI->fpdf->Line(8, 402, 584, 402);

    $CI->fpdf->Line(8, 412, 584, 412);

    $CI->fpdf->Line(8, 422, 584, 422);

    $CI->fpdf->Line(8, 432, 584, 432);

    $CI->fpdf->Line(77, 442, 580, 442);



    $CI->fpdf->SetXY(77, 433);

    $CI->fpdf->MultiCell(498, 10, substr(@$snpn->WS1TreatComments, 0, 162));





    $CI->fpdf->Line(8, 456, 584, 456);





    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 466, "WOUND SITE 2:");



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(85, 466, @$snpn->WS2Site2);



    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 476, "Length:");

    $CI->fpdf->Text(210, 476, "Width:");



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(70, 476, @$snpn->WS2Length);

    $CI->fpdf->Text(240, 476, @$snpn->WS2Width);



    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 486, "Undermining:");

    $CI->fpdf->Text(210, 486, "Depth:");

    $CI->fpdf->Text(400, 486, "Tunneling:");



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(70, 486, @$snpn->WS2Under);

    $CI->fpdf->Text(240, 486, @$snpn->WS2Depth);

    $CI->fpdf->Text(445, 486, @$snpn->WS2Tunnel);





    $CI->fpdf->Line(8, 489, 584, 489);



    $CI->fpdf->Line(304, 489, 304, 558);





    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 498, "Drainage");

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(11, 501, 8.4, 8.4);

    $CI->fpdf->Text(23, 509, "Serous");

    if (@$snpn->WS2DrainSerous == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 502,6);

    }



    $CI->fpdf->Rect(85, 501, 8.4, 8.4);

    $CI->fpdf->Text(97, 509, "Serosang");

    if (@$snpn->WS2DrainSerosang == 1) {

        $CI->fpdf->Image( $path_ticket, 86, 502,6);

    }



    $CI->fpdf->Rect(160, 501, 8.4, 8.4);

    $CI->fpdf->Text(172, 509, "Purulent");

    if (@$snpn->WS2DrainPurulent == 1) {

        $CI->fpdf->Image( $path_ticket, 161, 502,6);

    }





    $CI->fpdf->Line(8, 512, 584, 512);



    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 521, "Wound Bed Appearance");

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(11, 524, 8.4, 8.4);

    $CI->fpdf->Text(23, 532, "Granulation");

    if (@$snpn->WS2WoBeApGranul == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 525,6);

    }



    $CI->fpdf->Rect(85, 524, 8.4, 8.4);

    $CI->fpdf->Text(97, 532, "Slough");

    if (@$snpn->WS2WoBeApSlough == 1) {

        $CI->fpdf->Image( $path_ticket, 86, 525, 6);

    }



    $CI->fpdf->Rect(160, 524, 8.4, 8.4);

    $CI->fpdf->Text(172, 532, "Eschar");

    if (@$snpn->WS2WoBeApEschar == 1) {

        $CI->fpdf->Image( $path_ticket, 161, 525,6);

    }



    $CI->fpdf->Rect(230, 524, 8.4, 8.4);

    $CI->fpdf->Text(242, 532, "Fibrotic");

    if (@$snpn->WS2WoBeApFibrotic == 1) {

        $CI->fpdf->Image( $path_ticket, 231, 525,6);

    }





    $CI->fpdf->Line(8, 535, 584, 535);



    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
    $CI->fpdf->Text(11, 544, "Surrounding Tissue");
    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);
    $CI->fpdf->Rect(11, 547, 8.4, 8.4);
    $CI->fpdf->Text(23, 555, "Erythema");
    if (@$snpn->WS2SuTiErythema == 1) {
        $CI->fpdf->Image( $path_ticket, 12, 548,6);
    }
    $CI->fpdf->Rect(85, 547, 8.4, 8.4);
    $CI->fpdf->Text(97, 555, "Maceration");
    if (@$snpn->WS2SuTiMaceration == 1) {
        $CI->fpdf->Image( $path_ticket, 86, 548, 6);
    }
    $CI->fpdf->Line(8, 558, 584, 558);



    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
    $CI->fpdf->Text(11, 567, "Signs/Symptoms of Infection");
    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(11, 570, 8.4, 8.4);

    $CI->fpdf->Text(23, 578, "Fever");

    if (@$snpn->WS2SignInfectFever == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 571,6);

    }



    $CI->fpdf->Rect(85, 570, 8.4, 8.4);

    $CI->fpdf->Text(97, 578, "Redness");

    if (@$snpn->WS2SignInfectRedness == 1) {

        $CI->fpdf->Image( $path_ticket, 86, 571, 6);

    }



    $CI->fpdf->Rect(160, 570, 8.4, 8.4);

    $CI->fpdf->Text(172, 578, "Swelling");

    if (@$snpn->WS2SignInfectSwelling == 1) {

        $CI->fpdf->Image( $path_ticket, 161, 571,6);

    }



    $CI->fpdf->Rect(230, 570, 8.4, 8.4);

    $CI->fpdf->Text(242, 578, "Warmth");

    if (@$snpn->WS2SignInfectWarmth == 1) {

        $CI->fpdf->Image( $path_ticket, 231, 571,6);

    }



    $CI->fpdf->Rect(300, 570, 8.4, 8.4);

    $CI->fpdf->Text(312, 578, "Other");

    if (@$snpn->WS2SignInfectOther == 1) {

        $CI->fpdf->Image( $path_ticket, 301, 571,6);

    }



    $CI->fpdf->Rect(370, 570, 8.4, 8.4);

    $CI->fpdf->Text(382, 578, "N/A");

    if (@$snpn->WS2SignInfectNA == 1) {

        $CI->fpdf->Image( $path_ticket, 371, 571,6);

    }





    $CI->fpdf->Line(8, 581, 584, 581);



    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(312, 498, "Amount");

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(312, 501, 8.4, 8.4);

    $CI->fpdf->Text(324, 509, "Small");

    if (@$snpn->WS2AmtSmall == 1) {

        $CI->fpdf->Image( $path_ticket, 313, 502,6);

    }



    $CI->fpdf->Rect(385, 501, 8.4, 8.4);

    $CI->fpdf->Text(397, 509, "Moderate");

    if (@$snpn->WS2AmtMod == 1) {

        $CI->fpdf->Image( $path_ticket, 386, 502,6);

    }



    $CI->fpdf->Rect(460, 501, 8.4, 8.4);

    $CI->fpdf->Text(472, 509, "Large");

    if (@$snpn->WS2AmtLarge == 1) {

        $CI->fpdf->Image( $path_ticket, 461, 502,6);

    }



    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(312, 521, "Odor");

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(312, 524, 8.4, 8.4);

    $CI->fpdf->Text(324, 532, "None");

    if (@$snpn->WS2OdorNone == 1) {

        $CI->fpdf->Image( $path_ticket, 313, 525,6);

    }



    $CI->fpdf->Rect(385, 524, 8.4, 8.4);

    $CI->fpdf->Text(397, 532, "Mild");

    if (@$snpn->WS2OdorMild == 1) {

        $CI->fpdf->Image( $path_ticket, 386, 525,6);

    }



    $CI->fpdf->Rect(460, 524, 8.4, 8.4);

    $CI->fpdf->Text(472, 532, "Foul");

    if (@$snpn->WS2OdorFoul == 1) {

        $CI->fpdf->Image( $path_ticket, 461, 525,6);

    }



    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 590, "Treatment");

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Text(11, 600, "1) Cleanse with");

    $CI->fpdf->Text(11, 610, "2) Pat Dry with");

    $CI->fpdf->Text(11, 620, "3) Apply");

    $CI->fpdf->Text(11, 630, "4) Cover with");

    $CI->fpdf->Text(11, 640, "5) Secure with");

    $CI->fpdf->Text(11, 650, "Comments");



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(80, 600, @$snpn->WS2TreatCleanse);

    $CI->fpdf->Text(80, 610, @$snpn->WS2TreatPatDry);

    $CI->fpdf->Text(80, 620, @$snpn->WS2TreatApply);

    $CI->fpdf->Text(80, 630, @$snpn->WS2TreatCover);

    $CI->fpdf->Text(80, 640, @$snpn->WS2TreatSecure);



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->SetXY(77, 642);

    $CI->fpdf->MultiCell(498, 10, substr(@$snpn->WS2TreatComments, 0, 162));



    $CI->fpdf->Line(8, 601, 584, 601);

    $CI->fpdf->Line(8, 611, 584, 611);

    $CI->fpdf->Line(8, 621, 584, 621);

    $CI->fpdf->Line(8, 632, 584, 632);

    $CI->fpdf->Line(8, 642, 584, 642);

    $CI->fpdf->Line(77, 652, 580, 652);

    $CI->fpdf->Line(8, 665, 584, 665);





    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 675, "Universal Precautions followed:");

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(149, 667, 8.4, 8.4);

    $CI->fpdf->Text(160, 675, "Handwashing");

    if (@$snpn->UPFollowHandwash == 1) {

        $CI->fpdf->Image( $path_ticket, 150, 668,6);

    }



    $CI->fpdf->Rect(219, 667, 8.4, 8.4);

    $CI->fpdf->Text(231, 675, "Gloves Worn");

    if (@$snpn->UPFollowGloveWorn == 1) {

        $CI->fpdf->Image( $path_ticket, 220, 668,6);

    }



    $CI->fpdf->Rect(287, 667, 8.4, 8.4);

    $CI->fpdf->Text(299, 675, "Sharps Disposal");

    if (@$snpn->UPFollowGloveWorn == 1) {

        $CI->fpdf->Image( $path_ticket, 288, 668,6);

    }



    $CI->fpdf->Rect(370, 667, 8.4, 8.4);

    $CI->fpdf->Text(381, 675, "Other:");

    if (@$snpn->UPFollowOther != '') {

        $CI->fpdf->Image( $path_ticket, 371, 668,6);

    }



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(405, 675, @$snpn->UPFollowOther);





    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 685, "Homebound Status:");

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(100, 685, @$snpn->HoBoStatusText);



    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Rect(11, 687, 8.4, 8.4);

    $CI->fpdf->Text(23, 695, "Taxing effort to leave home");

    if (@$snpn->HoBoTaxing == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 688,6);

    }



    $CI->fpdf->Rect(140, 687, 8.4, 8.4);

    $CI->fpdf->Text(152, 695, "Need assistance poor endurance");

    if (@$snpn->HoBoNeedAssist == 1) {

        $CI->fpdf->Image( $path_ticket, 141, 688,6);

    }



    $CI->fpdf->Rect(290, 687, 8.4, 8.4);

    $CI->fpdf->Text(302, 695, "Open/draining wound");

    if (@$snpn->HoBoNeedAssist == 1) {

        $CI->fpdf->Image( $path_ticket, 291, 688,6);

    }



    $CI->fpdf->Rect(395, 687, 8.4, 8.4);

    $CI->fpdf->Text(407, 695, "Other:");

    if (@$snpn->HoBoOther != '') {

        $CI->fpdf->Image( $path_ticket, 396, 688,6);

    }





    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(435, 695, @$snpn->HoBoOther);





    $CI->fpdf->Line(8, 698, 584, 698);



    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 708, "Coordination of Care:");



    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Rect(105, 700, 8.4, 8.4);

    $CI->fpdf->Text(117, 708, "PT");

    if (@$snpn->CoorCarePT == 1) {

        $CI->fpdf->Image( $path_ticket, 106, 701,6);

    }



    $CI->fpdf->Rect(135, 700, 8.4, 8.4);

    $CI->fpdf->Text(147, 708, "CG");

    if (@$snpn->CoorCareCG == 1) {

        $CI->fpdf->Image( $path_ticket, 136, 701,6);

    }



    $CI->fpdf->Rect(165, 700, 8.4, 8.4);

    $CI->fpdf->Text(177, 708, "RN");

    if (@$snpn->CoorCareRN == 1) {

        $CI->fpdf->Image( $path_ticket, 166, 701,6);

    }



    $CI->fpdf->Rect(195, 700, 8.4, 8.4);

    $CI->fpdf->Text(207, 708, "LVN");

    if (@$snpn->CoorCareLVN == 1) {

        $CI->fpdf->Image( $path_ticket, 196, 701,6);

    }



    $CI->fpdf->Rect(230, 700, 8.4, 8.4);

    $CI->fpdf->Text(242, 708, "HHA");

    if (@$snpn->CoorCareHHA == 1) {

        $CI->fpdf->Image( $path_ticket, 231, 701,6);

    }



    $CI->fpdf->Rect(265, 700, 8.4, 8.4);

    $CI->fpdf->Text(277, 708, "OT");

    if (@$snpn->CoorCareOT == 1) {

        $CI->fpdf->Image( $path_ticket, 266, 701,6);

    }



    $CI->fpdf->Rect(295, 700, 8.4, 8.4);

    $CI->fpdf->Text(307, 708, "ST");

    if (@$snpn->CoorCareST == 1) {

        $CI->fpdf->Image( $path_ticket, 296, 701,6);

    }



    $CI->fpdf->Rect(325, 700, 8.4, 8.4);

    $CI->fpdf->Text(337, 708, "MSW");

    if (@$snpn->CoorCareMSW == 1) {

        $CI->fpdf->Image( $path_ticket, 326, 701,6);

    }



    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(363, 708, "Discussion:");



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(405, 708, @$snpn->CoorCareDiscuss);





    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 718, "Physician contact:");

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(105, 710, 8.4, 8.4);

    $CI->fpdf->Text(117, 718, "N/A");

    if (@$snpn->PhyContactNA == 1) {

        $CI->fpdf->Image( $path_ticket, 106, 711,6);

    }



    $CI->fpdf->Rect(165, 710, 8.4, 8.4);

    $CI->fpdf->Text(177, 718, "Yes");

    if (@$snpn->PhyContactYes == 1) {

        $CI->fpdf->Image( $path_ticket, 166, 711,6);

    }



    $CI->fpdf->Text(205, 718, "Discussion:");



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(255, 718, @$snpn->PhyContactDiscuss);





    $CI->fpdf->Line(8, 721, 584, 721);





    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 731, "Discharge Planning");

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);



    $CI->fpdf->Rect(11, 733, 8.4, 8.4);

    $CI->fpdf->Text(23, 741, "Discharge when goals are met and skilled intervention is no longer needed");

    if (@$snpn->DisWhenGoals == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 734,6);

    }



    $CI->fpdf->Rect(350, 733, 8.4, 8.4);

    $CI->fpdf->Text(362, 741, "5-day discharge notice given to patient/physician");

    if (@$snpn->FiveDayNotice == 1) {

        $CI->fpdf->Image( $path_ticket, 351, 734,6);

    }



    $CI->fpdf->Line(8, 744, 584, 744);



    $CI->fpdf->Line(332, 744, 332, 810);





    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(11, 754, "LVN/HHA Supervision");



    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Rect(11, 756, 8.4, 8.4);

    $CI->fpdf->Text(21, 764, "Patient/Caregiver satisfied with care");

    if (@$snpn->LVNSupPatSatisfied == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 757,6);

    }



    $CI->fpdf->Rect(182, 756, 8.4, 8.4);

    $CI->fpdf->Text(192, 764, "Change in ADL needs assessment");

    if (@$snpn->LVNSupChangeADL == 1) {

        $CI->fpdf->Image( $path_ticket, 183, 757,6);

    }





    $CI->fpdf->Rect(11, 766, 8.4, 8.4);

    $CI->fpdf->Text(21, 774, "Care provided according to assignment");

    if (@$snpn->LVNSupCareProvAccor == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 767,6);

    }



    $CI->fpdf->Rect(182, 766, 8.4, 8.4);

    $CI->fpdf->Text(192, 774, "Employee courteous, respectful");

    if (@$snpn->LVNSupEmplCorteous == 1) {

        $CI->fpdf->Image( $path_ticket, 183, 767,6);

    }





    $CI->fpdf->Rect(11, 776, 8.4, 8.4);

    $CI->fpdf->Text(21, 784, "Continue frequency at ____________");

    if (@$snpn->LVNSupContinueFreqAt == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 777,6);

    }

    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(112, 784, @$snpn->LVNSupContinueFreqAtText);



    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Rect(182, 776, 8.4, 8.4);

    $CI->fpdf->Text(192, 784, "Supervisory Visit Onsite");

    if (@$snpn->LVNSupVisitOnsite == 1) {

        $CI->fpdf->Image( $path_ticket, 183, 777,6);

    }





    $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Text(335, 754, "Documentation of patient inability to perform wound care");





    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

    $CI->fpdf->Rect(335, 756, 8.4, 8.4);

    $CI->fpdf->Text(345, 764, "Patient's impaired functional ability to do wound care due to");

    if (@$snpn->DocPatInab == 1) {

        $CI->fpdf->Image( $path_ticket, 336, 757,6);

    }





    $CI->fpdf->Rect(335, 766, 8.4, 8.4);

    $CI->fpdf->Text(345, 774, "poor vision");

    if (@$snpn->DocPatInabPoorVsion == 1) {

        $CI->fpdf->Image( $path_ticket, 336, 767,6);

    }



    $CI->fpdf->Rect(395, 766, 8.4, 8.4);

    $CI->fpdf->Text(405, 774, "hand dexterity");

    if (@$snpn->DocPatInabPoorHandDex == 1) {

        $CI->fpdf->Image( $path_ticket, 396, 767,6);

    }



    $CI->fpdf->Rect(467, 766, 8.4, 8.4);

    $CI->fpdf->Text(477, 774, "position of wound");

    if (@$snpn->DocPatInabPosWound == 1) {

        $CI->fpdf->Image( $path_ticket, 468, 767,6);

    }





    $CI->fpdf->Rect(335, 776, 8.4, 8.4);

    $CI->fpdf->Text(345, 784, "The patient has impaired mental cognition");

    if (@$snpn->DocPatInabImpMentalCogn == 1) {

        $CI->fpdf->Image( $path_ticket, 336, 777,6);

    }





    $CI->fpdf->Rect(335, 786, 8.4, 8.4);

    $CI->fpdf->Text(345, 794, "There's no able and willing caregiver to perform wound care");

    if (@$snpn->DocPatInabNoCaregiverPerf == 1) {

        $CI->fpdf->Image( $path_ticket, 336, 787,6);

    }





    $CI->fpdf->Text(11, 797, "Employee Name:");

    $CI->fpdf->Text(85, 797, @$emp_name->complete_name);





    $CI->fpdf->Rect(11, 799, 8.4, 8.4);

    $CI->fpdf->Text(21, 807, "LVN");

    if (@$snpn->LVNLVN == 1) {

        $CI->fpdf->Image( $path_ticket, 12, 800,6);

    }



    $CI->fpdf->Rect(45, 799, 8.4, 8.4);

    $CI->fpdf->Text(55, 807, "HHA");

    if (@$snpn->LVNHHA == 1) {

        $CI->fpdf->Image( $path_ticket, 46, 800,6);

    }





    $CI->fpdf->Text(85, 807, "Instructed in:");



    $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

    $CI->fpdf->Text(140, 807, @$snpn->LVNInstruc);





    $CI->fpdf->Line(8, 810, 584, 810);





    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);





    $CI->fpdf->Text(50, 817, "Nurse Signature: ________________________________________ ");
    $CI->fpdf->Text(370, 817, "Date:__________________");


    if ($visit_log->approve_date)
    {
     $CI->fpdf->Text( 50 , 827, "Electronically signed by:__________________________________________________ Date_____________________________");
     $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
     $CI->fpdf->Text(150,826, $visit_log -> first_name." ".$visit_log -> last_name);
     $CI->fpdf->Text(423,826, standard_date(mysql_to_unix($visit_log->approve_date)));
 }


 if (strlen(@$snwa->WS3Site3)>0)
 {
     $cero_x = 11;

     $cero_y = 2;

            ####### PAGE 3 ###########
     $CI->fpdf->AddPage();



     $CI->fpdf->SetDrawColor(130,100);

            //$CI->fpdf->Text(( $cero_x + 240),( $cero_y + 22 ),"WOUND ADDENDUM");


     $CI->fpdf->Rect(8,28, 577, 763);

     $cero_y = 8;

     $CI->fpdf->SetTextColor(0,0,0);

     $CI->fpdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);

     $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 32 ),"Patient Name: ");



     $CI->fpdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);

            $CI->fpdf->Text(( $cero_x + 60),( $cero_y + 32 ), $patient->first_name . " " . $patient->last_name); // pacient name



            $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

            $CI->fpdf->SetTextColor(0,0,0);



            $CI->fpdf->SetDrawColor(130,100);

            $CI->fpdf->Text(( $cero_x + 230),( $cero_y + 32 ),"Medical Rec#: ");



            $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);

            $CI->fpdf->Text(( $cero_x + 290),( $cero_y + 32 ),  $patient->medical_rec_nbr); // medicare id



            $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

           $CI->fpdf->Text(( $cero_x + 395 +20),( $cero_y + 32 ), "VISIT DATE: " . standard_date(mysql_to_unix($visit_log->visited_date)));

           $CI->fpdf->Line(8, 45, 584, 45);






            ####################################
           $a=-202;

           $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
           $CI->fpdf->Text(11, 257+$a, "WOUND SITE 3: ");

           $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
           $CI->fpdf->Text(85, 257+$a, @$snwa->WS3Site3);

           $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);
           $CI->fpdf->Text(11, 267+$a, "Length:");
           $CI->fpdf->Text(210, 267+$a, "Width:");

           $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
           $CI->fpdf->Text(70, 267+$a, @$snwa->WS3Length);
           $CI->fpdf->Text(240, 267+$a, @$snwa->WS3Width);

           $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);
           $CI->fpdf->Text(11, 277+$a, "Undermining:");
           $CI->fpdf->Text(210, 277+$a, "Depth:");
           $CI->fpdf->Text(400, 277+$a, "Tunneling:");

           $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
           $CI->fpdf->Text(70, 277+$a, @$snwa->WS3Under);
           $CI->fpdf->Text(240, 277+$a, @$snwa->WS3Depth);
           $CI->fpdf->Text(445, 277+$a, @$snwa->WS3Tunnel);


           $CI->fpdf->Line(8, 280+$a, 584, 280+$a);
    //
           $CI->fpdf->Line(304, 280+$a, 304, 326+$a);
    //

           $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
           $CI->fpdf->Text(11, 289+$a, "Drainage");
           $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

           $CI->fpdf->Rect(11, 292+$a, 8.4, 8.4);
           $CI->fpdf->Text(23, 300+$a, "Serous");
           if (@$snwa->WS3DrainSerous == 1) {
            $CI->fpdf->Image( $path_ticket, 12, 293+$a,6);
        }
        $CI->fpdf->Rect(85, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(97, 300+$a, "Serosang");
        if (@$snwa->WS3DrainSerosang == 1) {
            $CI->fpdf->Image( $path_ticket, 86, 293+$a,6);
        }


        $CI->fpdf->Rect(160, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(172, 300+$a, "Purulent");
        if (@$snwa->WS3DrainPurulent == 1) {
            $CI->fpdf->Image( $path_ticket, 161, 293+$a,6);
        }

           /////////////////////////////////////


        $CI->fpdf->Line(8, 303+$a, 584, 303+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 312+$a, "Wound Bed Appearance");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(11, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(23, 323+$a, "Granulation");
        if (@$snwa->WS3WoBeApGranul == 1) {
            $CI->fpdf->Image( $path_ticket, 12, 316+$a,6);
        }

        $CI->fpdf->Rect(85, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(97, 323+$a, "Slough");
        if (@$snwa->WS3WoBeApSlough == 1) {
            $CI->fpdf->Image( $path_ticket, 86, 316+$a, 6);
        }

        $CI->fpdf->Rect(160, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(172, 323+$a, "Eschar");
        if (@$snwa->WS3WoBeApEschar == 1) {
            $CI->fpdf->Image( $path_ticket, 161, 316+$a,6);
        }

        $CI->fpdf->Rect(230, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(242, 323+$a, "Fibrotic");
        if (@$snwa->WS3WoBeApFibrotic == 1) {
            $CI->fpdf->Image( $path_ticket, 231, 316+$a,6);
        }

     //
        $CI->fpdf->Line(145, 326+$a, 145, 349+$a);
    //
        $CI->fpdf->Line(8, 326+$a, 584, 326+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 335+$a, "Surrounding Tissue");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Rect(11, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(23, 346+$a, "Erythema");
        if (@$snwa->WS3SuTiErythema == 1) {
            $CI->fpdf->Image( $path_ticket, 12, 339+$a,6);
        }
        $CI->fpdf->Rect(85, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(97, 346+$a, "Maceration");
        if (@$snwa->WS3SuTiMaceration == 1) {
            $CI->fpdf->Image( $path_ticket, 86, 339+$a, 6);
        }

        $CI->fpdf->Line(8, 349+$a, 584, 349+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(148, 335+$a, "Signs/Symptoms of Infection");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(148, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(160, 346+$a, "Fever");
        if (@$snwa->WS3SignInfectFever == 1) {
            $CI->fpdf->Image( $path_ticket, 149, 339+$a,6);
        }

        $CI->fpdf->Rect(200, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(212, 346+$a, "Redness");
        if (@$snwa->WS3SignInfectRedness == 1) {
            $CI->fpdf->Image( $path_ticket, 201, 339+$a, 6);
        }

        $CI->fpdf->Rect(270, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(282, 346+$a, "Swelling");
        if (@$snwa->WS3SignInfectSwelling == 1) {
            $CI->fpdf->Image( $path_ticket, 271, 339+$a,6);
        }

        $CI->fpdf->Rect(340, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(352, 346+$a, "Warmth");
        if (@$snwa->WS3SignInfectWarmth == 1) {
            $CI->fpdf->Image( $path_ticket, 341, 339+$a,6);
        }

        $CI->fpdf->Rect(410, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(422, 346+$a, "Other");
        if (@$snwa->WS3SignInfectOther == 1) {
            $CI->fpdf->Image( $path_ticket, 411, 339+$a,6);
        }

        $CI->fpdf->Rect(480, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(492, 346+$a, "N/A");
        if (@$snwa->WS3SignInfectNA == 1) {
            $CI->fpdf->Image( $path_ticket, 481, 339+$a,6);
        }


            ////$CI->fpdf->Line(8, 372+$a, 584, 372+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(312, 289+$a, "Amount");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(312, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(324, 300+$a, "Small");
        if (@$snwa->WS3AmtSmall == 1) {
            $CI->fpdf->Image( $path_ticket, 313, 293+$a,6);
        }

        $CI->fpdf->Rect(385, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(397, 300+$a, "Moderate");
        if (@$snwa->WS3AmtMod == 1) {
            $CI->fpdf->Image( $path_ticket, 386, 293+$a,6);
        }

        $CI->fpdf->Rect(460, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(472, 300+$a, "Large");
        if (@$snwa->WS3AmtLarge == 1) {
            $CI->fpdf->Image( $path_ticket, 461, 293+$a,6);
        }

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(312, 312+$a, "Odor");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(312, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(324, 323+$a, "None");
        if (@$snwa->WS3OdorNone == 1) {
            $CI->fpdf->Image( $path_ticket, 313, 316+$a,6);
        }

        $CI->fpdf->Rect(385, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(397, 323+$a, "Mild");
        if (@$snwa->WS3OdorMild == 1) {
            $CI->fpdf->Image( $path_ticket, 386, 316+$a,6);
        }

        $CI->fpdf->Rect(460, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(472, 323+$a, "Foul");
        if (@$snwa->WS3OdorFoul == 1) {
            $CI->fpdf->Image( $path_ticket, 461, 316+$a,6);
        }
        $a=$a-22;
        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 381+$a, "Treatment");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Text(11, 391+$a, "1) Cleanse with");
        $CI->fpdf->Text(11, 401+$a, "2) Pat Dry with");
        $CI->fpdf->Text(11, 411+$a, "3) Apply");
        $CI->fpdf->Text(11, 421+$a, "4) Cover with");
        $CI->fpdf->Text(11, 431+$a, "5) Secure with");
        $CI->fpdf->Text(11, 441+$a, "Comments");

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
        $CI->fpdf->Text(80, 391+$a, @$snwa->WS3TreatCleanse);
        $CI->fpdf->Text(80, 401+$a, @$snwa->WS3TreatPatDry);
        $CI->fpdf->Text(80, 411+$a, @$snwa->WS3TreatApply);
        $CI->fpdf->Text(80, 421+$a, @$snwa->WS3TreatCover);
        $CI->fpdf->Text(80, 431+$a, @$snwa->WS3TreatSecure);

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

        $CI->fpdf->Line(8, 392+$a, 584, 392+$a);
        $CI->fpdf->Line(8, 402+$a, 584, 402+$a);
        $CI->fpdf->Line(8, 412+$a, 584, 412+$a);
        $CI->fpdf->Line(8, 422+$a, 584, 422+$a);
        $CI->fpdf->Line(8, 432+$a, 584, 432+$a);
        $CI->fpdf->Line(77, 442+$a, 580, 442+$a);

        $CI->fpdf->SetXY(77, 433+$a);
        $CI->fpdf->MultiCell(498, 10, substr(@$snwa->WS3TreatComments, 0, 162));
        $CI->fpdf->Line(8, 456+$a, 584, 456+$a);
            ####################################



            ####################################
        $a=-16;

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 257+$a, "WOUND SITE 4: ");

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
        $CI->fpdf->Text(85, 257+$a, @$snwa->WS4Site4);

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 267+$a, "Length:");
        $CI->fpdf->Text(210, 267+$a, "Width:");

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
        $CI->fpdf->Text(70, 267+$a, @$snwa->WS4Length);
        $CI->fpdf->Text(240, 267+$a, @$snwa->WS4Width);

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 277+$a, "Undermining:");
        $CI->fpdf->Text(210, 277+$a, "Depth:");
        $CI->fpdf->Text(400, 277+$a, "Tunneling:");

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
        $CI->fpdf->Text(70, 277+$a, @$snwa->WS4Under);
        $CI->fpdf->Text(240, 277+$a, @$snwa->WS4Depth);
        $CI->fpdf->Text(445, 277+$a, @$snwa->WS4Tunnel);


        $CI->fpdf->Line(8, 280+$a, 584, 280+$a);
    //
        $CI->fpdf->Line(304, 280+$a, 304, 326+$a);
    //

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 289+$a, "Drainage");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(11, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(23, 300+$a, "Serous");
        if (@$snwa->WS4DrainSerous == 1) {
            $CI->fpdf->Image( $path_ticket, 12, 293+$a,6);
        }
        $CI->fpdf->Rect(85, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(97, 300+$a, "Serosang");
        if (@$snwa->WS4DrainSerosang == 1) {
            $CI->fpdf->Image( $path_ticket, 86, 293+$a,6);
        }


        $CI->fpdf->Rect(160, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(172, 300+$a, "Purulent");
        if (@$snwa->WS4DrainPurulent == 1) {
            $CI->fpdf->Image( $path_ticket, 161, 293+$a,6);
        }

           /////////////////////////////////////


        $CI->fpdf->Line(8, 303+$a, 584, 303+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 312+$a, "Wound Bed Appearance");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(11, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(23, 323+$a, "Granulation");
        if (@$snwa->WS4WoBeApGranul == 1) {
            $CI->fpdf->Image( $path_ticket, 12, 316+$a,6);
        }

        $CI->fpdf->Rect(85, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(97, 323+$a, "Slough");
        if (@$snwa->WS4WoBeApSlough == 1) {
            $CI->fpdf->Image( $path_ticket, 86, 316+$a, 6);
        }

        $CI->fpdf->Rect(160, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(172, 323+$a, "Eschar");
        if (@$snwa->WS4WoBeApEschar == 1) {
            $CI->fpdf->Image( $path_ticket, 161, 316+$a,6);
        }

        $CI->fpdf->Rect(230, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(242, 323+$a, "Fibrotic");
        if (@$snwa->WS4WoBeApFibrotic == 1) {
            $CI->fpdf->Image( $path_ticket, 231, 316+$a,6);
        }

     //
        $CI->fpdf->Line(145, 326+$a, 145, 349+$a);
    //
        $CI->fpdf->Line(8, 326+$a, 584, 326+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 335+$a, "Surrounding Tissue");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Rect(11, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(23, 346+$a, "Erythema");
        if (@$snwa->WS4SuTiErythema == 1) {
            $CI->fpdf->Image( $path_ticket, 12, 339+$a,6);
        }
        $CI->fpdf->Rect(85, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(97, 346+$a, "Maceration");
        if (@$snwa->WS4SuTiMaceration == 1) {
            $CI->fpdf->Image( $path_ticket, 86, 339+$a, 6);
        }

        $CI->fpdf->Line(8, 349+$a, 584, 349+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(148, 335+$a, "Signs/Symptoms of Infection");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(148, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(160, 346+$a, "Fever");
        if (@$snwa->WS4SignInfectFever == 1) {
            $CI->fpdf->Image( $path_ticket, 149, 339+$a,6);
        }

        $CI->fpdf->Rect(200, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(212, 346+$a, "Redness");
        if (@$snwa->WS4SignInfectRedness == 1) {
            $CI->fpdf->Image( $path_ticket, 201, 339+$a, 6);
        }

        $CI->fpdf->Rect(270, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(282, 346+$a, "Swelling");
        if (@$snwa->WS4SignInfectSwelling == 1) {
            $CI->fpdf->Image( $path_ticket, 271, 339+$a,6);
        }

        $CI->fpdf->Rect(340, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(352, 346+$a, "Warmth");
        if (@$snwa->WS4SignInfectWarmth == 1) {
            $CI->fpdf->Image( $path_ticket, 341, 339+$a,6);
        }

        $CI->fpdf->Rect(410, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(422, 346+$a, "Other");
        if (@$snwa->WS4SignInfectOther == 1) {
            $CI->fpdf->Image( $path_ticket, 411, 339+$a,6);
        }

        $CI->fpdf->Rect(480, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(492, 346+$a, "N/A");
        if (@$snwa->WS4SignInfectNA == 1) {
            $CI->fpdf->Image( $path_ticket, 481, 339+$a,6);
        }


            ////$CI->fpdf->Line(8, 372+$a, 584, 372+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(312, 289+$a, "Amount");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(312, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(324, 300+$a, "Small");
        if (@$snwa->WS4AmtSmall == 1) {
            $CI->fpdf->Image( $path_ticket, 313, 293+$a,6);
        }

        $CI->fpdf->Rect(385, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(397, 300+$a, "Moderate");
        if (@$snwa->WS4AmtMod == 1) {
            $CI->fpdf->Image( $path_ticket, 386, 293+$a,6);
        }

        $CI->fpdf->Rect(460, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(472, 300+$a, "Large");
        if (@$snwa->WS4AmtLarge == 1) {
            $CI->fpdf->Image( $path_ticket, 461, 293+$a,6);
        }

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(312, 312+$a, "Odor");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(312, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(324, 323+$a, "None");
        if (@$snwa->WS4OdorNone == 1) {
            $CI->fpdf->Image( $path_ticket, 313, 316+$a,6);
        }

        $CI->fpdf->Rect(385, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(397, 323+$a, "Mild");
        if (@$snwa->WS4OdorMild == 1) {
            $CI->fpdf->Image( $path_ticket, 386, 316+$a,6);
        }

        $CI->fpdf->Rect(460, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(472, 323+$a, "Foul");
        if (@$snwa->WS4OdorFoul == 1) {
            $CI->fpdf->Image( $path_ticket, 461, 316+$a,6);
        }
        $a=$a-22;
        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 381+$a, "Treatment");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Text(11, 391+$a, "1) Cleanse with");
        $CI->fpdf->Text(11, 401+$a, "2) Pat Dry with");
        $CI->fpdf->Text(11, 411+$a, "3) Apply");
        $CI->fpdf->Text(11, 421+$a, "4) Cover with");
        $CI->fpdf->Text(11, 431+$a, "5) Secure with");
        $CI->fpdf->Text(11, 441+$a, "Comments");

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
        $CI->fpdf->Text(80, 391+$a, @$snwa->WS4TreatCleanse);
        $CI->fpdf->Text(80, 401+$a, @$snwa->WS4TreatPatDry);
        $CI->fpdf->Text(80, 411+$a, @$snwa->WS4TreatApply);
        $CI->fpdf->Text(80, 421+$a, @$snwa->WS4TreatCover);
        $CI->fpdf->Text(80, 431+$a, @$snwa->WS4TreatSecure);

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

        $CI->fpdf->Line(8, 392+$a, 584, 392+$a);
        $CI->fpdf->Line(8, 402+$a, 584, 402+$a);
        $CI->fpdf->Line(8, 412+$a, 584, 412+$a);
        $CI->fpdf->Line(8, 422+$a, 584, 422+$a);
        $CI->fpdf->Line(8, 432+$a, 584, 432+$a);
        $CI->fpdf->Line(77, 442+$a, 580, 442+$a);

        $CI->fpdf->SetXY(77, 433+$a);
        $CI->fpdf->MultiCell(498, 10, substr(@$snwa->WS4TreatComments, 0, 162));
        $CI->fpdf->Line(8, 456+$a, 584, 456+$a);
            ####################################


            ####################################
        $a=170;

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 257+$a, "WOUND SITE 5: ");

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
        $CI->fpdf->Text(85, 257+$a, @$snwa->WS5Site5);

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 267+$a, "Length:");
        $CI->fpdf->Text(210, 267+$a, "Width:");

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
        $CI->fpdf->Text(70, 267+$a, @$snwa->WS5Length);
        $CI->fpdf->Text(240, 267+$a, @$snwa->WS5Width);

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 277+$a, "Undermining:");
        $CI->fpdf->Text(210, 277+$a, "Depth:");
        $CI->fpdf->Text(400, 277+$a, "Tunneling:");

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
        $CI->fpdf->Text(70, 277+$a, @$snwa->WS5Under);
        $CI->fpdf->Text(240, 277+$a, @$snwa->WS5Depth);
        $CI->fpdf->Text(445, 277+$a, @$snwa->WS5Tunnel);


        $CI->fpdf->Line(8, 280+$a, 584, 280+$a);
    //
        $CI->fpdf->Line(304, 280+$a, 304, 326+$a);
    //

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 289+$a, "Drainage");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(11, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(23, 300+$a, "Serous");
        if (@$snwa->WS5DrainSerous == 1) {
            $CI->fpdf->Image( $path_ticket, 12, 293+$a,6);
        }
        $CI->fpdf->Rect(85, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(97, 300+$a, "Serosang");
        if (@$snwa->WS5DrainSerosang == 1) {
            $CI->fpdf->Image( $path_ticket, 86, 293+$a,6);
        }


        $CI->fpdf->Rect(160, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(172, 300+$a, "Purulent");
        if (@$snwa->WS5DrainPurulent == 1) {
            $CI->fpdf->Image( $path_ticket, 161, 293+$a,6);
        }

           /////////////////////////////////////


        $CI->fpdf->Line(8, 303+$a, 584, 303+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 312+$a, "Wound Bed Appearance");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(11, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(23, 323+$a, "Granulation");
        if (@$snwa->WS5WoBeApGranul == 1) {
            $CI->fpdf->Image( $path_ticket, 12, 316+$a,6);
        }

        $CI->fpdf->Rect(85, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(97, 323+$a, "Slough");
        if (@$snwa->WS5WoBeApSlough == 1) {
            $CI->fpdf->Image( $path_ticket, 86, 316+$a, 6);
        }

        $CI->fpdf->Rect(160, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(172, 323+$a, "Eschar");
        if (@$snwa->WS5WoBeApEschar == 1) {
            $CI->fpdf->Image( $path_ticket, 161, 316+$a,6);
        }

        $CI->fpdf->Rect(230, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(242, 323+$a, "Fibrotic");
        if (@$snwa->WS5WoBeApFibrotic == 1) {
            $CI->fpdf->Image( $path_ticket, 231, 316+$a,6);
        }

     //
        $CI->fpdf->Line(145, 326+$a, 145, 349+$a);
    //
        $CI->fpdf->Line(8, 326+$a, 584, 326+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 335+$a, "Surrounding Tissue");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Rect(11, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(23, 346+$a, "Erythema");
        if (@$snwa->WS5SuTiErythema == 1) {
            $CI->fpdf->Image( $path_ticket, 12, 339+$a,6);
        }
        $CI->fpdf->Rect(85, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(97, 346+$a, "Maceration");
        if (@$snwa->WS5SuTiMaceration == 1) {
            $CI->fpdf->Image( $path_ticket, 86, 339+$a, 6);
        }

        $CI->fpdf->Line(8, 349+$a, 584, 349+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(148, 335+$a, "Signs/Symptoms of Infection");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(148, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(160, 346+$a, "Fever");
        if (@$snwa->WS5SignInfectFever == 1) {
            $CI->fpdf->Image( $path_ticket, 149, 339+$a,6);
        }

        $CI->fpdf->Rect(200, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(212, 346+$a, "Redness");
        if (@$snwa->WS5SignInfectRedness == 1) {
            $CI->fpdf->Image( $path_ticket, 201, 339+$a, 6);
        }

        $CI->fpdf->Rect(270, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(282, 346+$a, "Swelling");
        if (@$snwa->WS5SignInfectSwelling == 1) {
            $CI->fpdf->Image( $path_ticket, 271, 339+$a,6);
        }

        $CI->fpdf->Rect(340, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(352, 346+$a, "Warmth");
        if (@$snwa->WS5SignInfectWarmth == 1) {
            $CI->fpdf->Image( $path_ticket, 341, 339+$a,6);
        }

        $CI->fpdf->Rect(410, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(422, 346+$a, "Other");
        if (@$snwa->WS5SignInfectOther == 1) {
            $CI->fpdf->Image( $path_ticket, 411, 339+$a,6);
        }

        $CI->fpdf->Rect(480, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(492, 346+$a, "N/A");
        if (@$snwa->WS5SignInfectNA == 1) {
            $CI->fpdf->Image( $path_ticket, 481, 339+$a,6);
        }


            ////$CI->fpdf->Line(8, 372+$a, 584, 372+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(312, 289+$a, "Amount");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(312, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(324, 300+$a, "Small");
        if (@$snwa->WS5AmtSmall == 1) {
            $CI->fpdf->Image( $path_ticket, 313, 293+$a,6);
        }

        $CI->fpdf->Rect(385, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(397, 300+$a, "Moderate");
        if (@$snwa->WS5AmtMod == 1) {
            $CI->fpdf->Image( $path_ticket, 386, 293+$a,6);
        }

        $CI->fpdf->Rect(460, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(472, 300+$a, "Large");
        if (@$snwa->WS5AmtLarge == 1) {
            $CI->fpdf->Image( $path_ticket, 461, 293+$a,6);
        }

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(312, 312+$a, "Odor");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(312, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(324, 323+$a, "None");
        if (@$snwa->WS5OdorNone == 1) {
            $CI->fpdf->Image( $path_ticket, 313, 316+$a,6);
        }

        $CI->fpdf->Rect(385, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(397, 323+$a, "Mild");
        if (@$snwa->WS5OdorMild == 1) {
            $CI->fpdf->Image( $path_ticket, 386, 316+$a,6);
        }

        $CI->fpdf->Rect(460, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(472, 323+$a, "Foul");
        if (@$snwa->WS5OdorFoul == 1) {
            $CI->fpdf->Image( $path_ticket, 461, 316+$a,6);
        }
        $a=$a-22;
        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 381+$a, "Treatment");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Text(11, 391+$a, "1) Cleanse with");
        $CI->fpdf->Text(11, 401+$a, "2) Pat Dry with");
        $CI->fpdf->Text(11, 411+$a, "3) Apply");
        $CI->fpdf->Text(11, 421+$a, "4) Cover with");
        $CI->fpdf->Text(11, 431+$a, "5) Secure with");
        $CI->fpdf->Text(11, 441+$a, "Comments");

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
        $CI->fpdf->Text(80, 391+$a, @$snwa->WS5TreatCleanse);
        $CI->fpdf->Text(80, 401+$a, @$snwa->WS5TreatPatDry);
        $CI->fpdf->Text(80, 411+$a, @$snwa->WS5TreatApply);
        $CI->fpdf->Text(80, 421+$a, @$snwa->WS5TreatCover);
        $CI->fpdf->Text(80, 431+$a, @$snwa->WS5TreatSecure);

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

        $CI->fpdf->Line(8, 392+$a, 584, 392+$a);
        $CI->fpdf->Line(8, 402+$a, 584, 402+$a);
        $CI->fpdf->Line(8, 412+$a, 584, 412+$a);
        $CI->fpdf->Line(8, 422+$a, 584, 422+$a);
        $CI->fpdf->Line(8, 432+$a, 584, 432+$a);
        $CI->fpdf->Line(77, 442+$a, 580, 442+$a);

        $CI->fpdf->SetXY(77, 433+$a);
        $CI->fpdf->MultiCell(498, 10, substr(@$snwa->WS5TreatComments, 0, 162));
        $CI->fpdf->Line(8, 456+$a, 584, 456+$a);
            ####################################

            ####################################
        $a=357;

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 257+$a, "WOUND SITE 6: ");

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
        $CI->fpdf->Text(85, 257+$a, @$snwa->WS6Site6);

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 267+$a, "Length:");
        $CI->fpdf->Text(210, 267+$a, "Width:");

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
        $CI->fpdf->Text(70, 267+$a, @$snwa->WS6Length);
        $CI->fpdf->Text(240, 267+$a, @$snwa->WS6Width);

        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 277+$a, "Undermining:");
        $CI->fpdf->Text(210, 277+$a, "Depth:");
        $CI->fpdf->Text(400, 277+$a, "Tunneling:");

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
        $CI->fpdf->Text(70, 277+$a, @$snwa->WS6Under);
        $CI->fpdf->Text(240, 277+$a, @$snwa->WS6Depth);
        $CI->fpdf->Text(445, 277+$a, @$snwa->WS6Tunnel);


        $CI->fpdf->Line(8, 280+$a, 584, 280+$a);
    //
        $CI->fpdf->Line(304, 280+$a, 304, 326+$a);
    //

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 289+$a, "Drainage");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(11, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(23, 300+$a, "Serous");
        if (@$snwa->WS6DrainSerous == 1) {
            $CI->fpdf->Image( $path_ticket, 12, 293+$a,6);
        }
        $CI->fpdf->Rect(85, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(97, 300+$a, "Serosang");
        if (@$snwa->WS6DrainSerosang == 1) {
            $CI->fpdf->Image( $path_ticket, 86, 293+$a,6);
        }


        $CI->fpdf->Rect(160, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(172, 300+$a, "Purulent");
        if (@$snwa->WS6DrainPurulent == 1) {
            $CI->fpdf->Image( $path_ticket, 161, 293+$a,6);
        }

           /////////////////////////////////////


        $CI->fpdf->Line(8, 303+$a, 584, 303+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 312+$a, "Wound Bed Appearance");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(11, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(23, 323+$a, "Granulation");
        if (@$snwa->WS6WoBeApGranul == 1) {
            $CI->fpdf->Image( $path_ticket, 12, 316+$a,6);
        }

        $CI->fpdf->Rect(85, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(97, 323+$a, "Slough");
        if (@$snwa->WS6WoBeApSlough == 1) {
            $CI->fpdf->Image( $path_ticket, 86, 316+$a, 6);
        }

        $CI->fpdf->Rect(160, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(172, 323+$a, "Eschar");
        if (@$snwa->WS6WoBeApEschar == 1) {
            $CI->fpdf->Image( $path_ticket, 161, 316+$a,6);
        }

        $CI->fpdf->Rect(230, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(242, 323+$a, "Fibrotic");
        if (@$snwa->WS6WoBeApFibrotic == 1) {
            $CI->fpdf->Image( $path_ticket, 231, 316+$a,6);
        }

     //
        $CI->fpdf->Line(145, 326+$a, 145, 349+$a);
    //
        $CI->fpdf->Line(8, 326+$a, 584, 326+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 335+$a, "Surrounding Tissue");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Rect(11, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(23, 346+$a, "Erythema");
        if (@$snwa->WS6SuTiErythema == 1) {
            $CI->fpdf->Image( $path_ticket, 12, 339+$a,6);
        }
        $CI->fpdf->Rect(85, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(97, 346+$a, "Maceration");
        if (@$snwa->WS6SuTiMaceration == 1) {
            $CI->fpdf->Image( $path_ticket, 86, 339+$a, 6);
        }

        $CI->fpdf->Line(8, 349+$a, 584, 349+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(148, 335+$a, "Signs/Symptoms of Infection");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(148, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(160, 346+$a, "Fever");
        if (@$snwa->WS6SignInfectFever == 1) {
            $CI->fpdf->Image( $path_ticket, 149, 339+$a,6);
        }

        $CI->fpdf->Rect(200, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(212, 346+$a, "Redness");
        if (@$snwa->WS6SignInfectRedness == 1) {
            $CI->fpdf->Image( $path_ticket, 201, 339+$a, 6);
        }

        $CI->fpdf->Rect(270, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(282, 346+$a, "Swelling");
        if (@$snwa->WS6SignInfectSwelling == 1) {
            $CI->fpdf->Image( $path_ticket, 271, 339+$a,6);
        }

        $CI->fpdf->Rect(340, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(352, 346+$a, "Warmth");
        if (@$snwa->WS6SignInfectWarmth == 1) {
            $CI->fpdf->Image( $path_ticket, 341, 339+$a,6);
        }

        $CI->fpdf->Rect(410, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(422, 346+$a, "Other");
        if (@$snwa->WS6SignInfectOther == 1) {
            $CI->fpdf->Image( $path_ticket, 411, 339+$a,6);
        }

        $CI->fpdf->Rect(480, 338+$a, 8.4, 8.4);
        $CI->fpdf->Text(492, 346+$a, "N/A");
        if (@$snwa->WS6SignInfectNA == 1) {
            $CI->fpdf->Image( $path_ticket, 481, 339+$a,6);
        }


            ////$CI->fpdf->Line(8, 372+$a, 584, 372+$a);

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(312, 289+$a, "Amount");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(312, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(324, 300+$a, "Small");
        if (@$snwa->WS6AmtSmall == 1) {
            $CI->fpdf->Image( $path_ticket, 313, 293+$a,6);
        }

        $CI->fpdf->Rect(385, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(397, 300+$a, "Moderate");
        if (@$snwa->WS6AmtMod == 1) {
            $CI->fpdf->Image( $path_ticket, 386, 293+$a,6);
        }

        $CI->fpdf->Rect(460, 292+$a, 8.4, 8.4);
        $CI->fpdf->Text(472, 300+$a, "Large");
        if (@$snwa->WS6AmtLarge == 1) {
            $CI->fpdf->Image( $path_ticket, 461, 293+$a,6);
        }

        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(312, 312+$a, "Odor");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Rect(312, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(324, 323+$a, "None");
        if (@$snwa->WS6OdorNone == 1) {
            $CI->fpdf->Image( $path_ticket, 313, 316+$a,6);
        }

        $CI->fpdf->Rect(385, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(397, 323+$a, "Mild");
        if (@$snwa->WS6OdorMild == 1) {
            $CI->fpdf->Image( $path_ticket, 386, 316+$a,6);
        }

        $CI->fpdf->Rect(460, 315+$a, 8.4, 8.4);
        $CI->fpdf->Text(472, 323+$a, "Foul");
        if (@$snwa->WS6OdorFoul == 1) {
            $CI->fpdf->Image( $path_ticket, 461, 316+$a,6);
        }
        $a=$a-22;
        $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['SIZE']);
        $CI->fpdf->Text(11, 381+$a, "Treatment");
        $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['SIZE']);

        $CI->fpdf->Text(11, 391+$a, "1) Cleanse with");
        $CI->fpdf->Text(11, 401+$a, "2) Pat Dry with");
        $CI->fpdf->Text(11, 411+$a, "3) Apply");
        $CI->fpdf->Text(11, 421+$a, "4) Cover with");
        $CI->fpdf->Text(11, 431+$a, "5) Secure with");
        $CI->fpdf->Text(11, 441+$a, "Comments");

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);
        $CI->fpdf->Text(80, 391+$a, @$snwa->WS6TreatCleanse);
        $CI->fpdf->Text(80, 401+$a, @$snwa->WS6TreatPatDry);
        $CI->fpdf->Text(80, 411+$a, @$snwa->WS6TreatApply);
        $CI->fpdf->Text(80, 421+$a, @$snwa->WS6TreatCover);
        $CI->fpdf->Text(80, 431+$a, @$snwa->WS6TreatSecure);

        $CI->fpdf->SetFont('Courier','B',$__FONT['PDF']['FORM_MEDIUM']);

        $CI->fpdf->Line(8, 392+$a, 584, 392+$a);
        $CI->fpdf->Line(8, 402+$a, 584, 402+$a);
        $CI->fpdf->Line(8, 412+$a, 584, 412+$a);
        $CI->fpdf->Line(8, 422+$a, 584, 422+$a);
        $CI->fpdf->Line(8, 432+$a, 584, 432+$a);
        $CI->fpdf->Line(77, 442+$a, 580, 442+$a);

        $CI->fpdf->SetXY(77, 433+$a);
        $CI->fpdf->MultiCell(498, 10, substr(@$snwa->WS6TreatComments, 0, 162));
        $CI->fpdf->Line(8, 456+$a, 584, 456+$a);
            ####################################
    }

    $cero_x = 11;

    $cero_y = 2;

        ####### PAGE 4 ###########
    if (strlen(@$snpn->additional_comments)>0)
    {
     $CI->fpdf->AddPage();



     $CI->fpdf->SetDrawColor(130,100);

     $CI->fpdf->Text(( $cero_x + 240),( $cero_y + 22 ),"ADDENDUM");


     $CI->fpdf->Rect(8,28, 577, 763);

     $cero_y = 8;

     $CI->fpdf->SetTextColor(0,0,0);

     $CI->fpdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);

     $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 32 ),"Patient Name: ");



     $CI->fpdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);

            $CI->fpdf->Text(( $cero_x + 60),( $cero_y + 32 ), $patient->first_name . " " . $patient->last_name); // pacient name



            $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

            $CI->fpdf->SetTextColor(0,0,0);



            $CI->fpdf->SetDrawColor(130,100);

            $CI->fpdf->Text(( $cero_x + 230),( $cero_y + 32 ),"Medical Rec#: ");



            $CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_SMALL']);

            $CI->fpdf->Text(( $cero_x + 290),( $cero_y + 32 ),  $patient->medical_rec_nbr); // medicare id



            $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);

           $CI->fpdf->Text(( $cero_x + 395 +20),( $cero_y + 32 ), "VISIT DATE: " . standard_date(mysql_to_unix($visit_log->visited_date)));



            #############################################33



           $CI->fpdf->Line(8, 75, 584, 75);
           $CI->fpdf->Line(8, 85, 584, 85);
           $CI->fpdf->Line(8, 95, 584, 95);
           $CI->fpdf->Line(8, 105, 584, 105);
           $CI->fpdf->Line(8, 115, 584, 115);
           $CI->fpdf->Line(8, 125, 584, 125);
           $CI->fpdf->Line(8, 135, 584, 135);
           $CI->fpdf->Line(8, 145, 584, 145);
           $CI->fpdf->Line(8, 155, 584, 155);
           $CI->fpdf->Line(8, 165, 584, 165);
           $CI->fpdf->Line(8, 175, 584, 175);
           $CI->fpdf->Line(8, 185, 584, 185);
           $CI->fpdf->Line(8, 195, 584, 195);
           $CI->fpdf->Line(8, 205, 584, 205);

           $CI->fpdf->Text(11, 54, "Additional Notes");
           $CI->fpdf->Line(8, 45, 584, 45);
           $CI->fpdf->SetXY(10, 66);
           $CI->fpdf->MultiCell(570, 10, substr(@$snpn->additional_comments, 0, 4000));

       }

    //$CI->fpdf->Output('snpn.pdf','D');

    //$title_text = $visit_log->visit_description." Visit Date: " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    $title_text = "SNPN Visit Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;

  }


    function dorderPdfPage ( $__FONT, $doctor_order, $agency ) {
        $CI =& get_instance();

        $cero_x = 11;
        $cero_y = 2;

        $CI->fpdf->Open();
        $pdf = $CI->fpdf;
        $pdf->AddPage();

        $pdf->SetDrawColor(130, 100);
        //$pdf->SetFont('Arial','B',$__FONT['PDF']['FORM_MEDIUM']);
        $pdf->SetFont('Arial','B',12);
        $pdf->Text(( $cero_x + 0),( $cero_y + 12 ), $agency->agency_name); // agency name

        $pdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL3']);
        $pdf->Text(( $cero_x + 0),( $cero_y + 20 ),"Licensed and Certified Home Health Agency");

        $pdf->Rect(8,25, 577, 760);

        //$pdf->SetFont('Arial', 'B', $__FONT['PDF']['FORM_SMALL']);
        $pdf->SetFont('Arial', 'B', 13);
        if ($doctor_order->doc_doctor_order_type_id==5) {
            $pdf->Text(210, 38, strtoupper($doctor_order->doc_doctor_order_type_description));
        } else {
            $pdf->Text(260, 38, strtoupper($doctor_order->doc_doctor_order_type_description));
        }
        //$pdf->Text(460, 38, "Order Date   " . standard_date(mysql_to_unix($doctor_order->do_date)));

        $pdf->Line(8 , 42.5, 585, 42.5);

        $pdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']);
        $address = $agency->address.", ".$agency->city.", ".$agency->state_name_short.", ".$agency->zip;
        $pdf->Text(11, 800, $address);
        $pdf->Text(350, 800, "Phone: " . $agency->phone_primary);
        $pdf->Text(470, 800, "Fax: " . $agency->fax);
        // $pdf->Text(230, 820, "HomeHealthSoft Inc.   2006  ".date("Y")." ");
        $pdf->Text(250, 820, "HomeHealthSoft Inc.");
    }

function dorder_pdf ( $visit_log_id, $output='F'  ) {
    $CI =& get_instance();

    $CI->load->model('dordermdl');

        // saving before printing pdf
    $visit_log = $CI->visitlogmdl->getById($visit_log_id);
    $visitlog = $visit_log;

    $doctor_order = $CI->dordermdl->get($visit_log_id);
    $patient        = $CI->patientmdl->getById($visit_log->patient_id);

    $agency       = $CI->agencymdl->getByAgencyId($patient->agency_id);
    $doctor_office_id = $visit_log->phys_user_id;
    
    if (is_null($doctor_office_id)) {
        $cms485 = $CI->episodemdl->getById($visit_log->cms485_id);
        $doctor_office_id = $cms485->phys_user_id;
    } else {
        $doctor_office_user = $CI->usagymdl->getByUsAgyId($doctor_office_id);
        $doctor_office_id = $doctor_office_user->agency_id;
    }

    $doctor = $CI->agencymdl->getByAgencyId($doctor_office_id);

    $primary_diag = "";
    $secondary_diag = "";
    $primary_diag_date = "";
    $secondary_diag_date = "";

    if (TRUE) {
        $prev_eval = array();
        $CI->load->model('ptevmdl');
        $ptevs = $CI->ptevmdl->getPrevious(null, $visit_log->visit_date_time, $visit_log->cms485_id);
        if (count($ptevs) == 0) {
            $ptevs = $CI->ptevmdl->getPrevious(null, @ $visit_log->visit_date_time, @ $visit_log->cms485_id, TRUE); // look all PTEV of current SOC
        }
        if (count($ptevs)) {
            $prev_eval = $ptevs[count($ptevs) - 1];
        }

        if (empty($prev_eval)) {
            $CI->load->model('otevmdl');
            $otevs = $CI->otevmdl->getPrevious(null, $visit_log->visit_date_time, $visit_log->cms485_id);
            if (count($otevs) == 0) {
                $otevs = $CI->otevmdl->getPrevious(null, $visit_log->visit_date_time, $visit_log->cms485_id, TRUE); // Look into all prev periods
            }
            if (count($otevs)) {
                $prev_eval = $otevs[count($otevs) - 1];
            }
        }

        if (empty($prev_eval)) {
            $CI->load->model('stevmdl');
            $stevs = $CI->stevmdl->getPrevious(null, $visit_log->visit_date_time, $visit_log->cms485_id);
            if (count($stevs) == 0) {
                $stevs = $CI->stevmdl->getPrevious(null, $visit_log->visit_date_time, $visit_log->cms485_id, TRUE); // Look into all prev periods
            }
            if (count($stevs)) {
                $prev_eval = $stevs[count($stevs) - 1];
            }
        }


        if (isset($prev_eval->primary_diag)) {
            $primary_diag = $prev_eval->primary_diag;
        }

        if (isset($prev_eval->secondary_diag)) {
            $secondary_diag = $prev_eval->secondary_diag;
        }

        if (isset($prev_eval->primary_diag_date)) {
            $primary_diag_date = date("m-d-Y", strtotime($prev_eval->primary_diag_date));
        }

        if (isset($prev_eval->secondary_diag_date)) {
            $secondary_diag_date = date("m-d-Y", strtotime($prev_eval->secondary_diag_date));
        }

    }

    $path_ticket = realpath("style/images/icon_enable_negro.gif");

    $__FONT['PDF']['SIZE'] = 11;
    $__FONT['PDF']['FORM_MEDIUM'] = 10;
    //$__FONT['PDF']['FORM_SMALL'] = 9;
    $__FONT['PDF']['FORM_SMALL'] = 10;
    $__FONT['PDF']['FORM_SMALL2'] = 9;
    $__FONT['PDF']['FORM_SMALL3'] = 6.5;
    $__FONT['PDF']['FORM_SMALL4'] = 9.5;
    $__FONT['PDF']['FORM_arial8'] = 9.5;

    $CI->load->library('fpdf');
    if(!defined('FPDF_FONTPATH'))
      define('FPDF_FONTPATH',$CI->config->item('fonts_path'));

    $CI->fpdf = new fpdf;
    dorderPdfPage($__FONT, $doctor_order, $agency);
    $pdf = $CI->fpdf;

    // Order Date
    $pdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(30, 55+30, "Order Date: ");

    $pdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(150, 55+30, standard_date(mysql_to_unix($visit_log->visit_date_time))." ".date("h:i A", mysql_to_unix($visit_log->visit_date_time)) );


    // physician
    $pdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(30, 70+30, "Physician: ");

    $pdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(150, 70+30, $doctor->agency_name );

    // physician
    $pdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(30, 85+30, "Patient Name: ");

    $pdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(150, 85+30, $patient->first_name . ' ' . $patient->last_name);

    // order by
    $pdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(30, 100+30+20, "Ordered By: ");

    $pdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(150, 100+30+20, $visit_log->first_name." ".$visit_log->last_name);

    /*// Diagnosis field
    $pdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(30, 115+30+20, "Primary Dx: ");

    $pdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(150, 115+30+20, $primary_diag);

    // Diagnosis Date field
    $pdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(380, 115+30+20, "Prim Dx Date: ");

    $pdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(500, 115+30+20, $primary_diag_date);

    // Diagnosis field
    $pdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(30, 130+30+20, "Therapy Dx: ");

    $pdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(150, 130+30+20, $secondary_diag);

    // Diagnosis Date field
    $pdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(380, 130+30+20, "Ther Dx Date: ");

    $pdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(500, 130+30+20, $secondary_diag_date);*/

    // Adjust gap for removal of diagnosis fields
    $y_adjust = -40;

    // order description
    $pdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(30, 145+30+30+$y_adjust, "Order Description: ");

    $eje_y = 145+15+30+30+10+$y_adjust;
    $pdf->SetFont('Courier', '', $__FONT['PDF']['FORM_SMALL'] );
    /*$pdf->SetXY(11, $eje_y);
    $pdf->MultiCell(566, 12, $doctor_order->order_description);
    */

    $lines = explode("\n", wordwrap(@$doctor_order->do_description, 86, "\n"));
    foreach ($lines as $substring) {

        //$pdf->Text(150, $eje_y, $substring);
        $pdf->Text(30, $eje_y, $substring);
        $pdf->SetLineWidth( 0.5 );
        $pdf->Line(30, $eje_y+4, 554, $eje_y+4);

        $eje_y += 15;

        if ($eje_y > 660) {
            dorderPdfPage($__FONT, $doctor_order, $agency);

            $pdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
            $pdf->Text(30, 55, "Order Description: ");

            $pdf->SetFont('Courier', '', $__FONT['PDF']['FORM_SMALL'] );
            $eje_y = 55+30;
        }

    }

    if ($eje_y >= 675) {
        dorderPdfPage($__FONT, $doctor_order, $agency);
    }

    // Clinician/Therapist Signature
    $pdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $pdf->Text(30, 740-20, "Clinician Signature:");
    $pdf->Text(130, 740-20, "____________________________________________                               Date: _____________");
    $pdf->SetFont('Courier','',$__FONT['PDF']['FORM_MEDIUM']);
    if ($visit_log->sent_to_approve_date) {
        $pdf->Text(130, 740-20, "ELECTRONICALLY SIGNED BY " . $visit_log->first_name . " " . $visit_log->last_name);
        $pdf->Text(430+65, 740-20, standard_date(mysql_to_unix($visit_log->visit_date_time)));
    }
    // echo "<pre>";print_r($doctor_order);exit;
    if ($doctor_order->order_type_id == 4) {
        // Physician signature
        $pdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
        $pdf->Text(30, 740, "Physician Signature:");
        $pdf->Text(130, 740, "____________________________________________                               Date: _____________");

        $pdf->SetFont('Courier','',$__FONT['PDF']['FORM_MEDIUM']);

        if ($visit_log->tab_023_doctor_order_status == 3) {
            $pdf->Text(130, 740, "ELECTRONICALLY SIGNED BY " . $doctor->agency_name);
        } else if ($visit_log->tab_023_doctor_order_status == 5) {
            $pdf->Text(130, 740, " Order Signed On File");
            $pdf->Text(430+65, 740, standard_date(mysql_to_unix($visit_log->signed_by_physician_date)));
            $pdf->Text(430-65+25, 740 + 20, "Received By Agency " . standard_date(mysql_to_unix($visit_log->received_by_agency_date)));
        }
    }



    $title_text = "DOCTOR ORDER Order Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;
}


function muvi_y_waiver_pdf ($visit_log_id, $output ='F') {
    global $GL_VISIT;

    $CI =& get_instance();

    $CI->load->model('muvimdl');

    $visit_log = $CI->visitlogmdl->getById($visit_log_id);
    $visitlog = $visit_log;
    $agy_user_id = $visit_log->user_id;
    $us1_user = $CI->usermdl->getById($agy_user_id);

    $muvi = $CI->muvimdl->get($visit_log_id);

    $GL_VISIT = $muvi;

    $patient = $CI->patientmdl->getById($visit_log->patient_id);

    $visit_user = $CI->usagymdl->getByUsAgyId($visitlog->visit_user_id);
    $contractor = $CI->agencymdl->getByAgencyId($visit_user->agency_id);
    if ($visitlog->visit_discipline_id) {
        $user_discipline = $CI->disciplinemdl->getById($visitlog->visit_discipline_id);
        $visit_user = (object) array_merge((array)$visit_user, (array)$user_discipline );
    }

    if ($contractor->state_id == 6) {
        $muvi->gov_program = 'WAIVER';
        if ($patient->gov_program_waiver) {
            $muvi->gov_program .= '['.$patient->gov_program_waiver.']';
        }
    }

    // $superv_user = $CI->usagymdl->getByUsAgyId($visitlog->superv_user_id);
    $supervisor_signed_by = array();
    if ($muvi->wsuperv_signed_by) {
        $supervisor_signed_by = $CI->usagymdl->getByUsAgyId($muvi->wsuperv_signed_by);
    }
    $agency = $CI->agencymdl->getByAgencyId($patient->agency_id);
    // print_r($agency);exit();
    $medicaidInsurance = $CI->patientinsurancemdl->getMedicaidInsurance($visitlog->patient_id);

    $path_ticket = realpath("style/images/icon_enable_negro.gif");
    $label_font = "Arial";
    $data_font = "Courier";

    $__FONT['PDF']['SIZE'] = 9;
    $__FONT['PDF']['FORM_MEDIUM'] = 10;
    $__FONT['PDF']['FORM_SMALL'] = 9;
    $__FONT['PDF']['FORM_SMALL2'] = 8;
    $__FONT['PDF']['FORM_SMALL3'] = 6.5;
    $__FONT['PDF']['FORM_SMALL4'] = 9.5;
    $__FONT['PDF']['FORM_arial8'] = 9.5;


    $CI->load->library('fpdf');
    if(!defined('FPDF_FONTPATH'))
      define('FPDF_FONTPATH',$CI->config->item('fonts_path'));
    $total_page = 1;
    $CI->fpdf->Open();
    $pdf = $CI->fpdf;
    $pdf->AddPage();
    $con = 2.8346456692913384;
    $cero_x = 11;
    $cero_y = 2;
    $y = $pdf->GetY();
    $x = $pdf->GetX();

    
    if ($contractor->state_id == 6) {
        $pdf->SetFont('Arial', 'B', 13);
        $CI->fpdf->Text(($x + 115), ($y + 15), "Music Therapy Progress Notes - WAIVER");
    } else {
        $agency_company_name = "";
        if ($agency->print_agency_or_contractor_on_notes == "contractor") {
            $agency_company_name = $visit_log->visit_contractor_name;
            $pdf->SetFont('Arial', 'B', 11);
            $CI->fpdf->Text(($x + 150), ($y + 5), $agency_company_name);
            $pdf->SetFont('Arial', 'B', 10);
            $CI->fpdf->Text(($x + 115), ($y + 20), "Music Therapy Progress Note - [Yes-Waiver]");
        } else {
            $pdf->SetFont('Arial', 'B', 13);
            $CI->fpdf->Text(($x + 115), ($y + 15), "Music Therapy Progress Note - [Yes-Waiver]");
        }
    }

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 50), "County:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +78), ($cero_x +155), ($cero_y +78));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 50), $patient->city);

    $pdf->SetFont('Arial', 'B', 8);
    // $CI->fpdf->Text(($x + 360), ($y + 60), "Program Name:");
    $CI->fpdf->Text(($x + 200), ($y + 50), "Program Name:");
    $CI->fpdf->Line(($cero_x +447-160), ($cero_y +78), ($cero_x +487-160), ($cero_y +78));
    $pdf->SetFont('Courier', '', 8);

 
    $CI->fpdf->Text(($x + 430-160), ($y + 50), $muvi->gov_program);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 50), "Medicaid #:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +78), ($cero_x +487), ($cero_y +78));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 430), ($y + 50), @$medicaidInsurance->ins_id);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 62), "Pt. Name:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +90), ($cero_x +150), ($cero_y +90));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 62), $patient->first_name.' '.$patient->last_name);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 74), "Visit Date:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +102), ($cero_x +139), ($cero_y +102));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 74), standard_date(mysql_to_unix($visit_log->visited_date)) );

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 62), "Case #:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +90), ($cero_x +487), ($cero_y +90));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 430), ($y + 62), @$patient->medical_rec_nbr);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 74), "Client DOB:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +102), ($cero_x +498), ($cero_y +102));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 430), ($y + 74), standard_date(mysql_to_unix($patient->date_birth)));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 87), "Time in:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +115), ($cero_x +130), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 87), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_in)));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 150), ($y + 87), "Time Out:");
    $CI->fpdf->Line(($cero_x +206), ($cero_y +115), ($cero_x +246), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 189), ($y + 87), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_out)));

    $date2 = strtotime(date("Y-m-d ").$visit_log->visited_time_out);
    $date1 = strtotime(date("Y-m-d ").$visit_log->visited_time_in);

    if(is_null($visit_log->visited_time_in)){
      $date1 = strtotime(date("Y-m-d ").$visit_log->visit_date_time);
      $date2 = strtotime(date("Y-m-d ").$visit_log->visit_date_time)+(45*60);
    }

    $visit_duration = floor(($date2 - $date1)/60);

    if($visit_duration < 0){
        $date2 = strtotime(date("Y-m-d ", mktime(0,0,0,date("m"),date("j")+1,date("Y") )).$visit_log->visited_time_out);
        $visit_duration = floor(($date2 - $date1)/60);
      //$visit_duration = 45;
      // $date2 = $date1+(45*60);
    }elseif($visit_duration==0){
      $visit_duration = '00';
    }


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 260), ($y + 87), "Total time:");
    $CI->fpdf->Line(($cero_x +319), ($cero_y +115), ($cero_x +332), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 302), ($y + 87), (string)$visit_duration);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 87), "Unit Amount:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +115), ($cero_x +460), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    if ($agency->F3625_measure_unit) {
        $CI->fpdf->Text(($x + 430), ($y + 87), ($visit_duration/(60/$agency->F3625_measure_unit)));
    } else {
        $CI->load->model('spvisitunitmdl');
        $units = $CI->spvisitunitmdl->get('Y-Waiver', $visit_duration);
        $CI->fpdf->Text(($x + 430), ($y + 87), (string)number_format($units, 0));
    }

    

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 100), "Therapist:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +128), ($cero_x +270), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 100), $visit_log->first_name ." ". $visit_log->last_name. "");

    $CI->fpdf->Line(($cero_x +30), ($cero_y +135), ($cero_x +520), ($cero_y +135));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 123), "Location of therapy:");
    $CI->fpdf->Line(($cero_x +116), ($cero_y +151), ($cero_x +230), ($cero_y +151));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 22 + 79), ($y + 123), substr($muvi->wlocation_therapy, 0, 30));

    if ($contractor->state_id == 6) {
        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 250), ($y + 123), "Session Type:");
        $CI->fpdf->Line(($cero_x +334), ($cero_y +151), ($cero_x +410), ($cero_y +151));
        $pdf->SetFont('Courier', '', 8);
        // $CI->fpdf->Text(($x + 250 + 68), ($y + 123), $muvi->session_type);
        $CI->fpdf->Text(($x + 250 + 68), ($y + 123), 'Treatment');


        $cero_y += 12;        
        $y += 12;        
        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 22), ($y + 123), "Persons present:");
        $CI->fpdf->Line(($cero_x +116), ($cero_y +151), ($cero_x +300), ($cero_y +151));
        $pdf->SetFont('Courier', '', 8);
        $CI->fpdf->Text(($x + 22 + 79), ($y + 123), substr($muvi->wpersons_present, 0, 35));
    } else {        
        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 250), ($y + 123), "Persons present:");
        $CI->fpdf->Line(($cero_x +334), ($cero_y +151), ($cero_x +510), ($cero_y +151));
        $pdf->SetFont('Courier', '', 8);
        $CI->fpdf->Text(($x + 250 + 68), ($y + 123), substr($muvi->wpersons_present, 0, 35));
    }

    //470 words
    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 138), "Activity/Description of Contact:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +179), ($cero_x +510), ($cero_y +179));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +190), ($cero_x +510), ($cero_y +190));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +201), ($cero_x +510), ($cero_y +201));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +212), ($cero_x +510), ($cero_y +212));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +223), ($cero_x +510), ($cero_y +223));

    $pdf->SetFont('Courier', '', 8);
    $activity  = str_replace("\n", " ", $muvi->wactivity_descrip);
    $CI->fpdf->SetXY( ($x + 20) , ($y + 142));
    $CI->fpdf->MultiCell(476, 11, ''.substr($activity,0, 470));

    //380 words
    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 210), "Specific Skills received and method used to train client in skills:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +251), ($cero_x +510), ($cero_y +251));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +262), ($cero_x +510), ($cero_y +262));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +273), ($cero_x +510), ($cero_y +273));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +284), ($cero_x +510), ($cero_y +284));

    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 214));
    $wspecific_skills  = str_replace("\n", " ", $muvi->wspecific_skills);
    $CI->fpdf->MultiCell(476, 11, substr($wspecific_skills,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 271), "Client's response to service being provided(observations):");
     $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +312), ($cero_x +510), ($cero_y +312));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +323), ($cero_x +510), ($cero_y +323));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +334), ($cero_x +510), ($cero_y +334));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +345), ($cero_x +510), ($cero_y +345));

    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 275));
    $wclient_response  = str_replace("\n", " ", $muvi->wclient_response);
    $CI->fpdf->MultiCell(476, 11, substr($wclient_response,0, 380));


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 332), "Summary of activities and behaviors during the Services/Description of the contact:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +373), ($cero_x +510), ($cero_y +373));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +384), ($cero_x +510), ($cero_y +384));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +395), ($cero_x +510), ($cero_y +395));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +406), ($cero_x +510), ($cero_y +406));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 336));
    $wsummary_activities  = str_replace("\n", " ", $muvi->wsummary_activities);
    $CI->fpdf->MultiCell(476, 11, substr($wsummary_activities,0, 380));



    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 393), "Specific interventions used:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +434), ($cero_x +510), ($cero_y +434));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +445), ($cero_x +510), ($cero_y +445));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +456), ($cero_x +510), ($cero_y +456));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +467), ($cero_x +510), ($cero_y +467));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 397));
    $wspecific_interven  = str_replace("\n", " ", $muvi->wspecific_interven);
    $CI->fpdf->MultiCell(476, 11, substr($wspecific_interven,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 454), "Goals/objectives addressed:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +495), ($cero_x +510), ($cero_y +495));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +506), ($cero_x +510), ($cero_y +506));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +517), ($cero_x +510), ($cero_y +517));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +528), ($cero_x +510), ($cero_y +528));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 458));
    $wgoals_objectives  = str_replace("\n", " ", $muvi->wgoals_objectives);
    $CI->fpdf->MultiCell(476, 11, substr($wgoals_objectives,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 515), "Progress or Lack of progress/outcomes of the contact:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +556), ($cero_x +510), ($cero_y +556));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +567), ($cero_x +510), ($cero_y +567));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +578), ($cero_x +510), ($cero_y +578));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +589), ($cero_x +510), ($cero_y +589));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 519));
    $wprogress_lack_progress  = str_replace("\n", " ", $muvi->wprogress_lack_progress);
    $CI->fpdf->MultiCell(476, 11, substr($wprogress_lack_progress,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 576), "Goal focus/plan for next session:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +617), ($cero_x +510), ($cero_y +617));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +628), ($cero_x +510), ($cero_y +628));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +639), ($cero_x +510), ($cero_y +639));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +650), ($cero_x +510), ($cero_y +650));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 580));
    $wgoal_focus  = str_replace("\n", " ", $muvi->wgoal_focus);
    $CI->fpdf->MultiCell(476, 11, substr($wgoal_focus,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 682), "Therapist Signature:");
    $CI->fpdf->Line(($cero_x +130), ($cero_y +708), ($cero_x +250), ($cero_y +708));


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 115), ($y + 690), $us1_user->first_name.' '.$us1_user->last_name);
    if (isset($muvi->clinician_signature) AND $muvi->clinician_signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$muvi->clinician_signature;
        $CI->fpdf->Image( $img_path, ($x + 130), ($y + 630), 0, 50);
    }

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 311), ($y + 690), "Credential");
    $CI->fpdf->Line(($cero_x +307), ($cero_y +708), ($cero_x +395), ($cero_y +708));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 290), ($y + 680), $visit_user->description);


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 447), ($y + 690), "Date");
    $CI->fpdf->Line(($cero_x +435), ($cero_y +708), ($cero_x +510), ($cero_y +708));
    $pdf->SetFont('Courier', '', 8);
    if (isset($muvi->clinician_signature) AND $muvi->clinician_signature != "") {
        // $CI->fpdf->Text(($x + 432), ($y + 680), standard_date(mysql_to_unix($muvi->clinician_signed_date)));
        $CI->fpdf->Text(($x + 432), ($y + 680), standard_date(mysql_to_unix($visit_log->visit_date_time)));
    }


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 742), "Supervisor Signature:");
    $CI->fpdf->Line(($cero_x +130), ($cero_y +768), ($cero_x +250), ($cero_y +768));

    $pdf->SetFont('Arial', 'B', 8);
    if (!empty($supervisor_signed_by)) {
        $CI->fpdf->Text(($x + 115), ($y + 750), @$supervisor_signed_by->first_name.' '.@$supervisor_signed_by->last_name);
    }
    $CI->fpdf->Text(($x + 115), ($y + 750), '');

    if (isset($muvi->wsuperv_signature) AND $muvi->wsuperv_signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$muvi->wsuperv_signature;
        $CI->fpdf->Image( $img_path, ($x + 130), ($y + 690), 0, 50);
    }

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 311), ($y + 750), "Credential");
    $CI->fpdf->Line(($cero_x +310), ($cero_y +768), ($cero_x +390), ($cero_y +768));
    $pdf->SetFont('Courier', '', 8);
    if (!empty($supervisor_signed_by)) {
        $CI->fpdf->Text(($x + 290), ($y + 740), @$supervisor_signed_by->description);
    }

    $CI->fpdf->Text(($x + 290), ($y + 740), '');


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 447), ($y + 750), "Date");
    $CI->fpdf->Line(($cero_x +435), ($cero_y +768), ($cero_x +510), ($cero_y +768));
    $pdf->SetFont('Courier', '', 8);
    if (isset($muvi->wsuperv_signature) AND $muvi->wsuperv_signature != "") {
        // $CI->fpdf->Text(($x + 432), ($y + 740), standard_date(mysql_to_unix($muvi->wsuperv_signed_date)));
        $CI->fpdf->Text(($x + 432), ($y + 740), standard_date(mysql_to_unix($visit_log->visit_date_time)));
    }

    $title_text = "Music Therapy Visit Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;

}

function muvi_class_pdf ($visit_log_id, $output ='F') {
    global $GL_VISIT;
    $CI =& get_instance();


    $CI->load->model('muvimdl');

    $visit_log = $CI->visitlogmdl->getById($visit_log_id);
    $visitlog = $visit_log;
    $agy_user_id = $visit_log->user_id;
    $us1_user = $CI->usermdl->getById($agy_user_id);
    $muvi = $CI->muvimdl->get($visit_log_id);
    $GL_VISIT = $muvi;

    $patient = $CI->patientmdl->getById($visit_log->patient_id);
    $medicaidInsurance = $CI->patientinsurancemdl->getMedicaidInsurance($visitlog->patient_id);
    // $visit_user = $CI->usagymdl->getByUsAgyId($visitlog->visit_user_id);
    // $superv_user = $CI->usagymdl->getByUsAgyId($visitlog->superv_user_id);
    $agency = $CI->agencymdl->getByAgencyId($patient->agency_id);
    $enable_visit = false;
    if (isset($agency->F3625_req_visit) AND $agency->F3625_req_visit == 1) {
        $enable_visit = true;
    }

    $print_3625 = true;
    // skip 3625 when print notes = 1
    if (array_key_exists("print_notes", $GLOBALS)) {
        global $pt_3625_visits, $last_3625_visit_log_id, $print_notes;
        if ($print_notes == 1) {
            $print_3625 = false;

            if ( (isset($muvi->upload_document_name) AND $muvi->upload_document_name != "")
                OR  (isset($muvi->upload_document_name2) AND $muvi->upload_document_name2 != "") ) {
                // when uploaded found document no need to print electronic version
            }else{
                $last_3625_visit_log_id = $visit_log_id;
                $pt_3625_visits[] = $visit_log_id;
            }

        }
    }

    if (!$print_3625 AND !$enable_visit) {
        return false;
    }

    $path_ticket = realpath("style/images/icon_enable_negro.gif");
    $label_font = "Arial";
    $data_font = "Courier";

    $__FONT['PDF']['SIZE'] = 9;
    $__FONT['PDF']['FORM_MEDIUM'] = 10;
    $__FONT['PDF']['FORM_SMALL'] = 9;
    $__FONT['PDF']['FORM_SMALL2'] = 8;
    $__FONT['PDF']['FORM_SMALL3'] = 6.5;
    $__FONT['PDF']['FORM_SMALL4'] = 9.5;
    $__FONT['PDF']['FORM_arial8'] = 9.5;


    $CI->load->library('fpdf');
    if(!defined('FPDF_FONTPATH'))
      define('FPDF_FONTPATH',$CI->config->item('fonts_path'));


    $total_page = 1;
    $CI->fpdf->Open();
    $pdf = $CI->fpdf;

    $pdf->AddPage();
    $con = 2.8346456692913384;
    $cero_x = 11;
    $cero_y = 2;
    $y = $pdf->GetY();
    $x = $pdf->GetX();

    $pdf->SetFont('Arial', 'B', 13);
    $CI->fpdf->Text(($x + 160), ($y + 30), "Music Therapy Visit Progress Note - CLASS");

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 72), "Patient Name:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +100), ($cero_x +223), ($cero_y +100));

    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 65), ($y + 72), $patient->first_name.' '.$patient->last_name);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 84), "Visit Date:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +112), ($cero_x +223), ($cero_y +112));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 63), ($y + 84), standard_date(mysql_to_unix($visitlog->visit_date_time)) );

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 268), ($y + 72), "Medicaid #:");
    $CI->fpdf->Line(($cero_x +330), ($cero_y +100), ($cero_x +384), ($cero_y +100));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 314), ($y + 72), $medicaidInsurance->ins_id);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 100), "Time In:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +128), ($cero_x +119), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 63), ($y + 100), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_in)));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 129), ($y + 100), "Time Out:");
    $CI->fpdf->Line(($cero_x +187), ($cero_y +128), ($cero_x +225), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 168), ($y + 100), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_out)));

    $date2 = strtotime(date("Y-m-d ").$visit_log->visited_time_out);
    $date1 = strtotime(date("Y-m-d ").$visit_log->visited_time_in);

    if(is_null($visit_log->visited_time_in)){
      $date1 = strtotime(date("Y-m-d ").$visit_log->visit_date_time);
      $date2 = strtotime(date("Y-m-d ").$visit_log->visit_date_time)+(45*60);
    }

    $visit_duration = floor(($date2 - $date1)/60);

    if($visit_duration < 0){
        $date2 = strtotime(date("Y-m-d ", mktime(0,0,0,date("m"),date("j")+1,date("Y") )).$visit_log->visited_time_out);
        $visit_duration = floor(($date2 - $date1)/60);
      //$visit_duration = 45;
      // $date2 = $date1+(45*60);
    }elseif($visit_duration==0){
      $visit_duration = '00';
    }


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 268), ($y + 100), "Duration:");
    $CI->fpdf->Line(($cero_x +324), ($cero_y +128), ($cero_x +360), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 307), ($y + 100), (string)$visit_duration);
    $CI->fpdf->Text(($x + 323), ($y + 100), "min");

    $agency_company_name = "";
    if ($agency->print_agency_or_contractor_on_notes == "contractor") {
        $agency_company_name = " - ".$visit_log->visit_contractor_name;
    }

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 115), "Therapist:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +143), ($cero_x +265), ($cero_y +143));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 63), ($y + 115), $visit_log->first_name ." ". $visit_log->last_name. "".$agency_company_name);
   
    if ($enable_visit) {

        $CI->fpdf->Line(($cero_x +25), ($cero_y +160), ($cero_x +550), ($cero_y +160));
        // $CI->fpdf->Line(($cero_x - 10), ($cero_y +170), ($cero_x +585), ($cero_y +170));
        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 151), "Activity:");
        $CI->fpdf->SetDrawColor(200);
        $CI->fpdf->Line(($cero_x +28), ($cero_y +198), ($cero_x +547), ($cero_y +198));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +212), ($cero_x +547), ($cero_y +212));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +226), ($cero_x +547), ($cero_y +226));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +240), ($cero_x +547), ($cero_y +240));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +256), ($cero_x +547), ($cero_y +256));
        $pdf->SetFont('Courier', '', 8);
        if (isset($muvi->activity) AND $muvi->activity != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $activity  = str_replace("\n", " ", $muvi->activity);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 156));
            $CI->fpdf->MultiCell(525, 14, substr($activity,0, 525));
        }


        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 251), "Affect:");

        $CI->fpdf->Line(($cero_x +28), ($cero_y +297), ($cero_x +547), ($cero_y +297));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +311), ($cero_x +547), ($cero_y +311));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +325), ($cero_x +547), ($cero_y +325));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +339), ($cero_x +547), ($cero_y +339));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +355), ($cero_x +547), ($cero_y +355));

        $pdf->SetFont('Courier', '', 8);
        if (isset($muvi->affect) AND $muvi->affect != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $affect  = str_replace("\n", " ", $muvi->affect);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 256));
            $CI->fpdf->MultiCell(525, 14, substr($affect,0, 525));
        }


        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 351), "Goals Addressed (Revisions of Goals and Objectives):");
        $CI->fpdf->Line(($cero_x +28), ($cero_y +396), ($cero_x +547), ($cero_y +396));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +410), ($cero_x +547), ($cero_y +410));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +424), ($cero_x +547), ($cero_y +424));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +438), ($cero_x +547), ($cero_y +438));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +454), ($cero_x +547), ($cero_y +454));
        $pdf->SetFont('Courier', '', 8);
        if (isset($muvi->goals) AND $muvi->goals != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $goals  = str_replace("\n", " ", $muvi->goals);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 356));
            $CI->fpdf->MultiCell(525, 14, substr($goals,0, 525));
        }

        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 451), "Treatment Provided:");
        $CI->fpdf->Line(($cero_x +28), ($cero_y +495), ($cero_x +547), ($cero_y +495));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +509), ($cero_x +547), ($cero_y +509));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +523), ($cero_x +547), ($cero_y +523));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +537), ($cero_x +547), ($cero_y +537));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +553), ($cero_x +547), ($cero_y +553));

        $pdf->SetFont('Courier', '', 8);
        if (isset($muvi->treat_provided) AND $muvi->treat_provided != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $treat_provided  = str_replace("\n", " ", $muvi->treat_provided);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 456));
            $CI->fpdf->MultiCell(525, 14, substr($treat_provided,0, 525));
        }

        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 551), "Client Response to Therapy:");
        $CI->fpdf->Line(($cero_x +28), ($cero_y +594), ($cero_x +547), ($cero_y +594));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +608), ($cero_x +547), ($cero_y +608));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +622), ($cero_x +547), ($cero_y +622));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +636), ($cero_x +547), ($cero_y +636));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +652), ($cero_x +547), ($cero_y +652));

        $pdf->SetFont('Courier', '', 8);
        if (isset($muvi->client_response) AND $muvi->client_response != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $client_response  = str_replace("\n", " ", $muvi->client_response);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 556));
            $CI->fpdf->MultiCell(525, 14, substr($client_response,0, 525));
        }


        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 22), ($y + 670), "Participant/Family Signature:");
        if (isset($visit_log->signature) AND $visit_log->signature != "") {
            $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$visit_log->signature;
            $CI->fpdf->Image( $img_path, ($x + 150), ($y + 640), 60);
        }
        $CI->fpdf->Line(($cero_x +153), ($cero_y +698), ($cero_x +350), ($cero_y +698));
        $CI->fpdf->Text(($x + 355), ($y + 670), "Date:");
        if (isset($visit_log->signature) AND $visit_log->signature != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            // $CI->fpdf->Text(($x + 355 + 30), ($y + 670), standard_date(mysql_to_unix($muvi->pt_signed_date)));
            $CI->fpdf->Text(($x + 355 + 30), ($y + 670), standard_date(mysql_to_unix($visit_log->visit_date_time)));
            $pdf->SetFont('Arial', 'B', 8);
        }
        $CI->fpdf->Line(($cero_x +397), ($cero_y +698), ($cero_x +490), ($cero_y +698));

        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 22), ($y + 720),  "Therapist Signature:");
        if (isset($muvi->clinician_signature) AND $muvi->clinician_signature != "") {
            $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$muvi->clinician_signature;
            $CI->fpdf->Image( $img_path, ($x + 115), ($y + 690), 60);
            $pdf->SetFont('Arial', '', 8);
            $CI->fpdf->Text(($x + 122), ($y + 732),  $us1_user->first_name.' '.$us1_user->last_name);
            $pdf->SetFont('Arial', 'B', 8);
        }
        $CI->fpdf->Line(($cero_x +120), ($cero_y +748), ($cero_x +350), ($cero_y +748));
        $CI->fpdf->Text(($x + 355), ($y + 720), "Date:");
        if (isset($muvi->clinician_signature) AND $muvi->clinician_signature != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            // $CI->fpdf->Text(($x + 355 + 30), ($y + 720), standard_date(mysql_to_unix($muvi->clinician_signed_date)));
            $CI->fpdf->Text(($x + 355 + 30), ($y + 720), standard_date(mysql_to_unix($visit_log->visit_date_time)));
            $pdf->SetFont('Arial', 'B', 8);
        }
        $CI->fpdf->Line(($cero_x +397), ($cero_y +748), ($cero_x +490), ($cero_y +748));
    }

    if ($print_3625) {
        form3625_pdf($visit_log_id, "M");
    }

    $title_text = "Music Therapy Visit Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    if ($print_3625) {
        $title_text = "Music Therapy Visit and Form 3625 Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    }
    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;

}

function muvi_pdf ($visit_log_id, $output ='F') {
    global $GL_VISIT;

    $CI =& get_instance();

    $CI->load->model('muvimdl');

    $visit_log = $CI->visitlogmdl->getById($visit_log_id);
    $visitlog = $visit_log;
    $muvi = $CI->muvimdl->get($visit_log_id);

    if (isset($muvi->gov_program) AND $muvi->gov_program) {
    } else {
      $patient = $CI->patientmdl->getById($visit_log->patient_id);
      @$muvi->gov_program = $patient->gov_program;
    }

    if (isset($muvi->gov_program) AND $muvi->gov_program == 'Y-Waiver') {
      $filename = muvi_y_waiver_pdf($visit_log_id, $output);
      return $filename;
    }
    elseif (isset($muvi->gov_program) AND $muvi->gov_program == 'CLASS') {
      $filename = muvi_class_pdf($visit_log_id, $output);
      return $filename;
    }

    $GL_VISIT = $muvi;

    $agy_user_id = $visit_log->user_id;
    $us1_user = $CI->usermdl->getById($agy_user_id);

    $patient = $CI->patientmdl->getById($visit_log->patient_id);

    $path_ticket = realpath("style/images/icon_enable_negro.gif");
    $label_font = "Arial";
    $data_font = "Courier";

    $__FONT['PDF']['SIZE'] = 9;
    $__FONT['PDF']['FORM_MEDIUM'] = 10;
    $__FONT['PDF']['FORM_SMALL'] = 9;
    $__FONT['PDF']['FORM_SMALL2'] = 8;
    $__FONT['PDF']['FORM_SMALL3'] = 6.5;
    $__FONT['PDF']['FORM_SMALL4'] = 9.5;
    $__FONT['PDF']['FORM_arial8'] = 9.5;


    $CI->load->library('fpdf');
    if(!defined('FPDF_FONTPATH'))
      define('FPDF_FONTPATH',$CI->config->item('fonts_path'));
    $total_page = 2;
    $CI->fpdf->Open();
    $pdf = $CI->fpdf;
    $pdf->AddPage();
    $con = 2.8346456692913384;
    $cero_x = 11;
    $cero_y = 2;
    $y = $pdf->GetY();
    $x = $pdf->GetX();

    $pdf->SetFont('Arial', 'B', 30);
    $CI->fpdf->Text(($x + 150), ($y + 72), "Progress Notes");
    $CI->fpdf->Text(($x + 144), ($y + 76), "______________");

    $pdf->SetFont('Arial', 'B', 20);
    $CI->fpdf->Text(($x + 208), ($y + 120), "Private");

    // $pdf->SetFont('Arial', 'B', 10);
    // $CI->fpdf->Text(($x + 210), ($y + 150), "(please circle one above)");

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 175), "Participant name:");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +205), ($cero_x +390), ($cero_y +205));
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 75), ($y + 175), $patient->first_name." ".$patient->last_name);

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 205), "Date:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 27), ($y + 205), standard_date(mysql_to_unix($visit_log->visited_date)));
    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Line(($cero_x +35), ($cero_y +233), ($cero_x +490), ($cero_y +233));
    $CI->fpdf->Text(($x - 7), ($y + 235), "Time of start:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 57), ($y + 235), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_in)));
    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Line(($cero_x +70), ($cero_y +263), ($cero_x +490), ($cero_y +263));
    $CI->fpdf->Text(($x - 7), ($y + 265), "Time of finish:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 57), ($y + 265), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_out)));
    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Line(($cero_x +74), ($cero_y +293), ($cero_x +490), ($cero_y +293));

    $dateStart = new DateTime($visit_log->visited_date . " " . $visit_log->visited_time_in);
    $dateEnd   = new DateTime($visit_log->visited_date . " " . $visit_log->visited_time_out);
    $dateDiff  = $dateStart->diff($dateEnd);

    $CI->fpdf->Text(($x - 7), ($y + 295), "Total time:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 57), ($y + 295), $dateDiff->format("%H:%I:%S"));
    $pdf->SetFont('Arial', 'B', 9);

    $CI->fpdf->Line(($cero_x +60), ($cero_y +323), ($cero_x +490), ($cero_y +323));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +353), ($cero_x +490), ($cero_y +353));

    $CI->fpdf->Text(($x - 7), ($y + 350), "Activity:");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +379), ($cero_x +46), ($cero_y +379));

    $pdf->SetFont('Arial', 'B', 11);
    // $CI->fpdf->Text(($x + 60), ($y + 371), "Myofascial release for left forearm. Swedish massage");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +403), ($cero_x +490), ($cero_y +403));

    $CI->fpdf->Line(($cero_x +10), ($cero_y +433), ($cero_x +490), ($cero_y +433));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +463), ($cero_x +490), ($cero_y +463));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +493), ($cero_x +490), ($cero_y +493));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +523), ($cero_x +490), ($cero_y +523));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +553), ($cero_x +490), ($cero_y +553));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +583), ($cero_x +490), ($cero_y +583));

    if (isset($muvi->activity) AND $muvi->activity != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        $activity  = str_replace("\n", " ", $muvi->activity);
        $CI->fpdf->SetXY( ($x + 3) , ($y + 355));
        $CI->fpdf->MultiCell(480, 30, substr($activity,0, 550));
    }

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 585), "Affect:");
    $CI->fpdf->Line(($cero_x +43), ($cero_y +612), ($cero_x +490), ($cero_y +612));
    $pdf->SetFont('Arial', 'B', 11);
    if (isset($muvi->affect) AND $muvi->affect != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        $affect  = str_replace("\n", " ", $muvi->affect);
        $CI->fpdf->SetXY( ($x + 22) , ($y + 575));
        $CI->fpdf->MultiCell(480, 12, substr($affect,0, 170));
    }
    // $CI->fpdf->Text(($x + 26), ($y + 582), "Client relaxed very well. Left wrist deviation to the leftimproved from 30 degrees deviation to only");
    // $CI->fpdf->Text(($x + 26), ($y + 595), "5 degrees deviation from center. Left wrist extension improved from 98 degrees to 180 degrees.");

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 615), "Goals Addressed:");
    $pdf->SetFont('Arial', 'B', 11);
    // $CI->fpdf->Text(($x + 85), ($y + 611), "Shoulders were of even height.");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +643), ($cero_x +490), ($cero_y +643));
    $pdf->SetFont('Arial', 'B', 11);
    // $CI->fpdf->Text(($x + 25), ($y + 643), "ROM of wrist, relaxation");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +673), ($cero_x +490), ($cero_y +673));
    if (isset($muvi->goals) AND $muvi->goals != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        $goals  = str_replace("\n", " ", $muvi->goals);
        $CI->fpdf->SetXY( ($x + 3) , ($y + 595));
        $CI->fpdf->MultiCell(480, 30, '             '.substr($goals,0, 150));
    }

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 695), "Participant/Gurdian Signature:");
    if (isset($visit_log->signature) AND $visit_log->signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$visit_log->signature;
        $CI->fpdf->Image( $img_path, ($x + 127), ($y + 652), 130);
    }
    $CI->fpdf->Line(($cero_x +145), ($cero_y +723), ($cero_x +370), ($cero_y +723));
    $CI->fpdf->Text(($x + 355), ($y + 695), "Date:");
    if (isset($visit_log->signature) AND $visit_log->signature != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        // $CI->fpdf->Text(($x + 355 + 30), ($y + 695), standard_date(mysql_to_unix($muvi->pt_signed_date)));
        $CI->fpdf->Text(($x + 355 + 30), ($y + 695), standard_date(mysql_to_unix($visit_log->visit_date_time)));
        $pdf->SetFont('Arial', 'B', 9);
    }
    $CI->fpdf->Line(($cero_x +397), ($cero_y +723), ($cero_x +490), ($cero_y +723));

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 745),  "Therapist Signature:");
    if (isset($muvi->clinician_signature) AND $muvi->clinician_signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$muvi->clinician_signature;
        $CI->fpdf->Image( $img_path, ($x + 127), ($y + 702), 130);
    }
    $CI->fpdf->Line(($cero_x +102), ($cero_y +773), ($cero_x +370), ($cero_y +773));
    $CI->fpdf->Text(($x + 355), ($y + 745), "Date:");
    if (isset($muvi->clinician_signature) AND $muvi->clinician_signature != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        // $CI->fpdf->Text(($x + 355 + 30), ($y + 745), standard_date(mysql_to_unix($muvi->clinician_signed_date)));
        $CI->fpdf->Text(($x + 355 + 30), ($y + 745), standard_date(mysql_to_unix($visit_log->visit_date_time)));
        $pdf->SetFont('Arial', 'B', 9);
    }
    $CI->fpdf->Line(($cero_x +397), ($cero_y +773), ($cero_x +490), ($cero_y +773));


    $title_text = "Music Therapy Visit Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;

}

function commNotePdfPage ( $__FONT, $data) {
    $CI =& get_instance();

    $CI->fpdf = new fpdf;

    $cero_x = 11;
    $cero_y = 2;
    $CI->fpdf->Open();
    $CI->fpdf->AddPage();

    $CI->fpdf->SetDrawColor(130, 100);
    //$CI->fpdf->SetFont('Arial','B',$__FONT['PDF']['FORM_MEDIUM']);
    $CI->fpdf->SetFont('Arial','B',13);
    $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 12 ), $data['agency_name']); // agency name

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL3']);
    $CI->fpdf->Text(( $cero_x + 0),( $cero_y + 20 ),"Licensed and Certified Home Health Agency");

    $CI->fpdf->Rect(8,25, 577, 760);

    //$CI->fpdf->SetFont('Arial', 'B', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->SetFont('Arial', 'B', 13);
    $CI->fpdf->Text(220, 38, "COMMUNICATION NOTE");
    //$CI->fpdf->Text(460, 38, "Order Date   " . standard_date(mysql_to_unix($doctor_order->order_date)));

    $CI->fpdf->Line(8 , 42.5, 585, 42.5);

    $CI->fpdf->SetFont('Arial','',$__FONT['PDF']['FORM_SMALL']-1);
    $address = $data['agency_address'].", ".$data['city'].", ".$data['state_name_short'].", ".$data['zip'];
    $CI->fpdf->Text(11, 800, $address);
    $CI->fpdf->Text(350, 800, "Phone: " . $data['agency_phone_cell']);
    $CI->fpdf->Text(470, 800, "Fax: " . $data['agency_fax']);
    $CI->fpdf->Text(230, 820, "HomeHealthSoft Inc.");
}

function comm_note_pdf ($msg_id, $output ='F') {
    $CI =& get_instance();
    // getting data
    $data = $CI->messagemdl->getComNoteByID($msg_id);
    // $data = $CI->messagemdl->getPatnoteByID($note_id);
    //print_r($data);exit;
    $patient = array();

    if (isset($data['patient_id']) AND $data['patient_id'] != '') {
        $patient = $CI->patientmdl->getById($data['patient_id']);
    }

    $CI->load->model('usermessagemdl');
    $data['msg_users'] = implode("; ", $CI->usermessagemdl->getByMessageId($msg_id));


    $path_ticket = realpath("style/images/icon_enable_negro.gif");

    $__FONT['PDF']['SIZE'] = 12;
    $__FONT['PDF']['FORM_MEDIUM'] = 11;
    //$__FONT['PDF']['FORM_SMALL'] = 9;
    $__FONT['PDF']['FORM_SMALL'] = 12;
    $__FONT['PDF']['FORM_SMALL2'] = 10;
    $__FONT['PDF']['FORM_SMALL3'] = 7.5;
    $__FONT['PDF']['FORM_SMALL4'] = 10.5;
    $__FONT['PDF']['FORM_arial8'] = 10.5;

    $CI->load->library('fpdf');
    if(!defined('FPDF_FONTPATH'))
    define('FPDF_FONTPATH',$CI->config->item('fonts_path'));



    commNotePdfPage($__FONT, $data);

    // Creation Date
    $CI->fpdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(30, 55+5, "Date: ");

    $CI->fpdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);
    //$CI->fpdf->Text(150, 55+5, standard_date(mysql_to_unix($data['creation_date_time'])));
    $CI->fpdf->Text(150, 55+5, standard_date(mysql_to_unix($data['msg_date'])));

    // Patient Name
    $CI->fpdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(30, 55+30, "Patient Name: ");

    $CI->fpdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(150, 55+30, $data["patient_name"]);


    // from
    $CI->fpdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(30, 70+30+10, "From: ");

    $CI->fpdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(150, 70+30+10, $data['user_name']);

    // To
    $CI->fpdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(30, 85+30+20, "To: ");

    $CI->fpdf->SetFont('Arial','', $__FONT['PDF']['FORM_SMALL']);
    $cero_y = 85+30+20;
    if(strlen($data["msg_users"]) > 69){

        $newtextArr = explode("||", wordwrap($data["msg_users"], 69, "||"));
        foreach($newtextArr as $userText){
            $CI->fpdf->Text(150, $cero_y, $userText);

            $cero_y += 15;
        }
        $cero_y -= 15;
    }else{
        $CI->fpdf->Text(150, $cero_y, $data["msg_users"]);
    }

    $cero_y += 25;
    //$plus_y = $cero_y-(85+30+20);

    // order by
    $CI->fpdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(30, $cero_y, "ESSENCE OF THIS COMMUNICATION: ");

    $eje_y = $cero_y+20;
    $CI->fpdf->SetFont('Courier', '', $__FONT['PDF']['FORM_SMALL'] );

    $lines = explode("\n", wordwrap($data["msg_text"], 75, "\n"));
    foreach ($lines as $substring) {

        //$CI->fpdf->Text(150, $eje_y, $substring);
        $CI->fpdf->Text(30, $eje_y, $substring);
        $CI->fpdf->SetLineWidth( 0.5 );
        $CI->fpdf->Line(30, $eje_y+4, 554, $eje_y+4);

        $eje_y += 15;

        if ($eje_y > 660) {
            commNotePdfPage($__FONT, $data);

            $CI->fpdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
            $CI->fpdf->Text(30, 55, "Order Description: ");

            $CI->fpdf->SetFont('Courier', '', $__FONT['PDF']['FORM_SMALL'] );
            $eje_y = 55+30;
        }
    }

    if ($eje_y >= 675) {
        commNotePdfPage($__FONT, $data);
    }

    $CI->fpdf->SetFont('Arial','B', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(30, 700-20,  "Clinician Signature:");
    $CI->fpdf->Text(125, 700-20, "____________________________________________            Date: _____________");

    $CI->fpdf->SetFont('Courier','',$__FONT['PDF']['FORM_MEDIUM']);
    $CI->fpdf->Text(130+15, 700-20, $data["user_name"]);
    $CI->fpdf->Text(130+15, 700-8, "ELECTRONICALLY SIGNED BY ");
    $CI->fpdf->Text(500, 700-20, standard_date(mysql_to_unix($data['msg_date'])));


    // //////////////////////
    $title_text = 'comm note '.$msg_id;
    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;

}

function mavi_y_waiver_pdf ($visit_log_id, $output ='F') {
    global $GL_VISIT;

    $CI =& get_instance();

    $CI->load->model('mavimdl');

    $visit_log = $CI->visitlogmdl->getById($visit_log_id);
    $visitlog = $visit_log;
    $agy_user_id = $visit_log->user_id;
    $us1_user = $CI->usermdl->getById($agy_user_id);
    $mavi = $CI->mavimdl->get($visit_log_id);
    $GL_VISIT = $mavi;

    $patient = $CI->patientmdl->getById($visit_log->patient_id);

    $visit_user = $CI->usagymdl->getByUsAgyId($visitlog->visit_user_id);
    if ($visitlog->visit_discipline_id) {
        $user_discipline = $CI->disciplinemdl->getById($visitlog->visit_discipline_id);
        $visit_user = (object) array_merge((array)$visit_user, (array)$user_discipline );
    }

    // $superv_user = $CI->usagymdl->getByUsAgyId($visitlog->superv_user_id);
    $supervisor_signed_by = array();
    if ($mavi->wsuperv_signed_by) {
        $supervisor_signed_by = $CI->usagymdl->getByUsAgyId($mavi->wsuperv_signed_by);
    }
    $agency = $CI->agencymdl->getByAgencyId($patient->agency_id);
    // print_r($agency);exit();
    $medicaidInsurance = $CI->patientinsurancemdl->getMedicaidInsurance($visitlog->patient_id);

    $path_ticket = realpath("style/images/icon_enable_negro.gif");
    $label_font = "Arial";
    $data_font = "Courier";

    $__FONT['PDF']['SIZE'] = 9;
    $__FONT['PDF']['FORM_MEDIUM'] = 10;
    $__FONT['PDF']['FORM_SMALL'] = 9;
    $__FONT['PDF']['FORM_SMALL2'] = 8;
    $__FONT['PDF']['FORM_SMALL3'] = 6.5;
    $__FONT['PDF']['FORM_SMALL4'] = 9.5;
    $__FONT['PDF']['FORM_arial8'] = 9.5;

    

    $CI->load->library('fpdf');
    if(!defined('FPDF_FONTPATH'))
      define('FPDF_FONTPATH',$CI->config->item('fonts_path'));
    $total_page = 1;
    $CI->fpdf->Open();
    $pdf = $CI->fpdf;
    $pdf->AddPage();
    $con = 2.8346456692913384;
    $cero_x = 11;
    $cero_y = 2;
    $y = $pdf->GetY();
    $x = $pdf->GetX();
    $agency_company_name = "";
    if ($agency->print_agency_or_contractor_on_notes == "contractor") {
        $agency_company_name = $visit_log->visit_contractor_name;
        $pdf->SetFont('Arial', 'B', 11);
        $CI->fpdf->Text(($x + 160), ($y + 5), $agency_company_name);
        $pdf->SetFont('Arial', 'B', 10);
        $CI->fpdf->Text(($x + 115), ($y + 25), "Massage Therapy Progress Notes - [YES-Waiver]");
    } else {
        $pdf->SetFont('Arial', 'B', 11);
        $CI->fpdf->Text(($x + 115), ($y + 15), "Massage Therapy Progress Notes - [YES-Waiver]");
    }
    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 50), "County:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +78), ($cero_x +155), ($cero_y +78));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 50), $patient->city);

    $pdf->SetFont('Arial', 'B', 8);
    // $CI->fpdf->Text(($x + 360), ($y + 60), "Program Name:");
    $CI->fpdf->Text(($x + 200), ($y + 50), "Program Name:");
    $CI->fpdf->Line(($cero_x +447-160), ($cero_y +78), ($cero_x +487-160), ($cero_y +78));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 430-160), ($y + 50), $mavi->gov_program);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 50), "Medicaid #:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +78), ($cero_x +487), ($cero_y +78));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 430), ($y + 50), @$medicaidInsurance->ins_id);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 62), "Pt. Name:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +90), ($cero_x +150), ($cero_y +90));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 62), $patient->first_name.' '.$patient->last_name);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 74), "Visit Date:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +102), ($cero_x +139), ($cero_y +102));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 74), standard_date(mysql_to_unix($visit_log->visited_date)) );

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 64), "Case #:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +90), ($cero_x +487), ($cero_y +90));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 430), ($y + 62), @$patient->medical_rec_nbr);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 74), "Client DOB:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +102), ($cero_x +498), ($cero_y +102));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 430), ($y + 74), standard_date(mysql_to_unix($patient->date_birth)));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 87), "Time in:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +115), ($cero_x +130), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 87), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_in)));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 150), ($y + 87), "Time Out:");
    $CI->fpdf->Line(($cero_x +206), ($cero_y +115), ($cero_x +246), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 189), ($y + 87), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_out)));

    $date2 = strtotime(date("Y-m-d ").$visit_log->visited_time_out);
    $date1 = strtotime(date("Y-m-d ").$visit_log->visited_time_in);

    if(is_null($visit_log->visited_time_in)){
      $date1 = strtotime(date("Y-m-d ").$visit_log->visit_date_time);
      $date2 = strtotime(date("Y-m-d ").$visit_log->visit_date_time)+(45*60);
    }

    $visit_duration = floor(($date2 - $date1)/60);

    if($visit_duration < 0){
        $date2 = strtotime(date("Y-m-d ", mktime(0,0,0,date("m"),date("j")+1,date("Y") )).$visit_log->visited_time_out);
        $visit_duration = floor(($date2 - $date1)/60);
      //$visit_duration = 45;
      // $date2 = $date1+(45*60);
    }elseif($visit_duration==0){
      $visit_duration = '00';
    }

    $CI =& get_instance();
	$CI->load->model('spvisitunitmdl');
    $units = $CI->spvisitunitmdl->get('Y-Waiver', $visit_duration);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 260), ($y + 87), "Total time:");
    $CI->fpdf->Line(($cero_x +319), ($cero_y +115), ($cero_x +332), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 302), ($y + 87), (string)$visit_duration);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 87), "Unit Amount:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +115), ($cero_x +460), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    if ($agency->F3625_measure_unit) {
        $CI->fpdf->Text(($x + 430), ($y + 87), ($visit_duration/(60/$agency->F3625_measure_unit)));
    } else {
        $CI->fpdf->Text(($x + 430), ($y + 87), (string) number_format($units, 0));
    }


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 100), "Therapist:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +128), ($cero_x +270), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 100), $visit_log->first_name ." ". $visit_log->last_name);

    $CI->fpdf->Line(($cero_x +30), ($cero_y +135), ($cero_x +520), ($cero_y +135));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 123), "Location of therapy:");
    $CI->fpdf->Line(($cero_x +116), ($cero_y +151), ($cero_x +230), ($cero_y +151));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 22 + 79), ($y + 123), substr($mavi->wlocation_therapy, 0, 30));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 250), ($y + 123), "Persons present:");
    $CI->fpdf->Line(($cero_x +334), ($cero_y +151), ($cero_x +510), ($cero_y +151));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 250 + 68), ($y + 123), substr($mavi->wpersons_present, 0, 35));

    //470 words
    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 138), "Activity/Description of Contact:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +179), ($cero_x +510), ($cero_y +179));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +190), ($cero_x +510), ($cero_y +190));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +201), ($cero_x +510), ($cero_y +201));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +212), ($cero_x +510), ($cero_y +212));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +223), ($cero_x +510), ($cero_y +223));

    $pdf->SetFont('Courier', '', 8);
    $activity  = str_replace("\n", " ", $mavi->wactivity_descrip);
    $CI->fpdf->SetXY( ($x + 20) , ($y + 142));
    $CI->fpdf->MultiCell(476, 11, ''.substr($activity,0, 470));

    //380 words
    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 210), "Specific Skills received and method used to train client in skills:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +251), ($cero_x +510), ($cero_y +251));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +262), ($cero_x +510), ($cero_y +262));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +273), ($cero_x +510), ($cero_y +273));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +284), ($cero_x +510), ($cero_y +284));

    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 214));
    $wspecific_skills  = str_replace("\n", " ", $mavi->wspecific_skills);
    $CI->fpdf->MultiCell(476, 11, substr($wspecific_skills,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 271), "Client's response to service being provided(observations):");
     $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +312), ($cero_x +510), ($cero_y +312));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +323), ($cero_x +510), ($cero_y +323));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +334), ($cero_x +510), ($cero_y +334));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +345), ($cero_x +510), ($cero_y +345));

    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 275));
    $wclient_response  = str_replace("\n", " ", $mavi->wclient_response);
    $CI->fpdf->MultiCell(476, 11, substr($wclient_response,0, 380));


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 332), "Summary of activities and behaviors during the Services/Description of the contact:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +373), ($cero_x +510), ($cero_y +373));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +384), ($cero_x +510), ($cero_y +384));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +395), ($cero_x +510), ($cero_y +395));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +406), ($cero_x +510), ($cero_y +406));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 336));
    $wsummary_activities  = str_replace("\n", " ", $mavi->wsummary_activities);
    $CI->fpdf->MultiCell(476, 11, substr($wsummary_activities,0, 380));



    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 393), "Specific interventions used:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +434), ($cero_x +510), ($cero_y +434));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +445), ($cero_x +510), ($cero_y +445));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +456), ($cero_x +510), ($cero_y +456));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +467), ($cero_x +510), ($cero_y +467));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 397));
    $wspecific_interven  = str_replace("\n", " ", $mavi->wspecific_interven);
    $CI->fpdf->MultiCell(476, 11, substr($wspecific_interven,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 454), "Goals/objectives addressed:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +495), ($cero_x +510), ($cero_y +495));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +506), ($cero_x +510), ($cero_y +506));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +517), ($cero_x +510), ($cero_y +517));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +528), ($cero_x +510), ($cero_y +528));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 458));
    $wgoals_objectives  = str_replace("\n", " ", $mavi->wgoals_objectives);
    $CI->fpdf->MultiCell(476, 11, substr($wgoals_objectives,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 515), "Progress or Lack of progress/outcomes of the contact:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +556), ($cero_x +510), ($cero_y +556));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +567), ($cero_x +510), ($cero_y +567));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +578), ($cero_x +510), ($cero_y +578));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +589), ($cero_x +510), ($cero_y +589));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 519));
    $wprogress_lack_progress  = str_replace("\n", " ", $mavi->wprogress_lack_progress);
    $CI->fpdf->MultiCell(476, 11, substr($wprogress_lack_progress,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 576), "Goal focus/plan for next session:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +617), ($cero_x +510), ($cero_y +617));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +628), ($cero_x +510), ($cero_y +628));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +639), ($cero_x +510), ($cero_y +639));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +650), ($cero_x +510), ($cero_y +650));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 580));
    $wgoal_focus  = str_replace("\n", " ", $mavi->wgoal_focus);
    $CI->fpdf->MultiCell(476, 11, substr($wgoal_focus,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 682), "Therapist Signature:");
    $CI->fpdf->Line(($cero_x +130), ($cero_y +708), ($cero_x +250), ($cero_y +708));


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 115), ($y + 690), $us1_user->first_name.' '.$us1_user->last_name);
    if (isset($mavi->clinician_signature) AND $mavi->clinician_signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$mavi->clinician_signature;
        $CI->fpdf->Image( $img_path, ($x + 130), ($y + 630), 0, 50);
    }

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 311), ($y + 690), "Credential");
    $CI->fpdf->Line(($cero_x +307), ($cero_y +708), ($cero_x +395), ($cero_y +708));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 290), ($y + 680), $visit_user->description);


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 447), ($y + 690), "Date");
    $CI->fpdf->Line(($cero_x +435), ($cero_y +708), ($cero_x +510), ($cero_y +708));
    $pdf->SetFont('Courier', '', 8);
    if (isset($mavi->clinician_signature) AND $mavi->clinician_signature != "") {
        // $CI->fpdf->Text(($x + 432), ($y + 680), standard_date(mysql_to_unix($mavi->clinician_signed_date)));
        $CI->fpdf->Text(($x + 432), ($y + 680), standard_date(mysql_to_unix($visit_log->visit_date_time)));
    }


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 742), "Supervisor Signature:");
    $CI->fpdf->Line(($cero_x +130), ($cero_y +768), ($cero_x +250), ($cero_y +768));

    $pdf->SetFont('Arial', 'B', 8);
    if (!empty($supervisor_signed_by)) {
        $CI->fpdf->Text(($x + 115), ($y + 750), @$supervisor_signed_by->first_name.' '.@$supervisor_signed_by->last_name);
    }
    $CI->fpdf->Text(($x + 115), ($y + 750), '');

    if (isset($mavi->wsuperv_signature) AND $mavi->wsuperv_signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$mavi->wsuperv_signature;
        $CI->fpdf->Image( $img_path, ($x + 130), ($y + 690), 0, 50);
    }

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 311), ($y + 750), "Credential");
    $CI->fpdf->Line(($cero_x +310), ($cero_y +768), ($cero_x +390), ($cero_y +768));
    $pdf->SetFont('Courier', '', 8);
    if (!empty($supervisor_signed_by)) {
        $CI->fpdf->Text(($x + 290), ($y + 740), @$supervisor_signed_by->description);
    }

    $CI->fpdf->Text(($x + 290), ($y + 740), '');


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 447), ($y + 750), "Date");
    $CI->fpdf->Line(($cero_x +435), ($cero_y +768), ($cero_x +510), ($cero_y +768));
    $pdf->SetFont('Courier', '', 8);
    if (isset($mavi->wsuperv_signature) AND $mavi->wsuperv_signature != "") {
        // $CI->fpdf->Text(($x + 432), ($y + 740), standard_date(mysql_to_unix($mavi->wsuperv_signed_date)));
        $CI->fpdf->Text(($x + 432), ($y + 740), standard_date(mysql_to_unix($visit_log->visit_date_time)));
    }

    $title_text = "Massage Therapy Visit Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;

}

function mavi_class_pdf ($visit_log_id, $output ='F') {
    global $GL_VISIT;
    $CI =& get_instance();


    $CI->load->model('mavimdl');

    $visit_log = $CI->visitlogmdl->getById($visit_log_id);
    $visitlog = $visit_log;
    $agy_user_id = $visit_log->user_id;
    $us1_user = $CI->usermdl->getById($agy_user_id);
    $mavi = $CI->mavimdl->get($visit_log_id);
    $GL_VISIT = $mavi;

    $patient = $CI->patientmdl->getById($visit_log->patient_id);
    $medicaidInsurance = $CI->patientinsurancemdl->getMedicaidInsurance($visitlog->patient_id);
    // $visit_user = $CI->usagymdl->getByUsAgyId($visitlog->visit_user_id);
    // $superv_user = $CI->usagymdl->getByUsAgyId($visitlog->superv_user_id);
    $agency = $CI->agencymdl->getByAgencyId($patient->agency_id);
    $enable_visit = false;
    if (isset($agency->F3625_req_visit) AND $agency->F3625_req_visit == 1) {
        $enable_visit = true;
    }

    $print_3625 = true;
    // skip 3625 when print notes = 1
    if (array_key_exists("print_notes", $GLOBALS)) {
        global $pt_3625_visits, $last_3625_visit_log_id, $print_notes;
        if ($print_notes == 1) {
            $print_3625 = false;

            if ( (isset($mavi->upload_document_name) AND $mavi->upload_document_name != "")
                OR  (isset($mavi->upload_document_name2) AND $mavi->upload_document_name2 != "") ) {
                // when uploaded found document no need to print electronic version
            }else{
                $last_3625_visit_log_id = $visit_log_id;
                $pt_3625_visits[] = $visit_log_id;
            }

        }
    }

    if (!$print_3625 AND !$enable_visit) {
        return false;
    }

    $path_ticket = realpath("style/images/icon_enable_negro.gif");
    $label_font = "Arial";
    $data_font = "Courier";

    $__FONT['PDF']['SIZE'] = 9;
    $__FONT['PDF']['FORM_MEDIUM'] = 10;
    $__FONT['PDF']['FORM_SMALL'] = 9;
    $__FONT['PDF']['FORM_SMALL2'] = 8;
    $__FONT['PDF']['FORM_SMALL3'] = 6.5;
    $__FONT['PDF']['FORM_SMALL4'] = 9.5;
    $__FONT['PDF']['FORM_arial8'] = 9.5;


    $CI->load->library('fpdf');
    if(!defined('FPDF_FONTPATH'))
      define('FPDF_FONTPATH',$CI->config->item('fonts_path'));


    $total_page = 1;
    $CI->fpdf->Open();
    $pdf = $CI->fpdf;

    $pdf->AddPage();
    $con = 2.8346456692913384;
    $cero_x = 11;
    $cero_y = 2;
    $y = $pdf->GetY();
    $x = $pdf->GetX();

    $pdf->SetFont('Arial', 'B', 13);
    $CI->fpdf->Text(($x + 160), ($y + 30), "Massage Therapy Visit Progress Note - CLASS");

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 72), "Patient Name:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +100), ($cero_x +223), ($cero_y +100));

    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 65), ($y + 72), $patient->first_name.' '.$patient->last_name);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 84), "Visit Date:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +112), ($cero_x +223), ($cero_y +112));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 63), ($y + 84), standard_date(mysql_to_unix($visitlog->visit_date_time)) );

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 268), ($y + 72), "Medicaid #:");
    $CI->fpdf->Line(($cero_x +330), ($cero_y +100), ($cero_x +384), ($cero_y +100));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 314), ($y + 72), $medicaidInsurance->ins_id);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 100), "Time In:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +128), ($cero_x +119), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 63), ($y + 100), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_in)));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 129), ($y + 100), "Time Out:");
    $CI->fpdf->Line(($cero_x +187), ($cero_y +128), ($cero_x +225), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 168), ($y + 100), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_out)));

    $date2 = strtotime(date("Y-m-d ").$visit_log->visited_time_out);
    $date1 = strtotime(date("Y-m-d ").$visit_log->visited_time_in);

    if(is_null($visit_log->visited_time_in)){
      $date1 = strtotime(date("Y-m-d ").$visit_log->visit_date_time);
      $date2 = strtotime(date("Y-m-d ").$visit_log->visit_date_time)+(45*60);
    }

    $visit_duration = floor(($date2 - $date1)/60);

    if($visit_duration < 0){
        $date2 = strtotime(date("Y-m-d ", mktime(0,0,0,date("m"),date("j")+1,date("Y") )).$visit_log->visited_time_out);
        $visit_duration = floor(($date2 - $date1)/60);
      //$visit_duration = 45;
      // $date2 = $date1+(45*60);
    }elseif($visit_duration==0){
      $visit_duration = '00';
    }


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 268), ($y + 100), "Duration:");
    $CI->fpdf->Line(($cero_x +324), ($cero_y +128), ($cero_x +360), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 307), ($y + 100), (string)$visit_duration);
    $CI->fpdf->Text(($x + 323), ($y + 100), "min");

    $agency_company_name = "";
    if ($agency->print_agency_or_contractor_on_notes == "contractor") {
        $agency_company_name = " - ".$visit_log->visit_contractor_name;
    }

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 115), "Therapist:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +143), ($cero_x +265), ($cero_y +143));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 63), ($y + 115), $visit_log->first_name ." ". $visit_log->last_name. "".$agency_company_name);

    if ($enable_visit) {

        $CI->fpdf->Line(($cero_x +25), ($cero_y +160), ($cero_x +550), ($cero_y +160));
        // $CI->fpdf->Line(($cero_x - 10), ($cero_y +170), ($cero_x +585), ($cero_y +170));
        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 151), "Activity:");
        $CI->fpdf->SetDrawColor(200);
        $CI->fpdf->Line(($cero_x +28), ($cero_y +198), ($cero_x +547), ($cero_y +198));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +212), ($cero_x +547), ($cero_y +212));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +226), ($cero_x +547), ($cero_y +226));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +240), ($cero_x +547), ($cero_y +240));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +256), ($cero_x +547), ($cero_y +256));
        $pdf->SetFont('Courier', '', 8);
        if (isset($mavi->activity) AND $mavi->activity != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $activity  = str_replace("\n", " ", $mavi->activity);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 156));
            $CI->fpdf->MultiCell(525, 14, substr($activity,0, 525));
        }


        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 251), "Affect:");

        $CI->fpdf->Line(($cero_x +28), ($cero_y +297), ($cero_x +547), ($cero_y +297));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +311), ($cero_x +547), ($cero_y +311));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +325), ($cero_x +547), ($cero_y +325));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +339), ($cero_x +547), ($cero_y +339));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +355), ($cero_x +547), ($cero_y +355));

        $pdf->SetFont('Courier', '', 8);
        if (isset($mavi->affect) AND $mavi->affect != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $affect  = str_replace("\n", " ", $mavi->affect);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 256));
            $CI->fpdf->MultiCell(525, 14, substr($affect,0, 525));
        }


        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 351), "Goals Addressed (Revisions of Goals and Objectives):");
        $CI->fpdf->Line(($cero_x +28), ($cero_y +396), ($cero_x +547), ($cero_y +396));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +410), ($cero_x +547), ($cero_y +410));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +424), ($cero_x +547), ($cero_y +424));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +438), ($cero_x +547), ($cero_y +438));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +454), ($cero_x +547), ($cero_y +454));
        $pdf->SetFont('Courier', '', 8);
        if (isset($mavi->goals) AND $mavi->goals != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $goals  = str_replace("\n", " ", $mavi->goals);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 356));
            $CI->fpdf->MultiCell(525, 14, substr($goals,0, 525));
        }

        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 451), "Treatment Provided:");
        $CI->fpdf->Line(($cero_x +28), ($cero_y +495), ($cero_x +547), ($cero_y +495));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +509), ($cero_x +547), ($cero_y +509));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +523), ($cero_x +547), ($cero_y +523));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +537), ($cero_x +547), ($cero_y +537));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +553), ($cero_x +547), ($cero_y +553));

        $pdf->SetFont('Courier', '', 8);
        if (isset($mavi->treat_provided) AND $mavi->treat_provided != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $treat_provided  = str_replace("\n", " ", $mavi->treat_provided);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 456));
            $CI->fpdf->MultiCell(525, 14, substr($treat_provided,0, 525));
        }

        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 551), "Client Response to Therapy:");
        $CI->fpdf->Line(($cero_x +28), ($cero_y +594), ($cero_x +547), ($cero_y +594));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +608), ($cero_x +547), ($cero_y +608));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +622), ($cero_x +547), ($cero_y +622));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +636), ($cero_x +547), ($cero_y +636));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +652), ($cero_x +547), ($cero_y +652));

        $pdf->SetFont('Courier', '', 8);
        if (isset($mavi->client_response) AND $mavi->client_response != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $client_response  = str_replace("\n", " ", $mavi->client_response);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 556));
            $CI->fpdf->MultiCell(525, 14, substr($client_response,0, 525));
        }


        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 22), ($y + 670), "Participant/Family Signature:");
        if (isset($visit_log->signature) AND $visit_log->signature != "") {
            $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$visit_log->signature;
            $CI->fpdf->Image( $img_path, ($x + 150), ($y + 640), 60);
        }
        $CI->fpdf->Line(($cero_x +153), ($cero_y +698), ($cero_x +350), ($cero_y +698));
        $CI->fpdf->Text(($x + 355), ($y + 670), "Date:");
        if (isset($visit_log->signature) AND $visit_log->signature != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            // $CI->fpdf->Text(($x + 355 + 30), ($y + 670), standard_date(mysql_to_unix($mavi->pt_signed_date)));
            $CI->fpdf->Text(($x + 355 + 30), ($y + 670), standard_date(mysql_to_unix($visit_log->visit_date_time)));
            $pdf->SetFont('Arial', 'B', 8);
        }
        $CI->fpdf->Line(($cero_x +397), ($cero_y +698), ($cero_x +490), ($cero_y +698));

        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 22), ($y + 720),  "Therapist Signature:");
        if (isset($mavi->clinician_signature) AND $mavi->clinician_signature != "") {
            $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$mavi->clinician_signature;
            $CI->fpdf->Image( $img_path, ($x + 115), ($y + 690), 60);
            $pdf->SetFont('Arial', '', 8);
            $CI->fpdf->Text(($x + 122), ($y + 732),  $us1_user->first_name.' '.$us1_user->last_name);
            $pdf->SetFont('Arial', 'B', 8);
        }
        $CI->fpdf->Line(($cero_x +120), ($cero_y +748), ($cero_x +350), ($cero_y +748));
        $CI->fpdf->Text(($x + 355), ($y + 720), "Date:");
        if (isset($mavi->clinician_signature) AND $mavi->clinician_signature != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            // $CI->fpdf->Text(($x + 355 + 30), ($y + 720), standard_date(mysql_to_unix($mavi->clinician_signed_date)));
            $CI->fpdf->Text(($x + 355 + 30), ($y + 720), standard_date(mysql_to_unix($visit_log->visit_date_time)));
            $pdf->SetFont('Arial', 'B', 8);
        }
        $CI->fpdf->Line(($cero_x +397), ($cero_y +748), ($cero_x +490), ($cero_y +748));
    }

    if ($print_3625) {
        form3625_pdf($visit_log_id, "M");
    }

    $title_text = "Massage Therapy Visit Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    if ($print_3625) {
        $title_text = "Massage Therapy Visit and Form 3625 Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    }
    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;

}

function mavi_pdf ($visit_log_id, $output ='F') {
    global $GL_VISIT;

    $CI =& get_instance();

    $CI->load->model('mavimdl');

    $visit_log = $CI->visitlogmdl->getById($visit_log_id);
    $visitlog = $visit_log;
    $mavi = $CI->mavimdl->get($visit_log_id);

    if (isset($mavi->gov_program) AND $mavi->gov_program) {
    } else {
      $patient = $CI->patientmdl->getById($visit_log->patient_id);
      @$mavi->gov_program = $patient->gov_program;
    }

    if (isset($mavi->gov_program) AND $mavi->gov_program == 'Y-Waiver') {
      $filename = mavi_y_waiver_pdf($visit_log_id, $output);
      return $filename;
    }
    elseif (isset($mavi->gov_program) AND $mavi->gov_program == 'CLASS') {
      $filename = mavi_class_pdf($visit_log_id, $output);
      return $filename;
    }

    $GL_VISIT = $mavi;

    $agy_user_id = $visit_log->user_id;
    $us1_user = $CI->usermdl->getById($agy_user_id);

    $patient = $CI->patientmdl->getById($visit_log->patient_id);

    $path_ticket = realpath("style/images/icon_enable_negro.gif");
    $label_font = "Arial";
    $data_font = "Courier";

    $__FONT['PDF']['SIZE'] = 9;
    $__FONT['PDF']['FORM_MEDIUM'] = 10;
    $__FONT['PDF']['FORM_SMALL'] = 9;
    $__FONT['PDF']['FORM_SMALL2'] = 8;
    $__FONT['PDF']['FORM_SMALL3'] = 6.5;
    $__FONT['PDF']['FORM_SMALL4'] = 9.5;
    $__FONT['PDF']['FORM_arial8'] = 9.5;


    $CI->load->library('fpdf');
    if(!defined('FPDF_FONTPATH'))
      define('FPDF_FONTPATH',$CI->config->item('fonts_path'));
    $total_page = 2;
    $CI->fpdf->Open();
    $pdf = $CI->fpdf;
    $pdf->AddPage();
    $con = 2.8346456692913384;
    $cero_x = 11;
    $cero_y = 2;
    $y = $pdf->GetY();
    $x = $pdf->GetX();

    $pdf->SetFont('Arial', 'B', 30);
    $CI->fpdf->Text(($x + 150), ($y + 72), "Progress Notes");
    $CI->fpdf->Text(($x + 144), ($y + 76), "______________");

    $pdf->SetFont('Arial', 'B', 20);
    $CI->fpdf->Text(($x + 208), ($y + 120), "Private");

    // $pdf->SetFont('Arial', 'B', 10);
    // $CI->fpdf->Text(($x + 210), ($y + 150), "(please circle one above)");

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 175), "Participant name:");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +205), ($cero_x +390), ($cero_y +205));
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 75), ($y + 175), $patient->first_name." ".$patient->last_name);

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 205), "Date:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 27), ($y + 205), standard_date(mysql_to_unix($visit_log->visited_date)));
    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Line(($cero_x +35), ($cero_y +233), ($cero_x +490), ($cero_y +233));
    $CI->fpdf->Text(($x - 7), ($y + 235), "Time of start:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 57), ($y + 235), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_in)));
    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Line(($cero_x +70), ($cero_y +263), ($cero_x +490), ($cero_y +263));
    $CI->fpdf->Text(($x - 7), ($y + 265), "Time of finish:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 57), ($y + 265), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_out)));
    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Line(($cero_x +74), ($cero_y +293), ($cero_x +490), ($cero_y +293));

    $dateStart = new DateTime($visit_log->visited_date . " " . $visit_log->visited_time_in);
    $dateEnd   = new DateTime($visit_log->visited_date . " " . $visit_log->visited_time_out);
    $dateDiff  = $dateStart->diff($dateEnd);

    $CI->fpdf->Text(($x - 7), ($y + 295), "Total time:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 57), ($y + 295), $dateDiff->format("%H:%I:%S"));
    $pdf->SetFont('Arial', 'B', 9);

    $CI->fpdf->Line(($cero_x +60), ($cero_y +323), ($cero_x +490), ($cero_y +323));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +353), ($cero_x +490), ($cero_y +353));

    $CI->fpdf->Text(($x - 7), ($y + 350), "Activity:");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +379), ($cero_x +46), ($cero_y +379));

    $pdf->SetFont('Arial', 'B', 11);
    // $CI->fpdf->Text(($x + 60), ($y + 371), "Myofascial release for left forearm. Swedish massage");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +403), ($cero_x +490), ($cero_y +403));

    $CI->fpdf->Line(($cero_x +10), ($cero_y +433), ($cero_x +490), ($cero_y +433));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +463), ($cero_x +490), ($cero_y +463));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +493), ($cero_x +490), ($cero_y +493));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +523), ($cero_x +490), ($cero_y +523));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +553), ($cero_x +490), ($cero_y +553));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +583), ($cero_x +490), ($cero_y +583));

    if (isset($mavi->activity) AND $mavi->activity != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        $activity  = str_replace("\n", " ", $mavi->activity);
        $CI->fpdf->SetXY( ($x + 3) , ($y + 355));
        $CI->fpdf->MultiCell(480, 30, substr($activity,0, 550));
    }

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 585), "Affect:");
    $CI->fpdf->Line(($cero_x +43), ($cero_y +612), ($cero_x +490), ($cero_y +612));
    $pdf->SetFont('Arial', 'B', 11);
    if (isset($mavi->affect) AND $mavi->affect != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        $affect  = str_replace("\n", " ", $mavi->affect);
        $CI->fpdf->SetXY( ($x + 22) , ($y + 575));
        $CI->fpdf->MultiCell(480, 12, substr($affect,0, 170));
    }
    // $CI->fpdf->Text(($x + 26), ($y + 582), "Client relaxed very well. Left wrist deviation to the leftimproved from 30 degrees deviation to only");
    // $CI->fpdf->Text(($x + 26), ($y + 595), "5 degrees deviation from center. Left wrist extension improved from 98 degrees to 180 degrees.");

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 615), "Goals Addressed:");
    $pdf->SetFont('Arial', 'B', 11);
    // $CI->fpdf->Text(($x + 85), ($y + 611), "Shoulders were of even height.");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +643), ($cero_x +490), ($cero_y +643));
    $pdf->SetFont('Arial', 'B', 11);
    // $CI->fpdf->Text(($x + 25), ($y + 643), "ROM of wrist, relaxation");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +673), ($cero_x +490), ($cero_y +673));
    if (isset($mavi->goals) AND $mavi->goals != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        $goals  = str_replace("\n", " ", $mavi->goals);
        $CI->fpdf->SetXY( ($x + 3) , ($y + 595));
        $CI->fpdf->MultiCell(480, 30, '             '.substr($goals,0, 150));
    }

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 695), "Participant/Gurdian Signature:");
    if (isset($visit_log->signature) AND $visit_log->signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$visit_log->signature;
        $CI->fpdf->Image( $img_path, ($x + 127), ($y + 652), 130);
    }
    $CI->fpdf->Line(($cero_x +145), ($cero_y +723), ($cero_x +370), ($cero_y +723));
    $CI->fpdf->Text(($x + 355), ($y + 695), "Date:");
    if (isset($visit_log->signature) AND $visit_log->signature != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        // $CI->fpdf->Text(($x + 355 + 30), ($y + 695), standard_date(mysql_to_unix($mavi->pt_signed_date)));
        $CI->fpdf->Text(($x + 355 + 30), ($y + 695), standard_date(mysql_to_unix($visit_log->visit_date_time)));
        $pdf->SetFont('Arial', 'B', 9);
    }
    $CI->fpdf->Line(($cero_x +397), ($cero_y +723), ($cero_x +490), ($cero_y +723));

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 745),  "Therapist Signature:");
    if (isset($mavi->clinician_signature) AND $mavi->clinician_signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$mavi->clinician_signature;
        $CI->fpdf->Image( $img_path, ($x + 127), ($y + 702), 130);
    }
    $CI->fpdf->Line(($cero_x +102), ($cero_y +773), ($cero_x +370), ($cero_y +773));
    $CI->fpdf->Text(($x + 355), ($y + 745), "Date:");
    if (isset($mavi->clinician_signature) AND $mavi->clinician_signature != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        // $CI->fpdf->Text(($x + 355 + 30), ($y + 745), standard_date(mysql_to_unix($mavi->clinician_signed_date)));
        $CI->fpdf->Text(($x + 355 + 30), ($y + 745), standard_date(mysql_to_unix($visit_log->visit_date_time)));
        $pdf->SetFont('Arial', 'B', 9);
    }
    $CI->fpdf->Line(($cero_x +397), ($cero_y +773), ($cero_x +490), ($cero_y +773));


    $title_text = "Massage Therapy Visit Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;

}

function revi_y_waiver_pdf ($visit_log_id, $output ='F') {
    global $GL_VISIT;

    $CI =& get_instance();

    $CI->load->model('revimdl');

    $visit_log = $CI->visitlogmdl->getById($visit_log_id);
    $visitlog = $visit_log;
    $agy_user_id = $visit_log->user_id;
    $us1_user = $CI->usermdl->getById($agy_user_id);
    $revi = $CI->revimdl->get($visit_log_id);
    $GL_VISIT = $revi;

    $patient = $CI->patientmdl->getById($visit_log->patient_id);

    $visit_user = $CI->usagymdl->getByUsAgyId($visitlog->visit_user_id);
    if ($visitlog->visit_discipline_id) {
        $user_discipline = $CI->disciplinemdl->getById($visitlog->visit_discipline_id);
        $visit_user = (object) array_merge((array)$visit_user, (array)$user_discipline );
    }

    // $superv_user = $CI->usagymdl->getByUsAgyId($visitlog->superv_user_id);
    $supervisor_signed_by = array();
    if ($revi->wsuperv_signed_by) {
        $supervisor_signed_by = $CI->usagymdl->getByUsAgyId($revi->wsuperv_signed_by);
    }
    $agency = $CI->agencymdl->getByAgencyId($patient->agency_id);
    // print_r($agency);exit();
    $medicaidInsurance = $CI->patientinsurancemdl->getMedicaidInsurance($visitlog->patient_id);
    $date2 = strtotime(date("Y-m-d ").$visit_log->visited_time_out);
	$date1 = strtotime(date("Y-m-d ").$visit_log->visited_time_in);

	$visit_duration = floor(($date2 - $date1)/60);

	if($visit_duration < 0){
		$date2 = strtotime(date("Y-m-d ", mktime(0,0,0,date("m"),date("j")+1,date("Y") )).$visit_log->visited_time_out);
		$visit_duration = floor(($date2 - $date1)/60);
		// $visit_duration = 0;          
    }
    
    $agency_company_name = "";
    if ($agency->print_agency_or_contractor_on_notes == "contractor") {
        $agency_company_name = $visit_log->visit_contractor_name;
    }

    $CI =& get_instance();
	$CI->load->model('spvisitunitmdl');
    $units = $CI->spvisitunitmdl->get('Y-Waiver', $visit_duration);
        
    $path_ticket = realpath("style/images/icon_enable_negro.gif");
    $label_font = "Arial";
    $data_font = "Courier";

    $__FONT['PDF']['SIZE'] = 9;
    $__FONT['PDF']['FORM_MEDIUM'] = 10;
    $__FONT['PDF']['FORM_SMALL'] = 9;
    $__FONT['PDF']['FORM_SMALL2'] = 8;
    $__FONT['PDF']['FORM_SMALL3'] = 6.5;
    $__FONT['PDF']['FORM_SMALL4'] = 9.5;
    $__FONT['PDF']['FORM_arial8'] = 9.5;


    $CI->load->library('fpdf');
    if(!defined('FPDF_FONTPATH'))
      define('FPDF_FONTPATH',$CI->config->item('fonts_path'));
    $total_page = 1;
    $CI->fpdf->Open();
    $pdf = $CI->fpdf;
    $pdf->AddPage();
    $con = 2.8346456692913384;
    $cero_x = 11;
    $cero_y = 2;
    $y = $pdf->GetY();
    $x = $pdf->GetX();
    //agency_company_name
    $pdf->SetFont('Arial', 'B', 11);
    $CI->fpdf->Text(($x + 150), ($y + 5), $agency_company_name);
    $pdf->SetFont('Arial', 'B', 10);
    $CI->fpdf->Text(($x + 115), ($y + 25), "Recreational Therapy Progress Note - [Yes-Waiver]");

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 50), "County:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +78), ($cero_x +155), ($cero_y +78));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 50), $patient->city);

    $pdf->SetFont('Arial', 'B', 8);
    // $CI->fpdf->Text(($x + 360), ($y + 60), "Program Name:");
    $CI->fpdf->Text(($x + 200), ($y + 50), "Program Name:");
    $CI->fpdf->Line(($cero_x +447-160), ($cero_y +78), ($cero_x +487-160), ($cero_y +78));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 430-160), ($y + 50), $revi->gov_program);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 50), "Medicaid #:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +78), ($cero_x +487), ($cero_y +78));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 430), ($y + 50), @$medicaidInsurance->ins_id);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 62), "Pt. Name:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +90), ($cero_x +150), ($cero_y +90));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 62), $patient->first_name.' '.$patient->last_name);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 74), "Visit Date:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +102), ($cero_x +139), ($cero_y +102));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 74), standard_date(mysql_to_unix($visit_log->visited_date)) );

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 62), "Case #:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +90), ($cero_x +487), ($cero_y +90));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 430), ($y + 62), @$patient->medical_rec_nbr);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 74), "Client DOB:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +102), ($cero_x +498), ($cero_y +102));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 430), ($y + 74), standard_date(mysql_to_unix($patient->date_birth)));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 87), "Time in:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +115), ($cero_x +130), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 87), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_in)));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 150), ($y + 87), "Time Out:");
    $CI->fpdf->Line(($cero_x +206), ($cero_y +115), ($cero_x +246), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 189), ($y + 87), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_out)));

    $date2 = strtotime(date("Y-m-d ").$visit_log->visited_time_out);
    $date1 = strtotime(date("Y-m-d ").$visit_log->visited_time_in);

    if(is_null($visit_log->visited_time_in)){
      $date1 = strtotime(date("Y-m-d ").$visit_log->visit_date_time);
      $date2 = strtotime(date("Y-m-d ").$visit_log->visit_date_time)+(45*60);
    }

    $visit_duration = floor(($date2 - $date1)/60);

    if($visit_duration < 0){
        $date2 = strtotime(date("Y-m-d ", mktime(0,0,0,date("m"),date("j")+1,date("Y") )).$visit_log->visited_time_out);
        $visit_duration = floor(($date2 - $date1)/60);
      //$visit_duration = 45;
      // $date2 = $date1+(45*60);
    }elseif($visit_duration==0){
      $visit_duration = '00';
    }


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 260), ($y + 87), "Total time:");
    $CI->fpdf->Line(($cero_x +319), ($cero_y +115), ($cero_x +332), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 302), ($y + 87), (string)$visit_duration);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 87), "Unit Amount:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +115), ($cero_x +470), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    if ($agency->F3625_measure_unit) {
        $CI->fpdf->Text(($x + 430), ($y + 87), ($visit_duration/(60/$agency->F3625_measure_unit)));
    } else {
        //$units = number_format(0, 2);
        $CI->fpdf->Text(($x + 430), ($y + 87), (string)number_format($units, 0));
    }

    

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 100), "Therapist:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +128), ($cero_x +270), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 100), $visit_log->first_name ." ". $visit_log->last_name);

    $CI->fpdf->Line(($cero_x +30), ($cero_y +135), ($cero_x +520), ($cero_y +135));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 123), "Location of therapy:");
    $CI->fpdf->Line(($cero_x +116), ($cero_y +151), ($cero_x +230), ($cero_y +151));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 22 + 79), ($y + 123), substr($revi->wlocation_therapy, 0, 30));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 250), ($y + 123), "Persons present:");
    $CI->fpdf->Line(($cero_x +334), ($cero_y +151), ($cero_x +510), ($cero_y +151));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 250 + 68), ($y + 123), substr($revi->wpersons_present, 0, 35));

    //470 words
    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 138), "Activity/Description of Contact:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +179), ($cero_x +510), ($cero_y +179));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +190), ($cero_x +510), ($cero_y +190));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +201), ($cero_x +510), ($cero_y +201));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +212), ($cero_x +510), ($cero_y +212));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +223), ($cero_x +510), ($cero_y +223));

    $pdf->SetFont('Courier', '', 8);
    $activity  = str_replace("\n", " ", $revi->wactivity_descrip);
    $CI->fpdf->SetXY( ($x + 20) , ($y + 142));
    $CI->fpdf->MultiCell(476, 11, ''.substr($activity,0, 470));

    //380 words
    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 210), "Specific Skills received and method used to train client in skills:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +251), ($cero_x +510), ($cero_y +251));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +262), ($cero_x +510), ($cero_y +262));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +273), ($cero_x +510), ($cero_y +273));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +284), ($cero_x +510), ($cero_y +284));

    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 214));
    $wspecific_skills  = str_replace("\n", " ", $revi->wspecific_skills);
    $CI->fpdf->MultiCell(476, 11, substr($wspecific_skills,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 271), "Client's response to service being provided(observations):");
     $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +312), ($cero_x +510), ($cero_y +312));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +323), ($cero_x +510), ($cero_y +323));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +334), ($cero_x +510), ($cero_y +334));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +345), ($cero_x +510), ($cero_y +345));

    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 275));
    $wclient_response  = str_replace("\n", " ", $revi->wclient_response);
    $CI->fpdf->MultiCell(476, 11, substr($wclient_response,0, 380));


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 332), "Summary of activities and behaviors during the Services/Description of the contact:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +373), ($cero_x +510), ($cero_y +373));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +384), ($cero_x +510), ($cero_y +384));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +395), ($cero_x +510), ($cero_y +395));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +406), ($cero_x +510), ($cero_y +406));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 336));
    $wsummary_activities  = str_replace("\n", " ", $revi->wsummary_activities);
    $CI->fpdf->MultiCell(476, 11, substr($wsummary_activities,0, 380));



    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 393), "Specific interventions used:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +434), ($cero_x +510), ($cero_y +434));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +445), ($cero_x +510), ($cero_y +445));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +456), ($cero_x +510), ($cero_y +456));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +467), ($cero_x +510), ($cero_y +467));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 397));
    $wspecific_interven  = str_replace("\n", " ", $revi->wspecific_interven);
    $CI->fpdf->MultiCell(476, 11, substr($wspecific_interven,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 454), "Goals/objectives addressed:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +495), ($cero_x +510), ($cero_y +495));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +506), ($cero_x +510), ($cero_y +506));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +517), ($cero_x +510), ($cero_y +517));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +528), ($cero_x +510), ($cero_y +528));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 458));
    $wgoals_objectives  = str_replace("\n", " ", $revi->wgoals_objectives);
    $CI->fpdf->MultiCell(476, 11, substr($wgoals_objectives,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 515), "Progress or Lack of progress/outcomes of the contact:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +556), ($cero_x +510), ($cero_y +556));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +567), ($cero_x +510), ($cero_y +567));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +578), ($cero_x +510), ($cero_y +578));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +589), ($cero_x +510), ($cero_y +589));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 519));
    $wprogress_lack_progress  = str_replace("\n", " ", $revi->wprogress_lack_progress);
    $CI->fpdf->MultiCell(476, 11, substr($wprogress_lack_progress,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 576), "Goal focus/plan for next session:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +617), ($cero_x +510), ($cero_y +617));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +628), ($cero_x +510), ($cero_y +628));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +639), ($cero_x +510), ($cero_y +639));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +650), ($cero_x +510), ($cero_y +650));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 580));
    $wgoal_focus  = str_replace("\n", " ", $revi->wgoal_focus);
    $CI->fpdf->MultiCell(476, 11, substr($wgoal_focus,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 682), "Therapist Signature:");
    $CI->fpdf->Line(($cero_x +130), ($cero_y +708), ($cero_x +250), ($cero_y +708));


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 115), ($y + 690), $us1_user->first_name.' '.$us1_user->last_name);
    if (isset($revi->clinician_signature) AND $revi->clinician_signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$revi->clinician_signature;
        $CI->fpdf->Image( $img_path, ($x + 130), ($y + 630), 0, 50);
    }

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 311), ($y + 690), "Credential");
    $CI->fpdf->Line(($cero_x +307), ($cero_y +708), ($cero_x +395), ($cero_y +708));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 290), ($y + 680), $visit_user->description);


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 447), ($y + 690), "Date");
    $CI->fpdf->Line(($cero_x +435), ($cero_y +708), ($cero_x +510), ($cero_y +708));
    $pdf->SetFont('Courier', '', 8);
    if (isset($revi->clinician_signature) AND $revi->clinician_signature != "") {
        // $CI->fpdf->Text(($x + 432), ($y + 680), standard_date(mysql_to_unix($revi->clinician_signed_date)));
        $CI->fpdf->Text(($x + 432), ($y + 680), standard_date(mysql_to_unix($visit_log->visit_date_time)));
    }


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 742), "Supervisor Signature:");
    $CI->fpdf->Line(($cero_x +130), ($cero_y +768), ($cero_x +250), ($cero_y +768));

    $pdf->SetFont('Arial', 'B', 8);
    if (!empty($supervisor_signed_by)) {
        $CI->fpdf->Text(($x + 115), ($y + 750), @$supervisor_signed_by->first_name.' '.@$supervisor_signed_by->last_name);
    }
    $CI->fpdf->Text(($x + 115), ($y + 750), '');

    if (isset($revi->wsuperv_signature) AND $revi->wsuperv_signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$revi->wsuperv_signature;
        $CI->fpdf->Image( $img_path, ($x + 130), ($y + 690), 0, 50);
    }

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 311), ($y + 750), "Credential");
    $CI->fpdf->Line(($cero_x +310), ($cero_y +768), ($cero_x +390), ($cero_y +768));
    $pdf->SetFont('Courier', '', 8);
    if (!empty($supervisor_signed_by)) {
        $CI->fpdf->Text(($x + 290), ($y + 740), @$supervisor_signed_by->description);
    }

    $CI->fpdf->Text(($x + 290), ($y + 740), '');


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 447), ($y + 750), "Date");
    $CI->fpdf->Line(($cero_x +435), ($cero_y +768), ($cero_x +510), ($cero_y +768));
    $pdf->SetFont('Courier', '', 8);
    if (isset($revi->wsuperv_signature) AND $revi->wsuperv_signature != "") {
        // $CI->fpdf->Text(($x + 432), ($y + 740), standard_date(mysql_to_unix($revi->wsuperv_signed_date)));
        $CI->fpdf->Text(($x + 432), ($y + 740), standard_date(mysql_to_unix($visit_log->visit_date_time)));
    }

    $title_text = "Recreational Visit Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;

}


function revi_class_pdf ($visit_log_id, $output ='F') {
    global $GL_VISIT;
    $CI =& get_instance();


    $CI->load->model('revimdl');

    $visit_log = $CI->visitlogmdl->getById($visit_log_id);
    $visitlog = $visit_log;
    $agy_user_id = $visit_log->user_id;
    $us1_user = $CI->usermdl->getById($agy_user_id);
    $revi = $CI->revimdl->get($visit_log_id);
    $GL_VISIT = $revi;

    $patient = $CI->patientmdl->getById($visit_log->patient_id);
    $medicaidInsurance = $CI->patientinsurancemdl->getMedicaidInsurance($visitlog->patient_id);
    // $visit_user = $CI->usagymdl->getByUsAgyId($visitlog->visit_user_id);
    // $superv_user = $CI->usagymdl->getByUsAgyId($visitlog->superv_user_id);
    $agency = $CI->agencymdl->getByAgencyId($patient->agency_id);
    $enable_visit = false;
    if (isset($agency->F3625_req_visit) AND $agency->F3625_req_visit == 1) {
        $enable_visit = true;
    }

    $print_3625 = true;
    // skip 3625 when print notes = 1
    if (array_key_exists("print_notes", $GLOBALS)) {
        global $pt_3625_visits, $last_3625_visit_log_id, $print_notes;
        if ($print_notes == 1) {
            $print_3625 = false;

            if ( (isset($revi->upload_document_name) AND $revi->upload_document_name != "")
                OR  (isset($revi->upload_document_name2) AND $revi->upload_document_name2 != "") ) {
                // when uploaded found document no need to print electronic version
            }else{
                $last_3625_visit_log_id = $visit_log_id;
                $pt_3625_visits[] = $visit_log_id;
            }

        }
    }

    if (!$print_3625 AND !$enable_visit) {
        return false;
    }

    $path_ticket = realpath("style/images/icon_enable_negro.gif");
    $label_font = "Arial";
    $data_font = "Courier";

    $__FONT['PDF']['SIZE'] = 9;
    $__FONT['PDF']['FORM_MEDIUM'] = 10;
    $__FONT['PDF']['FORM_SMALL'] = 9;
    $__FONT['PDF']['FORM_SMALL2'] = 8;
    $__FONT['PDF']['FORM_SMALL3'] = 6.5;
    $__FONT['PDF']['FORM_SMALL4'] = 9.5;
    $__FONT['PDF']['FORM_arial8'] = 9.5;


    $CI->load->library('fpdf');
    if(!defined('FPDF_FONTPATH'))
      define('FPDF_FONTPATH',$CI->config->item('fonts_path'));


    $total_page = 1;
    $CI->fpdf->Open();
    $pdf = $CI->fpdf;

    $pdf->AddPage();
    $con = 2.8346456692913384;
    $cero_x = 11;
    $cero_y = 2;
    $y = $pdf->GetY();
    $x = $pdf->GetX();

    $pdf->SetFont('Arial', 'B', 13);
    $CI->fpdf->Text(($x + 160), ($y + 30), "Recreational Visit Progress Note - CLASS");

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 72), "Patient Name:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +100), ($cero_x +223), ($cero_y +100));

    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 65), ($y + 72), $patient->first_name.' '.$patient->last_name);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 84), "Visit Date:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +112), ($cero_x +223), ($cero_y +112));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 63), ($y + 84), standard_date(mysql_to_unix($visitlog->visit_date_time)) );

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 268), ($y + 72), "Medicaid #:");
    $CI->fpdf->Line(($cero_x +330), ($cero_y +100), ($cero_x +384), ($cero_y +100));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 314), ($y + 72), $medicaidInsurance->ins_id);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 100), "Time In:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +128), ($cero_x +119), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 63), ($y + 100), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_in)));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 129), ($y + 100), "Time Out:");
    $CI->fpdf->Line(($cero_x +187), ($cero_y +128), ($cero_x +225), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 168), ($y + 100), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_out)));

    $date2 = strtotime(date("Y-m-d ").$visit_log->visited_time_out);
    $date1 = strtotime(date("Y-m-d ").$visit_log->visited_time_in);

    if(is_null($visit_log->visited_time_in)){
      $date1 = strtotime(date("Y-m-d ").$visit_log->visit_date_time);
      $date2 = strtotime(date("Y-m-d ").$visit_log->visit_date_time)+(45*60);
    }

    $visit_duration = floor(($date2 - $date1)/60);

    if($visit_duration < 0){
        $date2 = strtotime(date("Y-m-d ", mktime(0,0,0,date("m"),date("j")+1,date("Y") )).$visit_log->visited_time_out);
        $visit_duration = floor(($date2 - $date1)/60);
      //$visit_duration = 45;
      // $date2 = $date1+(45*60);
    }elseif($visit_duration==0){
      $visit_duration = '00';
    }


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 268), ($y + 100), "Duration:");
    $CI->fpdf->Line(($cero_x +324), ($cero_y +128), ($cero_x +360), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 307), ($y + 100), (string)$visit_duration);
    $CI->fpdf->Text(($x + 323), ($y + 100), "min");

    $agency_company_name = "";
    if ($agency->print_agency_or_contractor_on_notes == "contractor") {
        $agency_company_name = " - ".$visit_log->visit_contractor_name;
    }

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 115), "Therapist:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +143), ($cero_x +265), ($cero_y +143));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 63), ($y + 115), $visit_log->first_name ." ". $visit_log->last_name. "".$agency_company_name);

    if ($enable_visit) {

        $CI->fpdf->Line(($cero_x +25), ($cero_y +160), ($cero_x +550), ($cero_y +160));
        // $CI->fpdf->Line(($cero_x - 10), ($cero_y +170), ($cero_x +585), ($cero_y +170));
        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 151), "Activity:");
        $CI->fpdf->SetDrawColor(200);
        $CI->fpdf->Line(($cero_x +28), ($cero_y +198), ($cero_x +547), ($cero_y +198));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +212), ($cero_x +547), ($cero_y +212));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +226), ($cero_x +547), ($cero_y +226));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +240), ($cero_x +547), ($cero_y +240));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +256), ($cero_x +547), ($cero_y +256));
        $pdf->SetFont('Courier', '', 8);
        if (isset($revi->activity) AND $revi->activity != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $activity  = str_replace("\n", " ", $revi->activity);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 156));
            $CI->fpdf->MultiCell(525, 14, substr($activity,0, 525));
        }


        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 251), "Affect:");

        $CI->fpdf->Line(($cero_x +28), ($cero_y +297), ($cero_x +547), ($cero_y +297));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +311), ($cero_x +547), ($cero_y +311));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +325), ($cero_x +547), ($cero_y +325));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +339), ($cero_x +547), ($cero_y +339));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +355), ($cero_x +547), ($cero_y +355));

        $pdf->SetFont('Courier', '', 8);
        if (isset($revi->affect) AND $revi->affect != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $affect  = str_replace("\n", " ", $revi->affect);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 256));
            $CI->fpdf->MultiCell(525, 14, substr($affect,0, 525));
        }


        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 351), "Goals Addressed (Revisions of Goals and Objectives):");
        $CI->fpdf->Line(($cero_x +28), ($cero_y +396), ($cero_x +547), ($cero_y +396));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +410), ($cero_x +547), ($cero_y +410));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +424), ($cero_x +547), ($cero_y +424));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +438), ($cero_x +547), ($cero_y +438));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +454), ($cero_x +547), ($cero_y +454));
        $pdf->SetFont('Courier', '', 8);
        if (isset($revi->goals) AND $revi->goals != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $goals  = str_replace("\n", " ", $revi->goals);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 356));
            $CI->fpdf->MultiCell(525, 14, substr($goals,0, 525));
        }

        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 451), "Treatment Provided:");
        $CI->fpdf->Line(($cero_x +28), ($cero_y +495), ($cero_x +547), ($cero_y +495));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +509), ($cero_x +547), ($cero_y +509));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +523), ($cero_x +547), ($cero_y +523));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +537), ($cero_x +547), ($cero_y +537));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +553), ($cero_x +547), ($cero_y +553));

        $pdf->SetFont('Courier', '', 8);
        if (isset($revi->treat_provided) AND $revi->treat_provided != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $treat_provided  = str_replace("\n", " ", $revi->treat_provided);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 456));
            $CI->fpdf->MultiCell(525, 14, substr($treat_provided,0, 525));
        }

        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 551), "Client Response to Therapy:");
        $CI->fpdf->Line(($cero_x +28), ($cero_y +594), ($cero_x +547), ($cero_y +594));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +608), ($cero_x +547), ($cero_y +608));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +622), ($cero_x +547), ($cero_y +622));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +636), ($cero_x +547), ($cero_y +636));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +652), ($cero_x +547), ($cero_y +652));

        $pdf->SetFont('Courier', '', 8);
        if (isset($revi->client_response) AND $revi->client_response != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $client_response  = str_replace("\n", " ", $revi->client_response);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 556));
            $CI->fpdf->MultiCell(525, 14, substr($client_response,0, 525));
        }


        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 22), ($y + 670), "Participant/Family Signature:");
        if (isset($visit_log->signature) AND $visit_log->signature != "") {
            $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$visit_log->signature;
            $CI->fpdf->Image( $img_path, ($x + 150), ($y + 640), 60);
        }
        $CI->fpdf->Line(($cero_x +153), ($cero_y +698), ($cero_x +350), ($cero_y +698));
        $CI->fpdf->Text(($x + 355), ($y + 670), "Date:");
        if (isset($visit_log->signature) AND $visit_log->signature != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            // $CI->fpdf->Text(($x + 355 + 30), ($y + 670), standard_date(mysql_to_unix($revi->pt_signed_date)));
            $CI->fpdf->Text(($x + 355 + 30), ($y + 670), standard_date(mysql_to_unix($visit_log->visit_date_time)));
            $pdf->SetFont('Arial', 'B', 8);
        }
        $CI->fpdf->Line(($cero_x +397), ($cero_y +698), ($cero_x +490), ($cero_y +698));

        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 22), ($y + 720),  "Therapist Signature:");
        if (isset($revi->clinician_signature) AND $revi->clinician_signature != "") {
            $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$revi->clinician_signature;
            $CI->fpdf->Image( $img_path, ($x + 115), ($y + 690), 60);
            $pdf->SetFont('Arial', '', 8);
            $CI->fpdf->Text(($x + 122), ($y + 732),  $us1_user->first_name.' '.$us1_user->last_name);
            $pdf->SetFont('Arial', 'B', 8);
        }
        $CI->fpdf->Line(($cero_x +120), ($cero_y +748), ($cero_x +350), ($cero_y +748));
        $CI->fpdf->Text(($x + 355), ($y + 720), "Date:");
        if (isset($revi->clinician_signature) AND $revi->clinician_signature != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            // $CI->fpdf->Text(($x + 355 + 30), ($y + 720), standard_date(mysql_to_unix($revi->clinician_signed_date)));
            $CI->fpdf->Text(($x + 355 + 30), ($y + 720), standard_date(mysql_to_unix($visit_log->visit_date_time)));
            $pdf->SetFont('Arial', 'B', 8);
        }
        $CI->fpdf->Line(($cero_x +397), ($cero_y +748), ($cero_x +490), ($cero_y +748));
    }

    if ($print_3625) {
        form3625_pdf($visit_log_id, "M");
    }

    $title_text = "Recreational Visit Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    if ($print_3625) {
        $title_text = "Recreational Visit and Form 3625 Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    }

    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;

}

function revi_pdf ($visit_log_id, $output ='F') {
    global $GL_VISIT;

    $CI =& get_instance();

    $CI->load->model('revimdl');

    $visit_log = $CI->visitlogmdl->getById($visit_log_id);
    $visitlog = $visit_log;
    $revi = $CI->revimdl->get($visit_log_id);

    if (isset($revi->gov_program) AND $revi->gov_program) {
    } else {
      $patient = $CI->patientmdl->getById($visit_log->patient_id);
      @$revi->gov_program = $patient->gov_program;
    }

    if (isset($revi->gov_program) AND $revi->gov_program == 'Y-Waiver') {
      $filename = revi_y_waiver_pdf($visit_log_id, $output);
      return $filename;
    }
    elseif (isset($revi->gov_program) AND $revi->gov_program == 'CLASS') {
      $filename = revi_class_pdf($visit_log_id, $output);
      return $filename;
    }

    $GL_VISIT = $revi;

    $agy_user_id = $visit_log->user_id;
    $us1_user = $CI->usermdl->getById($agy_user_id);

    $patient = $CI->patientmdl->getById($visit_log->patient_id);

    $path_ticket = realpath("style/images/icon_enable_negro.gif");
    $label_font = "Arial";
    $data_font = "Courier";

    $__FONT['PDF']['SIZE'] = 9;
    $__FONT['PDF']['FORM_MEDIUM'] = 10;
    $__FONT['PDF']['FORM_SMALL'] = 9;
    $__FONT['PDF']['FORM_SMALL2'] = 8;
    $__FONT['PDF']['FORM_SMALL3'] = 6.5;
    $__FONT['PDF']['FORM_SMALL4'] = 9.5;
    $__FONT['PDF']['FORM_arial8'] = 9.5;


    $CI->load->library('fpdf');
    if(!defined('FPDF_FONTPATH'))
      define('FPDF_FONTPATH',$CI->config->item('fonts_path'));
    $total_page = 2;
    $CI->fpdf->Open();
    $pdf = $CI->fpdf;
    $pdf->AddPage();
    $con = 2.8346456692913384;
    $cero_x = 11;
    $cero_y = 2;
    $y = $pdf->GetY();
    $x = $pdf->GetX();

    $pdf->SetFont('Arial', 'B', 30);
    $CI->fpdf->Text(($x + 150), ($y + 72), "Progress Notes");
    $CI->fpdf->Text(($x + 144), ($y + 76), "______________");

    $pdf->SetFont('Arial', 'B', 20);
    $CI->fpdf->Text(($x + 208), ($y + 120), "Private");

    // $pdf->SetFont('Arial', 'B', 10);
    // $CI->fpdf->Text(($x + 210), ($y + 150), "(please circle one above)");

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 175), "Participant name:");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +205), ($cero_x +390), ($cero_y +205));
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 75), ($y + 175), $patient->first_name." ".$patient->last_name);

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 205), "Date:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 27), ($y + 205), standard_date(mysql_to_unix($visit_log->visited_date)));
    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Line(($cero_x +35), ($cero_y +233), ($cero_x +490), ($cero_y +233));
    $CI->fpdf->Text(($x - 7), ($y + 235), "Time of start:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 57), ($y + 235), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_in)));
    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Line(($cero_x +70), ($cero_y +263), ($cero_x +490), ($cero_y +263));
    $CI->fpdf->Text(($x - 7), ($y + 265), "Time of finish:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 57), ($y + 265), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_out)));
    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Line(($cero_x +74), ($cero_y +293), ($cero_x +490), ($cero_y +293));

    $dateStart = new DateTime($visit_log->visited_date . " " . $visit_log->visited_time_in);
    $dateEnd   = new DateTime($visit_log->visited_date . " " . $visit_log->visited_time_out);
    $dateDiff  = $dateStart->diff($dateEnd);

    $CI->fpdf->Text(($x - 7), ($y + 295), "Total time:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 57), ($y + 295), $dateDiff->format("%H:%I:%S"));
    $pdf->SetFont('Arial', 'B', 9);

    $CI->fpdf->Line(($cero_x +60), ($cero_y +323), ($cero_x +490), ($cero_y +323));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +353), ($cero_x +490), ($cero_y +353));

    $CI->fpdf->Text(($x - 7), ($y + 350), "Activity:");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +379), ($cero_x +46), ($cero_y +379));

    $pdf->SetFont('Arial', 'B', 11);
    // $CI->fpdf->Text(($x + 60), ($y + 371), "Myofascial release for left forearm. Swedish massage");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +403), ($cero_x +490), ($cero_y +403));

    $CI->fpdf->Line(($cero_x +10), ($cero_y +433), ($cero_x +490), ($cero_y +433));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +463), ($cero_x +490), ($cero_y +463));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +493), ($cero_x +490), ($cero_y +493));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +523), ($cero_x +490), ($cero_y +523));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +553), ($cero_x +490), ($cero_y +553));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +583), ($cero_x +490), ($cero_y +583));

    if (isset($revi->activity) AND $revi->activity != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        $activity  = str_replace("\n", " ", $revi->activity);
        $CI->fpdf->SetXY( ($x + 3) , ($y + 355));
        $CI->fpdf->MultiCell(480, 30, substr($activity,0, 550));
    }

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 585), "Affect:");
    $CI->fpdf->Line(($cero_x +43), ($cero_y +612), ($cero_x +490), ($cero_y +612));
    $pdf->SetFont('Arial', 'B', 11);
    if (isset($revi->affect) AND $revi->affect != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        $affect  = str_replace("\n", " ", $revi->affect);
        $CI->fpdf->SetXY( ($x + 22) , ($y + 575));
        $CI->fpdf->MultiCell(480, 12, substr($affect,0, 170));
    }
    // $CI->fpdf->Text(($x + 26), ($y + 582), "Client relaxed very well. Left wrist deviation to the leftimproved from 30 degrees deviation to only");
    // $CI->fpdf->Text(($x + 26), ($y + 595), "5 degrees deviation from center. Left wrist extension improved from 98 degrees to 180 degrees.");

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 615), "Goals Addressed:");
    $pdf->SetFont('Arial', 'B', 11);
    // $CI->fpdf->Text(($x + 85), ($y + 611), "Shoulders were of even height.");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +643), ($cero_x +490), ($cero_y +643));
    $pdf->SetFont('Arial', 'B', 11);
    // $CI->fpdf->Text(($x + 25), ($y + 643), "ROM of wrist, relaxation");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +673), ($cero_x +490), ($cero_y +673));
    if (isset($revi->goals) AND $revi->goals != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        $goals  = str_replace("\n", " ", $revi->goals);
        $CI->fpdf->SetXY( ($x + 3) , ($y + 595));
        $CI->fpdf->MultiCell(480, 30, '             '.substr($goals,0, 150));
    }

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 695), "Participant/Gurdian Signature:");
    if (isset($visit_log->signature) AND $visit_log->signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$visit_log->signature;
        $CI->fpdf->Image( $img_path, ($x + 127), ($y + 652), 130);
    }
    $CI->fpdf->Line(($cero_x +145), ($cero_y +723), ($cero_x +370), ($cero_y +723));
    $CI->fpdf->Text(($x + 355), ($y + 695), "Date:");
    if (isset($visit_log->signature) AND $visit_log->signature != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        // $CI->fpdf->Text(($x + 355 + 30), ($y + 695), standard_date(mysql_to_unix($revi->pt_signed_date)));
        $CI->fpdf->Text(($x + 355 + 30), ($y + 695), standard_date(mysql_to_unix($visit_log->visit_date_time)));
        $pdf->SetFont('Arial', 'B', 9);
    }
    $CI->fpdf->Line(($cero_x +397), ($cero_y +723), ($cero_x +490), ($cero_y +723));

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 745),  "Therapist Signature:");
    if (isset($revi->clinician_signature) AND $revi->clinician_signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$revi->clinician_signature;
        $CI->fpdf->Image( $img_path, ($x + 127), ($y + 702), 130);
    }
    $CI->fpdf->Line(($cero_x +102), ($cero_y +773), ($cero_x +370), ($cero_y +773));
    $CI->fpdf->Text(($x + 355), ($y + 745), "Date:");
    if (isset($revi->clinician_signature) AND $revi->clinician_signature != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        // $CI->fpdf->Text(($x + 355 + 30), ($y + 745), standard_date(mysql_to_unix($revi->clinician_signed_date)));
        $CI->fpdf->Text(($x + 355 + 30), ($y + 745), standard_date(mysql_to_unix($visit_log->visit_date_time)));
        $pdf->SetFont('Arial', 'B', 9);
    }
    $CI->fpdf->Line(($cero_x +397), ($cero_y +773), ($cero_x +490), ($cero_y +773));


    $title_text = "Recreational Visit Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;

}

function aqvi_y_waiver_pdf ($visit_log_id, $output ='F') {
    global $GL_VISIT;

    $CI =& get_instance();

    $CI->load->model('aqvimdl');

    $visit_log = $CI->visitlogmdl->getById($visit_log_id);
    $visitlog = $visit_log;
    $agy_user_id = $visit_log->user_id;
    $us1_user = $CI->usermdl->getById($agy_user_id);
    $aqvi = $CI->aqvimdl->get($visit_log_id);
    $GL_VISIT = $aqvi;

    $patient = $CI->patientmdl->getById($visit_log->patient_id);

    $visit_user = $CI->usagymdl->getByUsAgyId($visitlog->visit_user_id);
    if ($visitlog->visit_discipline_id) {
        $user_discipline = $CI->disciplinemdl->getById($visitlog->visit_discipline_id);
        $visit_user = (object) array_merge((array)$visit_user, (array)$user_discipline );
    }

    // $superv_user = $CI->usagymdl->getByUsAgyId($visitlog->superv_user_id);
    $supervisor_signed_by = array();
    if ($aqvi->wsuperv_signed_by) {
        $supervisor_signed_by = $CI->usagymdl->getByUsAgyId($aqvi->wsuperv_signed_by);
    }
    $agency = $CI->agencymdl->getByAgencyId($patient->agency_id);
    // print_r($agency);exit();
    $medicaidInsurance = $CI->patientinsurancemdl->getMedicaidInsurance($visitlog->patient_id);

    $path_ticket = realpath("style/images/icon_enable_negro.gif");
    $label_font = "Arial";
    $data_font = "Courier";

    $__FONT['PDF']['SIZE'] = 9;
    $__FONT['PDF']['FORM_MEDIUM'] = 10;
    $__FONT['PDF']['FORM_SMALL'] = 9;
    $__FONT['PDF']['FORM_SMALL2'] = 8;
    $__FONT['PDF']['FORM_SMALL3'] = 6.5;
    $__FONT['PDF']['FORM_SMALL4'] = 9.5;
    $__FONT['PDF']['FORM_arial8'] = 9.5;


    $CI->load->library('fpdf');
    if(!defined('FPDF_FONTPATH'))
      define('FPDF_FONTPATH',$CI->config->item('fonts_path'));
    $total_page = 1;
    $CI->fpdf->Open();
    $pdf = $CI->fpdf;
    $pdf->AddPage();
    $con = 2.8346456692913384;
    $cero_x = 11;
    $cero_y = 2;
    $y = $pdf->GetY();
    $x = $pdf->GetX();

    $agency_company_name = "";
    if ($agency->print_agency_or_contractor_on_notes == "contractor") {
        $agency_company_name = $visit_log->visit_contractor_name;
        $pdf->SetFont('Arial', 'B', 13);
        $CI->fpdf->Text(($x + 150), ($y + 5), $agency_company_name);
        $pdf->SetFont('Arial', 'B', 12);
        $CI->fpdf->Text(($x + 115), ($y + 20), "Aquatic Therapy Progress Note - [Yes-Waiver]");
    } else {
        $pdf->SetFont('Arial', 'B', 13);
        $CI->fpdf->Text(($x + 115), ($y + 15), "Aquatic Therapy Progress Note - [Yes-Waiver]");
    }

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 50), "County:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +78), ($cero_x +155), ($cero_y +78));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 50), $patient->city);

    $pdf->SetFont('Arial', 'B', 8);
    // $CI->fpdf->Text(($x + 360), ($y + 60), "Program Name:");
    $CI->fpdf->Text(($x + 200), ($y + 50), "Program Name:");
    $CI->fpdf->Line(($cero_x +447-160), ($cero_y +78), ($cero_x +487-160), ($cero_y +78));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 430-160), ($y + 50), $aqvi->gov_program);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 50), "Medicaid #:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +78), ($cero_x +487), ($cero_y +78));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 430), ($y + 50), @$medicaidInsurance->ins_id);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 62), "Pt. Name:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +90), ($cero_x +150), ($cero_y +90));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 62), $patient->first_name.' '.$patient->last_name);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 74), "Visit Date:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +102), ($cero_x +139), ($cero_y +102));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 74), standard_date(mysql_to_unix($visit_log->visited_date)) );

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 64), "Case #:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +90), ($cero_x +487), ($cero_y +90));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 430), ($y + 62), @$patient->medical_rec_nbr);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 74), "Client DOB:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +102), ($cero_x +498), ($cero_y +102));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 430), ($y + 74), standard_date(mysql_to_unix($patient->date_birth)));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 87), "Time in:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +115), ($cero_x +130), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 87), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_in)));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 150), ($y + 87), "Time Out:");
    $CI->fpdf->Line(($cero_x +206), ($cero_y +115), ($cero_x +246), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 189), ($y + 87), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_out)));

    $date2 = strtotime(date("Y-m-d ").$visit_log->visited_time_out);
    $date1 = strtotime(date("Y-m-d ").$visit_log->visited_time_in);

    if(is_null($visit_log->visited_time_in)){
      $date1 = strtotime(date("Y-m-d ").$visit_log->visit_date_time);
      $date2 = strtotime(date("Y-m-d ").$visit_log->visit_date_time)+(45*60);
    }

    $visit_duration = floor(($date2 - $date1)/60);

    if($visit_duration < 0){
        $date2 = strtotime(date("Y-m-d ", mktime(0,0,0,date("m"),date("j")+1,date("Y") )).$visit_log->visited_time_out);
        $visit_duration = floor(($date2 - $date1)/60);
      //$visit_duration = 45;
      // $date2 = $date1+(45*60);
    }elseif($visit_duration==0){
      $visit_duration = '00';
    }


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 260), ($y + 87), "Total time:");
    $CI->fpdf->Line(($cero_x +319), ($cero_y +115), ($cero_x +332), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 302), ($y + 87), (string)$visit_duration);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 360), ($y + 87), "Unit Amount:");
    $CI->fpdf->Line(($cero_x +447), ($cero_y +115), ($cero_x +460), ($cero_y +115));
    $pdf->SetFont('Courier', '', 8);
    if ($agency->F3625_measure_unit) {
        $CI->fpdf->Text(($x + 430), ($y + 87), ($visit_duration/(60/$agency->F3625_measure_unit)));
    }


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 100), "Therapist:");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +128), ($cero_x +270), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 72), ($y + 100), $visit_log->first_name ." ". $visit_log->last_name);

    $CI->fpdf->Line(($cero_x +30), ($cero_y +135), ($cero_x +520), ($cero_y +135));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 123), "Location of therapy:");
    $CI->fpdf->Line(($cero_x +116), ($cero_y +151), ($cero_x +230), ($cero_y +151));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 22 + 79), ($y + 123), substr($aqvi->wlocation_therapy, 0, 30));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 250), ($y + 123), "Persons present:");
    $CI->fpdf->Line(($cero_x +334), ($cero_y +151), ($cero_x +510), ($cero_y +151));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 250 + 68), ($y + 123), substr($aqvi->wpersons_present, 0, 35));

    //470 words
    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 138), "Activity/Description of Contact:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +179), ($cero_x +510), ($cero_y +179));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +190), ($cero_x +510), ($cero_y +190));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +201), ($cero_x +510), ($cero_y +201));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +212), ($cero_x +510), ($cero_y +212));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +223), ($cero_x +510), ($cero_y +223));

    $pdf->SetFont('Courier', '', 8);
    $activity  = str_replace("\n", " ", $aqvi->wactivity_descrip);
    $CI->fpdf->SetXY( ($x + 20) , ($y + 142));
    $CI->fpdf->MultiCell(476, 11, ''.substr($activity,0, 470));

    //380 words
    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 210), "Specific Skills received and method used to train client in skills:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +251), ($cero_x +510), ($cero_y +251));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +262), ($cero_x +510), ($cero_y +262));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +273), ($cero_x +510), ($cero_y +273));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +284), ($cero_x +510), ($cero_y +284));

    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 214));
    $wspecific_skills  = str_replace("\n", " ", $aqvi->wspecific_skills);
    $CI->fpdf->MultiCell(476, 11, substr($wspecific_skills,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 271), "Client's response to service being provided(observations):");
     $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +312), ($cero_x +510), ($cero_y +312));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +323), ($cero_x +510), ($cero_y +323));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +334), ($cero_x +510), ($cero_y +334));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +345), ($cero_x +510), ($cero_y +345));

    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 275));
    $wclient_response  = str_replace("\n", " ", $aqvi->wclient_response);
    $CI->fpdf->MultiCell(476, 11, substr($wclient_response,0, 380));


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 332), "Summary of activities and behaviors during the Services/Description of the contact:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +373), ($cero_x +510), ($cero_y +373));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +384), ($cero_x +510), ($cero_y +384));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +395), ($cero_x +510), ($cero_y +395));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +406), ($cero_x +510), ($cero_y +406));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 336));
    $wsummary_activities  = str_replace("\n", " ", $aqvi->wsummary_activities);
    $CI->fpdf->MultiCell(476, 11, substr($wsummary_activities,0, 380));



    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 393), "Specific interventions used:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +434), ($cero_x +510), ($cero_y +434));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +445), ($cero_x +510), ($cero_y +445));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +456), ($cero_x +510), ($cero_y +456));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +467), ($cero_x +510), ($cero_y +467));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 397));
    $wspecific_interven  = str_replace("\n", " ", $aqvi->wspecific_interven);
    $CI->fpdf->MultiCell(476, 11, substr($wspecific_interven,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 454), "Goals/objectives addressed:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +495), ($cero_x +510), ($cero_y +495));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +506), ($cero_x +510), ($cero_y +506));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +517), ($cero_x +510), ($cero_y +517));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +528), ($cero_x +510), ($cero_y +528));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 458));
    $wgoals_objectives  = str_replace("\n", " ", $aqvi->wgoals_objectives);
    $CI->fpdf->MultiCell(476, 11, substr($wgoals_objectives,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 515), "Progress or Lack of progress/outcomes of the contact:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +556), ($cero_x +510), ($cero_y +556));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +567), ($cero_x +510), ($cero_y +567));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +578), ($cero_x +510), ($cero_y +578));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +589), ($cero_x +510), ($cero_y +589));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 519));
    $wprogress_lack_progress  = str_replace("\n", " ", $aqvi->wprogress_lack_progress);
    $CI->fpdf->MultiCell(476, 11, substr($wprogress_lack_progress,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 576), "Goal focus/plan for next session:");
    $CI->fpdf->SetDrawColor(200);
    $CI->fpdf->Line(($cero_x +40), ($cero_y +617), ($cero_x +510), ($cero_y +617));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +628), ($cero_x +510), ($cero_y +628));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +639), ($cero_x +510), ($cero_y +639));
    $CI->fpdf->Line(($cero_x +40), ($cero_y +650), ($cero_x +510), ($cero_y +650));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->SetXY( ($x + 22) , ($y + 580));
    $wgoal_focus  = str_replace("\n", " ", $aqvi->wgoal_focus);
    $CI->fpdf->MultiCell(476, 11, substr($wgoal_focus,0, 380));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 682), "Therapist Signature:");
    $CI->fpdf->Line(($cero_x +130), ($cero_y +708), ($cero_x +250), ($cero_y +708));


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 115), ($y + 690), $us1_user->first_name.' '.$us1_user->last_name);
    if (isset($aqvi->clinician_signature) AND $aqvi->clinician_signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$aqvi->clinician_signature;
        $CI->fpdf->Image( $img_path, ($x + 130), ($y + 630), 0, 50);
    }

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 311), ($y + 690), "Credential");
    $CI->fpdf->Line(($cero_x +307), ($cero_y +708), ($cero_x +395), ($cero_y +708));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 290), ($y + 680), $visit_user->description);


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 447), ($y + 690), "Date");
    $CI->fpdf->Line(($cero_x +435), ($cero_y +708), ($cero_x +510), ($cero_y +708));
    $pdf->SetFont('Courier', '', 8);
    if (isset($aqvi->clinician_signature) AND $aqvi->clinician_signature != "") {
        // $CI->fpdf->Text(($x + 432), ($y + 680), standard_date(mysql_to_unix($aqvi->clinician_signed_date)));
        $CI->fpdf->Text(($x + 432), ($y + 680), standard_date(mysql_to_unix($visit_log->visit_date_time)));
    }


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 22), ($y + 742), "Supervisor Signature:");
    $CI->fpdf->Line(($cero_x +130), ($cero_y +768), ($cero_x +250), ($cero_y +768));

    $pdf->SetFont('Arial', 'B', 8);
    if (!empty($supervisor_signed_by)) {
        $CI->fpdf->Text(($x + 115), ($y + 750), @$supervisor_signed_by->first_name.' '.@$supervisor_signed_by->last_name);
    }
    $CI->fpdf->Text(($x + 115), ($y + 750), '');

    if (isset($aqvi->wsuperv_signature) AND $aqvi->wsuperv_signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$aqvi->wsuperv_signature;
        $CI->fpdf->Image( $img_path, ($x + 130), ($y + 690), 0, 50);
    }

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 311), ($y + 750), "Credential");
    $CI->fpdf->Line(($cero_x +310), ($cero_y +768), ($cero_x +390), ($cero_y +768));
    $pdf->SetFont('Courier', '', 8);
    if (!empty($supervisor_signed_by)) {
        $CI->fpdf->Text(($x + 290), ($y + 740), @$supervisor_signed_by->description);
    }

    $CI->fpdf->Text(($x + 290), ($y + 740), '');


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 447), ($y + 750), "Date");
    $CI->fpdf->Line(($cero_x +435), ($cero_y +768), ($cero_x +510), ($cero_y +768));
    $pdf->SetFont('Courier', '', 8);
    if (isset($aqvi->wsuperv_signature) AND $aqvi->wsuperv_signature != "") {
        // $CI->fpdf->Text(($x + 432), ($y + 740), standard_date(mysql_to_unix($aqvi->wsuperv_signed_date)));
        $CI->fpdf->Text(($x + 432), ($y + 740), standard_date(mysql_to_unix($visit_log->visit_date_time)));
    }

    $title_text = "Aquatic Visit Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;

}

function aqvi_class_pdf ($visit_log_id, $output ='F') {
    global $GL_VISIT;
    $CI =& get_instance();


    $CI->load->model('aqvimdl');

    $visit_log = $CI->visitlogmdl->getById($visit_log_id);
    $visitlog = $visit_log;
    $agy_user_id = $visit_log->user_id;
    $us1_user = $CI->usermdl->getById($agy_user_id);
    $aqvi = $CI->aqvimdl->get($visit_log_id);
    $GL_VISIT = $aqvi;

    $patient = $CI->patientmdl->getById($visit_log->patient_id);
    $medicaidInsurance = $CI->patientinsurancemdl->getMedicaidInsurance($visitlog->patient_id);
    // $visit_user = $CI->usagymdl->getByUsAgyId($visitlog->visit_user_id);
    // $superv_user = $CI->usagymdl->getByUsAgyId($visitlog->superv_user_id);
    $agency = $CI->agencymdl->getByAgencyId($patient->agency_id);
    $enable_visit = false;
    if (isset($agency->F3625_req_visit) AND $agency->F3625_req_visit == 1) {
        $enable_visit = true;
    }

    $print_3625 = true;
    // skip 3625 when print notes = 1
    if (array_key_exists("print_notes", $GLOBALS)) {
        global $pt_3625_visits, $last_3625_visit_log_id, $print_notes;
        if ($print_notes == 1) {
            $print_3625 = false;

            if ( (isset($aqvi->upload_document_name) AND $aqvi->upload_document_name != "")
                OR  (isset($aqvi->upload_document_name2) AND $aqvi->upload_document_name2 != "") ) {
                // when uploaded found document no need to print electronic version
            }else{
                $last_3625_visit_log_id = $visit_log_id;
                $pt_3625_visits[] = $visit_log_id;
            }

        }
    }

    if (!$print_3625 AND !$enable_visit) {
        return false;
    }

    $path_ticket = realpath("style/images/icon_enable_negro.gif");
    $label_font = "Arial";
    $data_font = "Courier";

    $__FONT['PDF']['SIZE'] = 9;
    $__FONT['PDF']['FORM_MEDIUM'] = 10;
    $__FONT['PDF']['FORM_SMALL'] = 9;
    $__FONT['PDF']['FORM_SMALL2'] = 8;
    $__FONT['PDF']['FORM_SMALL3'] = 6.5;
    $__FONT['PDF']['FORM_SMALL4'] = 9.5;
    $__FONT['PDF']['FORM_arial8'] = 9.5;


    $CI->load->library('fpdf');
    if(!defined('FPDF_FONTPATH'))
      define('FPDF_FONTPATH',$CI->config->item('fonts_path'));


    $total_page = 1;
    $CI->fpdf->Open();
    $pdf = $CI->fpdf;

    $pdf->AddPage();
    $con = 2.8346456692913384;
    $cero_x = 11;
    $cero_y = 2;
    $y = $pdf->GetY();
    $x = $pdf->GetX();

    $pdf->SetFont('Arial', 'B', 13);
    $CI->fpdf->Text(($x + 160), ($y + 30), "Aquatic Visit Progress Note - CLASS");

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 72), "Patient Name:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +100), ($cero_x +223), ($cero_y +100));

    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 65), ($y + 72), $patient->first_name.' '.$patient->last_name);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 84), "Visit Date:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +112), ($cero_x +223), ($cero_y +112));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 63), ($y + 84), standard_date(mysql_to_unix($visitlog->visit_date_time)) );

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 268), ($y + 72), "Medicaid #:");
    $CI->fpdf->Line(($cero_x +330), ($cero_y +100), ($cero_x +384), ($cero_y +100));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 314), ($y + 72), $medicaidInsurance->ins_id);

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 100), "Time In:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +128), ($cero_x +119), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 63), ($y + 100), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_in)));

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 129), ($y + 100), "Time Out:");
    $CI->fpdf->Line(($cero_x +187), ($cero_y +128), ($cero_x +225), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 168), ($y + 100), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_out)));

    $date2 = strtotime(date("Y-m-d ").$visit_log->visited_time_out);
    $date1 = strtotime(date("Y-m-d ").$visit_log->visited_time_in);

    if(is_null($visit_log->visited_time_in)){
      $date1 = strtotime(date("Y-m-d ").$visit_log->visit_date_time);
      $date2 = strtotime(date("Y-m-d ").$visit_log->visit_date_time)+(45*60);
    }

    $visit_duration = floor(($date2 - $date1)/60);

    if($visit_duration < 0){
        $date2 = strtotime(date("Y-m-d ", mktime(0,0,0,date("m"),date("j")+1,date("Y") )).$visit_log->visited_time_out);
        $visit_duration = floor(($date2 - $date1)/60);
      //$visit_duration = 45;
      // $date2 = $date1+(45*60);
    }elseif($visit_duration==0){
      $visit_duration = '00';
    }


    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 268), ($y + 100), "Duration:");
    $CI->fpdf->Line(($cero_x +324), ($cero_y +128), ($cero_x +360), ($cero_y +128));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 307), ($y + 100), (string)$visit_duration);
    $CI->fpdf->Text(($x + 323), ($y + 100), "min");

    $agency_company_name = "";
    if ($agency->print_agency_or_contractor_on_notes == "contractor") {
        $agency_company_name = " - ".$visit_log->visit_contractor_name;
    }

    $pdf->SetFont('Arial', 'B', 8);
    $CI->fpdf->Text(($x + 10), ($y + 115), "Therapist:");
    $CI->fpdf->Line(($cero_x +81), ($cero_y +143), ($cero_x +265), ($cero_y +143));
    $pdf->SetFont('Courier', '', 8);
    $CI->fpdf->Text(($x + 63), ($y + 115), $visit_log->first_name ." ". $visit_log->last_name. "".$agency_company_name);

    if ($enable_visit) {

        $CI->fpdf->Line(($cero_x +25), ($cero_y +160), ($cero_x +550), ($cero_y +160));
        // $CI->fpdf->Line(($cero_x - 10), ($cero_y +170), ($cero_x +585), ($cero_y +170));
        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 151), "Activity:");
        $CI->fpdf->SetDrawColor(200);
        $CI->fpdf->Line(($cero_x +28), ($cero_y +198), ($cero_x +547), ($cero_y +198));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +212), ($cero_x +547), ($cero_y +212));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +226), ($cero_x +547), ($cero_y +226));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +240), ($cero_x +547), ($cero_y +240));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +256), ($cero_x +547), ($cero_y +256));
        $pdf->SetFont('Courier', '', 8);
        if (isset($aqvi->activity) AND $aqvi->activity != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $activity  = str_replace("\n", " ", $aqvi->activity);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 156));
            $CI->fpdf->MultiCell(525, 14, substr($activity,0, 525));
        }


        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 251), "Affect:");

        $CI->fpdf->Line(($cero_x +28), ($cero_y +297), ($cero_x +547), ($cero_y +297));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +311), ($cero_x +547), ($cero_y +311));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +325), ($cero_x +547), ($cero_y +325));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +339), ($cero_x +547), ($cero_y +339));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +355), ($cero_x +547), ($cero_y +355));

        $pdf->SetFont('Courier', '', 8);
        if (isset($aqvi->affect) AND $aqvi->affect != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $affect  = str_replace("\n", " ", $aqvi->affect);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 256));
            $CI->fpdf->MultiCell(525, 14, substr($affect,0, 525));
        }


        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 351), "Goals Addressed (Revisions of Goals and Objectives):");
        $CI->fpdf->Line(($cero_x +28), ($cero_y +396), ($cero_x +547), ($cero_y +396));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +410), ($cero_x +547), ($cero_y +410));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +424), ($cero_x +547), ($cero_y +424));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +438), ($cero_x +547), ($cero_y +438));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +454), ($cero_x +547), ($cero_y +454));
        $pdf->SetFont('Courier', '', 8);
        if (isset($aqvi->goals) AND $aqvi->goals != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $goals  = str_replace("\n", " ", $aqvi->goals);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 356));
            $CI->fpdf->MultiCell(525, 14, substr($goals,0, 525));
        }

        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 451), "Treatment Provided:");
        $CI->fpdf->Line(($cero_x +28), ($cero_y +495), ($cero_x +547), ($cero_y +495));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +509), ($cero_x +547), ($cero_y +509));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +523), ($cero_x +547), ($cero_y +523));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +537), ($cero_x +547), ($cero_y +537));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +553), ($cero_x +547), ($cero_y +553));

        $pdf->SetFont('Courier', '', 8);
        if (isset($aqvi->treat_provided) AND $aqvi->treat_provided != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $treat_provided  = str_replace("\n", " ", $aqvi->treat_provided);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 456));
            $CI->fpdf->MultiCell(525, 14, substr($treat_provided,0, 525));
        }

        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 10), ($y + 551), "Client Response to Therapy:");
        $CI->fpdf->Line(($cero_x +28), ($cero_y +594), ($cero_x +547), ($cero_y +594));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +608), ($cero_x +547), ($cero_y +608));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +622), ($cero_x +547), ($cero_y +622));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +636), ($cero_x +547), ($cero_y +636));
        $CI->fpdf->Line(($cero_x +28), ($cero_y +652), ($cero_x +547), ($cero_y +652));

        $pdf->SetFont('Courier', '', 8);
        if (isset($aqvi->client_response) AND $aqvi->client_response != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            $client_response  = str_replace("\n", " ", $aqvi->client_response);
            $CI->fpdf->SetXY( ($x + 8) , ($y + 556));
            $CI->fpdf->MultiCell(525, 14, substr($client_response,0, 525));
        }


        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 22), ($y + 670), "Participant/Family Signature:");
        if (isset($visit_log->signature) AND $visit_log->signature != "") {
            $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$visit_log->signature;
            $CI->fpdf->Image( $img_path, ($x + 150), ($y + 640), 60);
        }
        $CI->fpdf->Line(($cero_x +153), ($cero_y +698), ($cero_x +350), ($cero_y +698));
        $CI->fpdf->Text(($x + 355), ($y + 670), "Date:");
        if (isset($visit_log->signature) AND $visit_log->signature != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            // $CI->fpdf->Text(($x + 355 + 30), ($y + 670), standard_date(mysql_to_unix($aqvi->pt_signed_date)));
            $CI->fpdf->Text(($x + 355 + 30), ($y + 670), standard_date(mysql_to_unix($visit_log->visit_date_time)));
            $pdf->SetFont('Arial', 'B', 8);
        }
        $CI->fpdf->Line(($cero_x +397), ($cero_y +698), ($cero_x +490), ($cero_y +698));

        $pdf->SetFont('Arial', 'B', 8);
        $CI->fpdf->Text(($x + 22), ($y + 720),  "Therapist Signature:");
        if (isset($aqvi->clinician_signature) AND $aqvi->clinician_signature != "") {
            $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$aqvi->clinician_signature;
            $CI->fpdf->Image( $img_path, ($x + 115), ($y + 690), 60);
            $pdf->SetFont('Arial', '', 8);
            $CI->fpdf->Text(($x + 122), ($y + 732),  $us1_user->first_name.' '.$us1_user->last_name);
            $pdf->SetFont('Arial', 'B', 8);
        }
        $CI->fpdf->Line(($cero_x +120), ($cero_y +748), ($cero_x +350), ($cero_y +748));
        $CI->fpdf->Text(($x + 355), ($y + 720), "Date:");
        if (isset($aqvi->clinician_signature) AND $aqvi->clinician_signature != "") {
            $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
            // $CI->fpdf->Text(($x + 355 + 30), ($y + 720), standard_date(mysql_to_unix($aqvi->clinician_signed_date)));
            $CI->fpdf->Text(($x + 355 + 30), ($y + 720), standard_date(mysql_to_unix($visit_log->visit_date_time)));
            $pdf->SetFont('Arial', 'B', 8);
        }
        $CI->fpdf->Line(($cero_x +397), ($cero_y +748), ($cero_x +490), ($cero_y +748));
    }

    if ($print_3625) {
        form3625_pdf($visit_log_id, "M");
    }

    $title_text = "Aquatic Visit Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    if ($print_3625) {
        $title_text = "Aquatic Visit and Form 3625 Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    }
    
    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;

}

function aqvi_pdf ($visit_log_id, $output ='F') {
    global $GL_VISIT;

    $CI =& get_instance();

    $CI->load->model('aqvimdl');

    $visit_log = $CI->visitlogmdl->getById($visit_log_id);
    $visitlog = $visit_log;
    $aqvi = $CI->aqvimdl->get($visit_log_id);

    if (isset($aqvi->gov_program) AND $aqvi->gov_program) {
    } else {
      $patient = $CI->patientmdl->getById($visit_log->patient_id);
      @$aqvi->gov_program = $patient->gov_program;
    }

    if (isset($aqvi->gov_program) AND $aqvi->gov_program == 'Y-Waiver') {
      $filename = aqvi_y_waiver_pdf($visit_log_id, $output);
      return $filename;
    }
    elseif (isset($aqvi->gov_program) AND $aqvi->gov_program == 'CLASS') {
      $filename = aqvi_class_pdf($visit_log_id, $output);
      return $filename;
    }

    $GL_VISIT = $aqvi;

    $agy_user_id = $visit_log->user_id;
    $us1_user = $CI->usermdl->getById($agy_user_id);

    $patient = $CI->patientmdl->getById($visit_log->patient_id);

    $path_ticket = realpath("style/images/icon_enable_negro.gif");
    $label_font = "Arial";
    $data_font = "Courier";

    $__FONT['PDF']['SIZE'] = 9;
    $__FONT['PDF']['FORM_MEDIUM'] = 10;
    $__FONT['PDF']['FORM_SMALL'] = 9;
    $__FONT['PDF']['FORM_SMALL2'] = 8;
    $__FONT['PDF']['FORM_SMALL3'] = 6.5;
    $__FONT['PDF']['FORM_SMALL4'] = 9.5;
    $__FONT['PDF']['FORM_arial8'] = 9.5;


    $CI->load->library('fpdf');
    if(!defined('FPDF_FONTPATH'))
      define('FPDF_FONTPATH',$CI->config->item('fonts_path'));
    $total_page = 2;
    $CI->fpdf->Open();
    $pdf = $CI->fpdf;
    $pdf->AddPage();
    $con = 2.8346456692913384;
    $cero_x = 11;
    $cero_y = 2;
    $y = $pdf->GetY();
    $x = $pdf->GetX();

    $pdf->SetFont('Arial', 'B', 30);
    $CI->fpdf->Text(($x + 150), ($y + 72), "Progress Notes");
    $CI->fpdf->Text(($x + 144), ($y + 76), "______________");

    $pdf->SetFont('Arial', 'B', 20);
    $CI->fpdf->Text(($x + 208), ($y + 120), "Private");

    // $pdf->SetFont('Arial', 'B', 10);
    // $CI->fpdf->Text(($x + 210), ($y + 150), "(please circle one above)");

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 175), "Participant name:");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +205), ($cero_x +390), ($cero_y +205));
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 75), ($y + 175), $patient->first_name." ".$patient->last_name);

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 205), "Date:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 27), ($y + 205), standard_date(mysql_to_unix($visit_log->visited_date)));
    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Line(($cero_x +35), ($cero_y +233), ($cero_x +490), ($cero_y +233));
    $CI->fpdf->Text(($x - 7), ($y + 235), "Time of start:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 57), ($y + 235), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_in)));
    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Line(($cero_x +70), ($cero_y +263), ($cero_x +490), ($cero_y +263));
    $CI->fpdf->Text(($x - 7), ($y + 265), "Time of finish:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 57), ($y + 265), date("h:i A",mysql_to_unix($visit_log->visited_date . " " . $visit_log->visited_time_out)));
    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Line(($cero_x +74), ($cero_y +293), ($cero_x +490), ($cero_y +293));

    $dateStart = new DateTime($visit_log->visited_date . " " . $visit_log->visited_time_in);
    $dateEnd   = new DateTime($visit_log->visited_date . " " . $visit_log->visited_time_out);
    $dateDiff  = $dateStart->diff($dateEnd);

    $CI->fpdf->Text(($x - 7), ($y + 295), "Total time:");
    $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
    $CI->fpdf->Text(($x + 57), ($y + 295), $dateDiff->format("%H:%I:%S"));
    $pdf->SetFont('Arial', 'B', 9);

    $CI->fpdf->Line(($cero_x +60), ($cero_y +323), ($cero_x +490), ($cero_y +323));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +353), ($cero_x +490), ($cero_y +353));

    $CI->fpdf->Text(($x - 7), ($y + 350), "Activity:");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +379), ($cero_x +46), ($cero_y +379));

    $pdf->SetFont('Arial', 'B', 11);
    // $CI->fpdf->Text(($x + 60), ($y + 371), "Myofascial release for left forearm. Swedish massage");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +403), ($cero_x +490), ($cero_y +403));

    $CI->fpdf->Line(($cero_x +10), ($cero_y +433), ($cero_x +490), ($cero_y +433));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +463), ($cero_x +490), ($cero_y +463));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +493), ($cero_x +490), ($cero_y +493));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +523), ($cero_x +490), ($cero_y +523));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +553), ($cero_x +490), ($cero_y +553));
    $CI->fpdf->Line(($cero_x +10), ($cero_y +583), ($cero_x +490), ($cero_y +583));

    if (isset($aqvi->activity) AND $aqvi->activity != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        $activity  = str_replace("\n", " ", $aqvi->activity);
        $CI->fpdf->SetXY( ($x + 3) , ($y + 355));
        $CI->fpdf->MultiCell(480, 30, substr($activity,0, 550));
    }

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 585), "Affect:");
    $CI->fpdf->Line(($cero_x +43), ($cero_y +612), ($cero_x +490), ($cero_y +612));
    $pdf->SetFont('Arial', 'B', 11);
    if (isset($aqvi->affect) AND $aqvi->affect != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        $affect  = str_replace("\n", " ", $aqvi->affect);
        $CI->fpdf->SetXY( ($x + 22) , ($y + 575));
        $CI->fpdf->MultiCell(480, 12, substr($affect,0, 170));
    }
    // $CI->fpdf->Text(($x + 26), ($y + 582), "Client relaxed very well. Left wrist deviation to the leftimproved from 30 degrees deviation to only");
    // $CI->fpdf->Text(($x + 26), ($y + 595), "5 degrees deviation from center. Left wrist extension improved from 98 degrees to 180 degrees.");

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 615), "Goals Addressed:");
    $pdf->SetFont('Arial', 'B', 11);
    // $CI->fpdf->Text(($x + 85), ($y + 611), "Shoulders were of even height.");
    $CI->fpdf->Line(($cero_x +90), ($cero_y +643), ($cero_x +490), ($cero_y +643));
    $pdf->SetFont('Arial', 'B', 11);
    // $CI->fpdf->Text(($x + 25), ($y + 643), "ROM of wrist, relaxation");
    $CI->fpdf->Line(($cero_x +10), ($cero_y +673), ($cero_x +490), ($cero_y +673));
    if (isset($aqvi->goals) AND $aqvi->goals != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        $goals  = str_replace("\n", " ", $aqvi->goals);
        $CI->fpdf->SetXY( ($x + 3) , ($y + 595));
        $CI->fpdf->MultiCell(480, 30, '             '.substr($goals,0, 150));
    }

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 695), "Participant/Gurdian Signature:");
    if (isset($visit_log->signature) AND $visit_log->signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$visit_log->signature;
        $CI->fpdf->Image( $img_path, ($x + 127), ($y + 652), 130);
    }
    $CI->fpdf->Line(($cero_x +145), ($cero_y +723), ($cero_x +370), ($cero_y +723));
    $CI->fpdf->Text(($x + 355), ($y + 695), "Date:");
    if (isset($visit_log->signature) AND $visit_log->signature != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        // $CI->fpdf->Text(($x + 355 + 30), ($y + 695), standard_date(mysql_to_unix($aqvi->pt_signed_date)));
        $CI->fpdf->Text(($x + 355 + 30), ($y + 695), standard_date(mysql_to_unix($visit_log->visit_date_time)));
        $pdf->SetFont('Arial', 'B', 9);
    }
    $CI->fpdf->Line(($cero_x +397), ($cero_y +723), ($cero_x +490), ($cero_y +723));

    $pdf->SetFont('Arial', 'B', 9);
    $CI->fpdf->Text(($x - 7), ($y + 745),  "Therapist Signature:");
    if (isset($aqvi->clinician_signature) AND $aqvi->clinician_signature != "") {
        $img_path = str_replace("\\","/", FCPATH) . "upload/signatures/".$aqvi->clinician_signature;
        $CI->fpdf->Image( $img_path, ($x + 127), ($y + 702), 130);
    }
    $CI->fpdf->Line(($cero_x +102), ($cero_y +773), ($cero_x +370), ($cero_y +773));
    $CI->fpdf->Text(($x + 355), ($y + 745), "Date:");
    if (isset($aqvi->clinician_signature) AND $aqvi->clinician_signature != "") {
        $CI->fpdf->SetFont($data_font, '', $__FONT['PDF']['FORM_SMALL']);
        // $CI->fpdf->Text(($x + 355 + 30), ($y + 745), standard_date(mysql_to_unix($aqvi->clinician_signed_date)));
        $CI->fpdf->Text(($x + 355 + 30), ($y + 745), standard_date(mysql_to_unix($visit_log->visit_date_time)));
        $pdf->SetFont('Arial', 'B', 9);
    }
    $CI->fpdf->Line(($cero_x +397), ($cero_y +773), ($cero_x +490), ($cero_y +773));


    $title_text = "Aquatic Visit Date " . standard_date(mysql_to_unix($visit_log->visit_date_time));
    $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;

    $filename = FCPATH;
    $filename = str_replace("\\","/", $filename);

    switch($output){
        case 'D':
            $filename_only = "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text;
            $filename = $filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
        case 'F':
            //$filename = $filename.'tmp/'.time().'_'.$visit_log_id.'_pq_ptpn.pdf';
            $c = 1;
            while(file_exists($filename.'tmp/'.$filename_only.'.pdf'))
            {
                $filename_only =  "Patient ".cut_firstchar_uc($patient->first_name)." ".$patient->last_name." ".$title_text." _".$c;
                $c++;
            }
            $filename = $filename.'tmp/'.$filename_only.'.pdf';
            $CI->fpdf->Output($filename,$output);
            $CI->fpdf->FPDF();
            break;
    }

    return $filename;

}
